
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI &#8212; Notebook repository template</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI" href="jwst_source_catalog_miri_test.html" />
    <link rel="prev" title="Draft: Notebook title" href="../../example_notebook/example_notebook.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Notebook repository template</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/jwst_background_subtraction_miri_imaging_testing.html">
   JWST Pipeline Validation Notebook: calwebb_image2, background subtraction for MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/exec_jwst_background_subtraction_miri_imaging_testing.html">
   JWST Pipeline Validation Notebook: calwebb_image2, background subtraction for MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/exec_background_sub-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: Background_subtract() for MIRI LRS SLIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/background_sub-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: Background_subtract() for MIRI LRS SLIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pathloss/jwst_pathloss_nirspec_test/exec_jwst_pathloss_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, pathloss step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pathloss/jwst_pathloss_nirspec_test/jwst_pathloss_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, pathloss step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../msaflagopen/jwst_msa_flagging_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, msa_flagging step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../msaflagopen/exec_jwst_msa_flagging_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, msa_flagging step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/jwst_resample_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/exec_jwst_resample_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/jwst_resample_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/exec_jwst_resample_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../example_notebook/example_notebook.html">
   Draft: Notebook title
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jwst_source_catalog_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jwst_source_catalog_nircam_test/jwst_nircam_imaging_source_catalog.html">
   JWST Pipeline Validation Notebook: NIRCam, calwebb_image3, source_catalog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jwst_source_catalog_nircam_test/exec_jwst_nircam_imaging_source_catalog.html">
   JWST Pipeline Validation Notebook: NIRCam, calwebb_image3, source_catalog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lastframe/exec_jwst_lastframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, lastframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lastframe/jwst_lastframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, lastframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_lrs_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, photom, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, photom, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_lrs_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_jwst_photom_miri_test.html">
   JWST Pipeline Validation Notebook: photom with MIRI Imager
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/jwst_photom_miri_test.html">
   JWST Pipeline Validation Notebook: photom with MIRI Imager
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/run_ami_pipeline.html">
   JWST Pipeline Validation Notebook:  AMI3, AMI3 Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_analyze_verify.html">
   JWST Pipeline Validation Notebook: AMI3, AmiAnalyze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_average.html">
   JWST Pipeline Validation Notebook:  calwebb_ami3, ami_average
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_normalize.html">
   JWST Pipeline Validation Notebook: calwebb_ami3, ami_normalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_run_ami_pipeline.html">
   JWST Pipeline Validation Notebook:  AMI3, AMI3 Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_normalize.html">
   JWST Pipeline Validation Notebook: calwebb_ami3, ami_normalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_average.html">
   JWST Pipeline Validation Notebook:  calwebb_ami3, ami_average
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_analyze_verify.html">
   JWST Pipeline Validation Notebook: AMI3, AmiAnalyze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_nirspec_test/jwst_assign_wcs_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: NIRSpec, spec2, assign_wcs step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_nirspec_test/exec_jwst_assign_wcs_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: NIRSpec, spec2, assign_wcs step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_niriss_test/jwst_assign_wcs_niriss_image.html">
   JWST Pipeline Validation Notebook: NIRISS, image2, assign_wcs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_niriss_test/exec_jwst_assign_wcs_niriss_image.html">
   JWST Pipeline Validation Notebook: NIRISS, image2, assign_wcs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-mrs.html">
   JWST Pipeline Validation Testing Notebook: MIRI MRS Spec2: Assign_wcs()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-mrs.html">
   JWST Pipeline Validation Testing Notebook: MIRI MRS Spec2: Assign_wcs()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../barshadow/jwst_barshadow_nirspec_test/jwst_barshadow_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, barshadow step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../barshadow/jwst_barshadow_nirspec_test/exec_jwst_barshadow_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, barshadow step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reset/jwst_reset_miri_test/exec_jwst_reset_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_detector1, reset step for MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reset/jwst_reset_miri_test/jwst_reset_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_detector1, reset step for MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../refpix/jwst_refpix_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, refpix unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../refpix/exec_jwst_refpix_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, refpix unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_nirspec_test/jwst_flat_field_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, flat_field step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_nirspec_test/exec_jwst_flat_field_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, flat_field step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flatfield_analysis_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_jwst_flat_field_miri_test.html">
   JWST Pipeline Validation Testing notebook: flat_field step with MIRI Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flat-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flatfield_analysis_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flat_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, flat_field, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flat-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/jwst_flat_field_miri_test.html">
   JWST Pipeline Validation Testing notebook: flat_field step with MIRI Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flat_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, flat_field, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/jwst_skymatch_photom_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch and photometry with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/exec_jwst_skymatch_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/exec_jwst_skymatch_photom_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch and photometry with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/jwst_skymatch_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_miri_test/jwst_jump_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, Jump step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_miri_test/exec_jwst_jump_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, Jump step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, jump unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/exec_jwst_jump_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, jump unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_nircam_test/jwst_image3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_nircam_test/exec_jwst_image3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_miri_test/exec_jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_miri_test/jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_nircam_test/jwst_detector1_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_nircam_test/exec_jwst_detector1_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/exec_jwst_detector1_miri_imtso_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1 for MIRI TSO imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/jwst_detector1_miri_imtso_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1 for MIRI TSO imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/exec_caldetector1-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/caldetector1-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, rscd unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/exec_jwst_rscd_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, rscd unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_miri_test/exec_jwst_miri_rscd_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, RSCD step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_miri_test/jwst_miri_rscd_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, RSCD step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image2/jwst_image2_nircam_test/jwst_image2_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image2, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image2/jwst_image2_nircam_test/exec_jwst_image2_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image2, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ramp_fitting/exec_jwst_ramp_fitting_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ramp_fitting unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ramp_fitting/jwst_ramp_fitting_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ramp_fitting unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../firstframe/exec_jwst_firstframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, firstframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../firstframe/jwst_firstframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, firstframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dq_init/exec_jwst_dq_init_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dq_init unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dq_init/jwst_dq_init_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dq_init unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/test_cube_build_spec3.html">
   JWST Pipeline Validation Testing Notebook: Cube Build with MIRISIM Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/exec_testing_point_source_flux_conservation_modeshep_all.html">
   JWST Pipeline Validation Testing Notebook: Point Source Flux Conservation Modeshep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/testing_point_source_flux_conservation_modeshep_all.html">
   JWST Pipeline Validation Testing Notebook: Point Source Flux Conservation Modeshep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/exec_test_cube_build_spec3.html">
   JWST Pipeline Validation Testing Notebook: Cube Build with MIRISIM Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../saturation/exec_jwst_saturation_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, saturation unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../saturation/jwst_saturation_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, saturation unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_2d/jwst_extract_2d_nirspec_test/jwst_extract_2d_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, extract_2d step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_2d/jwst_extract_2d_nirspec_test/exec_jwst_extract_2d_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, extract_2d step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../persistence/exec_jwst_persistence_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, persistence unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../persistence/jwst_persistence_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, persistence unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/exec_extract_1d-spec2-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/extract_1d-spec2-miri-lrs-slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/extract_1d-spec2-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/exec_extract_1d-spec2-miri-lrs-slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dark_current/exec_jwst_dark_current_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dark_current unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dark_current/jwst_dark_current_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dark_current unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/jwst_validation_notebook_template.html">
   JWST Pipeline Validation Notebook:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/exec_jwst_validation_notebook_template.html">
   JWST Pipeline Validation Notebook:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/validation_test_template.html">
   JWST Pipeline Validation Testing Notebook: Descriptive Name of Test You Are Performing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/exec_validation_test_template.html">
   JWST Pipeline Validation Testing Notebook: Descriptive Name of Test You Are Performing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ipc/exec_jwst_ipc_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ipc unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ipc/jwst_ipc_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ipc unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/background/exec_jwst_background_unit_tests.html">
   JWST calwebb_image2, background unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/background/jwst_background_unit_tests.html">
   JWST calwebb_image2, background unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_nirspec_regression_tests.html">
   JWST NIRSpec regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/flatfield/exec_jwst_flatfield_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, flatfield unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/flatfield/jwst_flatfield_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, flatfield unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_nircam_regression_tests.html">
   JWST NIRCam regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/resample/exec_jwst_resample_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, resample unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/resample/jwst_resample_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, resample unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_niriss_regression_tests.html">
   JWST NIRISS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/source_catalog/jwst_source_catalog_unit_tests.html">
   JWST calwebb_image3, source_catalog unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/source_catalog/exec_jwst_source_catalog_unit_tests.html">
   JWST calwebb_image3, source_catalog unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_fgs_regression_tests.html">
   JWST FGS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/photom/jwst_photom_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, photom unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/photom/exec_jwst_photom_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, photom unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/assign_wcs/jwst_assign_wcs_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, assign_wcs unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/assign_wcs/exec_jwst_assign_wcs_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, assign_wcs unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/skymatch/jwst_skymatch_unit_tests.html">
   JWST calwebb_image3, skymatch unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/skymatch/exec_jwst_skymatch_unit_tests.html">
   JWST calwebb_image3, skymatch unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_niriss_regression_tests.html">
   JWST NIRISS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_nirspec_regression_tests.html">
   JWST NIRSpec regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_nircam_regression_tests.html">
   JWST NIRCam regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_fgs_regression_tests.html">
   JWST FGS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_miri_regression_tests.html">
   JWST MIRI regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_miri_regression_tests.html">
   JWST MIRI regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/tweakreg/exec_jwst_tweakreg_unit_tests.html">
   JWST calwebb_image3, tweakreg unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/tweakreg/jwst_tweakreg_unit_tests.html">
   JWST calwebb_image3, tweakreg unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/outlier_detection/jwst_outlier_detection_unit_tests.html">
   JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/outlier_detection/exec_jwst_outlier_detection_unit_tests.html">
   JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tweakreg/jwst_tweakreg_miri_test/exec_jwst_tweakreg_miri_test.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tweakreg/jwst_tweakreg_miri_test/jwst_tweakreg_miri_test.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_jwst_outlier_detection_miri_test.html">
   JWST Pipeline Validation Notebook: outlier_detection with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_jwst_outlier_detection_view_miri_test.html">
   JWST Pipeline Validation Notebook: MIRI view outlier_detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_out_det_test2.html">
   JWST Pipeline Validation Notebook: Outlier Detection for MIRI MRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/out_det_test2.html">
   JWST Pipeline Validation Notebook: Outlier Detection for MIRI MRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/jwst_outlier_detection_miri_test.html">
   JWST Pipeline Validation Notebook: outlier_detection with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/jwst_outlier_detection_view_miri_test.html">
   JWST Pipeline Validation Notebook: MIRI view outlier_detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../superbias/exec_jwst_superbias_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, superbias unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../superbias/jwst_superbias_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, superbias unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/exec_MIRI_shared_calcoron3_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Coron3 for MIRI Coronagraphic Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/jwst_calcoron3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_coron3 with NIRCam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/exec_jwst_calcoron3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_coron3 with NIRCam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/MIRI_shared_calcoron3_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Coron3 for MIRI Coronagraphic Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fringe/JWST_fringe_miri_test/exec_fringe_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, fringe, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fringe/JWST_fringe_miri_test/fringe_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, fringe, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../image3/jwst_image3_miri_test/exec_jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../image3/jwst_image3_miri_test/jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../linearity/jwst_linearity_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, linearity unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../linearity/exec_jwst_linearity_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, linearity unit tests
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/TheRealZoidberg/jwst_validation_test/main?urlpath=tree/notebooks/source_catalog/jwst_source_catalog_miri_test/exec_jwst_source_catalog_miri_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/TheRealZoidberg/jwst_validation_test/blob/main/notebooks/source_catalog/jwst_source_catalog_miri_test/exec_jwst_source_catalog_miri_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/TheRealZoidberg/jwst_validation_test"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/TheRealZoidberg/jwst_validation_test/issues/new?title=Issue%20on%20page%20%2Fnotebooks/source_catalog/jwst_source_catalog_miri_test/exec_jwst_source_catalog_miri_test.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/notebooks/source_catalog/jwst_source_catalog_miri_test/exec_jwst_source_catalog_miri_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jwst-calibration-working-group-algorithm">
     JWST Calibration working group algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-description">
     Test description
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-description">
     Data description
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-temporary-directory-for-all-of-the-test-data">
     Create a temporary directory for all of the test data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-import-statements">
     Set up import statements
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#put-in-some-helper-scripts">
     Put in some helper scripts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#print-pipeline-version-number">
     Print pipeline version number
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data">
     Read in data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-pipelines">
   Run Pipelines
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-output-of-calwebb-detector1-through-calwebb-image2">
     Run output of calwebb_detector1 through calwebb_image2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-output-of-calwebb-image2-through-calwebb-image3">
     Run output of calwebb_image2 through calwebb_image3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-an-association-file-to-combine-the-input-calibrated-files">
     Create an association file to combine the input calibrated files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-calwebb-image3-pipeline">
     Run Calwebb_Image3 pipeline
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results">
   Results
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-output-table-of-source-catalog-step-and-print-ecsv-table">
     Read in output table of source_catalog step and print ecsv table
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-image-and-overplot-detector-sources-from-ecsv-table">
     Display image and overplot detector sources from ecsv table
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#in-the-image-above-check-that-the-stars-found-by-source-catalog-red-overlap-with-stars-in-the-image">
     In the image above, check that the stars found by source catalog (red) overlap with stars in the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-the-fluxes-of-the-sources-found">
     Look at the fluxes of the sources found
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-ab-mag-of-sources-found">
     Look at AB mag of sources found
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-the-errors-on-the-ab-magnitudes">
     Look at the errors on the AB magnitudes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manually-find-matches">
     Manually find matches
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-miri-software-to-put-x-y-coordinates-from-input-catalog-into-ra-dec-coordinates">
     Use MIRI software to put x, y coordinates from input catalog into RA, Dec coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-ra-dec-coordinates-between-simulator-catalog-and-output-catalog-to-find-matches">
     Compare RA, Dec coordinates between simulator catalog and output catalog to find matches
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-photutils-to-find-catalog-matches-and-compare-which-sources-were-found-and-matched">
     Use photutils to find catalog matches and compare which sources were found and matched.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-ra-and-dec-positions-of-both-catalogs">
     Plot RA and Dec positions of both catalogs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-matched-ra-dec-coordinates-back-to-x-y-positions-and-plot-matched-stars-on-image">
     Convert matched RA/Dec coordinates back to x,y positions and plot matched stars on image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-full-catalog-and-see-where-differences-are">
     Compare to full catalog and see where differences are
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-positions-of-sources-in-the-simulated-images-from-the-catalogs-used-to-create-the-images">
     Look at positions of sources in the simulated images from the catalogs used to create the images
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compare-fluxes-between-input-sources-and-output-catalog">
   Compare fluxes between input sources and output catalog
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-star-magnitudes-and-magnitude-differences-to-the-x-position-of-the-stars">
     Compare the star magnitudes and magnitude differences to the x position of the stars.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-ab-mag-vs-x-position">
     Plot AB mag vs x position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-difference-in-magnitude-against-x-and-y-position">
     Plot difference in magnitude against x and y position.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-ab-magnitude-difference-against-ab-mag-to-see-if-there-is-a-pattern-in-the-differences-by-mag">
     Plot AB magnitude difference against AB mag to see if there is a pattern in the differences by mag.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#passing-criteria">
       Passing criteria
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#about-this-notebook">
       About this Notebook
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#table-of-contents">
   Table of Contents
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#jwst-calibration-working-group-algorithm">
     JWST Calibration working group algorithm
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-description">
     Test description
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-description">
     Data description
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-temporary-directory-for-all-of-the-test-data">
     Create a temporary directory for all of the test data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#set-up-import-statements">
     Set up import statements
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#put-in-some-helper-scripts">
     Put in some helper scripts
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#print-pipeline-version-number">
     Print pipeline version number
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-data">
     Read in data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-pipelines">
   Run Pipelines
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-output-of-calwebb-detector1-through-calwebb-image2">
     Run output of calwebb_detector1 through calwebb_image2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-output-of-calwebb-image2-through-calwebb-image3">
     Run output of calwebb_image2 through calwebb_image3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-an-association-file-to-combine-the-input-calibrated-files">
     Create an association file to combine the input calibrated files
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-calwebb-image3-pipeline">
     Run Calwebb_Image3 pipeline
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#results">
   Results
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#read-in-output-table-of-source-catalog-step-and-print-ecsv-table">
     Read in output table of source_catalog step and print ecsv table
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#display-image-and-overplot-detector-sources-from-ecsv-table">
     Display image and overplot detector sources from ecsv table
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#in-the-image-above-check-that-the-stars-found-by-source-catalog-red-overlap-with-stars-in-the-image">
     In the image above, check that the stars found by source catalog (red) overlap with stars in the image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-the-fluxes-of-the-sources-found">
     Look at the fluxes of the sources found
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-ab-mag-of-sources-found">
     Look at AB mag of sources found
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-the-errors-on-the-ab-magnitudes">
     Look at the errors on the AB magnitudes
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#manually-find-matches">
     Manually find matches
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-miri-software-to-put-x-y-coordinates-from-input-catalog-into-ra-dec-coordinates">
     Use MIRI software to put x, y coordinates from input catalog into RA, Dec coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-ra-dec-coordinates-between-simulator-catalog-and-output-catalog-to-find-matches">
     Compare RA, Dec coordinates between simulator catalog and output catalog to find matches
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-photutils-to-find-catalog-matches-and-compare-which-sources-were-found-and-matched">
     Use photutils to find catalog matches and compare which sources were found and matched.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-ra-and-dec-positions-of-both-catalogs">
     Plot RA and Dec positions of both catalogs
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-matched-ra-dec-coordinates-back-to-x-y-positions-and-plot-matched-stars-on-image">
     Convert matched RA/Dec coordinates back to x,y positions and plot matched stars on image
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-to-full-catalog-and-see-where-differences-are">
     Compare to full catalog and see where differences are
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#look-at-positions-of-sources-in-the-simulated-images-from-the-catalogs-used-to-create-the-images">
     Look at positions of sources in the simulated images from the catalogs used to create the images
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#compare-fluxes-between-input-sources-and-output-catalog">
   Compare fluxes between input sources and output catalog
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compare-the-star-magnitudes-and-magnitude-differences-to-the-x-position-of-the-stars">
     Compare the star magnitudes and magnitude differences to the x position of the stars.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-ab-mag-vs-x-position">
     Plot AB mag vs x position
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-difference-in-magnitude-against-x-and-y-position">
     Plot difference in magnitude against x and y position.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-ab-magnitude-difference-against-ab-mag-to-see-if-there-is-a-pattern-in-the-differences-by-mag">
     Plot AB magnitude difference against AB mag to see if there is a pattern in the differences by mag.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#passing-criteria">
       Passing criteria
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#about-this-notebook">
       About this Notebook
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a id="title_ID"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="jwst-pipeline-validation-notebook-calwebb-image3-source-catalog-with-miri">
<h1>JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI<a class="headerlink" href="#jwst-pipeline-validation-notebook-calwebb-image3-source-catalog-with-miri" title="Permalink to this headline">#</a></h1>
<p><span style="color:red"> <strong>Instruments Affected</strong></span>: MIRI, NIRCam</p>
<p>Tested on MIRI Simulated data</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<div style="text-align: left"> 
<p><br>  <a class="reference external" href="#intro_ID">Introduction</a> <br> <a class="reference external" href="#imports_ID">Imports</a> <br> <a class="reference external" href="#pipeline_ID">Run Pipeline</a> <br> <a class="reference external" href="#output_ID">Check Results</a> <br> <a class="reference external" href="#about_ID">About This Notebook</a> <br></p>
</div><p><a id="intro_ID"></a></p>
</section>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h2>
<p>This notebook processes a set of images through calwebb_image2 and calwebb_image3 and examines the output table of the source_catalog step.</p>
<p>This test uses simulated MIRI F770W (options for F560W or F770W) data of a crowded star + galaxy field.</p>
<p>The pipeline documentation can be found here: <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/source_catalog/main.html">https://jwst-pipeline.readthedocs.io/en/latest/jwst/source_catalog/main.html</a></p>
<p>The pipeline code is available on GitHub: <a class="reference external" href="https://github.com/spacetelescope/jwst">https://github.com/spacetelescope/jwst</a></p>
<section id="jwst-calibration-working-group-algorithm">
<h3>JWST Calibration working group algorithm<a class="headerlink" href="#jwst-calibration-working-group-algorithm" title="Permalink to this headline">#</a></h3>
<p>The algorithm and discussion for this step can be found at the following page:</p>
<p><a class="reference external" href="https://outerspace.stsci.edu/display/JWSTCC/Vanilla+Point+Source+Catalog">https://outerspace.stsci.edu/display/JWSTCC/Vanilla+Point+Source+Catalog</a></p>
</section>
<section id="test-description">
<h3>Test description<a class="headerlink" href="#test-description" title="Permalink to this headline">#</a></h3>
<p>The steps of this test are as follow:</p>
<ol class="simple">
<li><p>Set up data path and directory and image files name.</p></li>
<li><p>Run output of calwebb_detector1 through calwebb_image2.</p></li>
<li><p>Run output of calwebb_image2 through calwebb_image3.</p></li>
<li><p>Read in output table of source_catalog step and print ecsv table</p></li>
<li><p>Display image and overplot detector sources from ecsv table.</p></li>
<li><p>Look at plots of total flux in Jy and AB mag.</p></li>
<li><p>Look for matches between expected source positions (RA and Dec) from simulated catalog to output from source_catalog.</p></li>
<li><p>Compare magnitudes and magnitude differences between input simulated catalog and output found sources.</p></li>
</ol>
</section>
<section id="data-description">
<h3>Data description<a class="headerlink" href="#data-description" title="Permalink to this headline">#</a></h3>
<p>The data used in this test consist of a set of four simulated images in the F770W filter of MIRI, at four different dither positions. The data have 4827 stars of varying flux levels and just over 200 galaxies in the image. The MIRI Image simulator (MIRISim) was used to create the simulations.</p>
</section>
<section id="create-a-temporary-directory-for-all-of-the-test-data">
<h3>Create a temporary directory for all of the test data<a class="headerlink" href="#create-a-temporary-directory-for-all-of-the-test-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a temporary directory to hold notebook output, and change the working directory to that directory.</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">TemporaryDirectory</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">data_dir</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># For info, print out where the script is running</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running in </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running in /tmp/tmp_qieubm_
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;crds&#39;</span><span class="p">,</span> <span class="s1">&#39;cache&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS cache location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>         <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS cache location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]))</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/os.py:679,</span> in <span class="ni">_Environ.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">encodekey</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span>     <span class="c1"># raise KeyError with the original key value</span>
<span class="ne">--&gt; </span><span class="mi">679</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
<span class="g g-Whitespace">    </span><span class="mi">680</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodevalue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;CRDS_PATH&#39;
</pre></div>
</div>
</div>
</div>
<p><a id="imports_ID"></a></p>
</section>
<section id="set-up-import-statements">
<h3>Set up import statements<a class="headerlink" href="#set-up-import-statements" title="Permalink to this headline">#</a></h3>
<p>The following packages are needed to enable this notebook to run:</p>
<ul class="simple">
<li><p>astropy for coordinate handling and calculations</p></li>
<li><p>jwst to run the pipeline steps and create associations</p></li>
<li><p>matplotlib for plotting</p></li>
<li><p>ci_watson for retrieving data from artifactory</p></li>
<li><p>set of tools to retrieve data from Box</p></li>
</ul>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#import pytest</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">glob</span> <span class="kn">import</span> <span class="n">glob</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">photutils</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span><span class="p">,</span> <span class="n">ascii</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">Angle</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span><span class="p">,</span> <span class="n">vstack</span><span class="p">,</span> <span class="n">unique</span><span class="p">,</span> <span class="n">join</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">table</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">match_coordinates_sky</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">simple_norm</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span>
<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>

<span class="c1"># Box download imports </span>
<span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">download_file</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">move</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">splitext</span>

<span class="kn">import</span> <span class="nn">jwst</span>
<span class="kn">from</span> <span class="nn">jwst</span> <span class="kn">import</span> <span class="n">datamodels</span>
<span class="kn">from</span> <span class="nn">jwst.datamodels</span> <span class="kn">import</span> <span class="n">RampModel</span><span class="p">,</span> <span class="n">ImageModel</span>

<span class="kn">from</span> <span class="nn">jwst</span> <span class="kn">import</span> <span class="n">associations</span>
<span class="kn">from</span> <span class="nn">jwst.associations</span> <span class="kn">import</span> <span class="n">asn_from_list</span>
<span class="kn">from</span> <span class="nn">jwst.associations.lib.rules_level3_base</span> <span class="kn">import</span> <span class="n">DMS_Level3_Base</span>

<span class="kn">from</span> <span class="nn">jwst.pipeline</span> <span class="kn">import</span> <span class="n">calwebb_image3</span>
<span class="kn">from</span> <span class="nn">jwst.pipeline</span> <span class="kn">import</span> <span class="n">calwebb_image2</span>
<span class="kn">from</span> <span class="nn">jwst.pipeline</span> <span class="kn">import</span> <span class="n">calwebb_detector1</span>
<span class="kn">from</span> <span class="nn">jwst.pipeline</span> <span class="kn">import</span> <span class="n">Detector1Pipeline</span><span class="p">,</span> <span class="n">Image2Pipeline</span><span class="p">,</span> <span class="n">Image3Pipeline</span>

<span class="kn">from</span> <span class="nn">ci_watson.artifactory_helpers</span> <span class="kn">import</span> <span class="n">get_bigdata</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="put-in-some-helper-scripts">
<h3>Put in some helper scripts<a class="headerlink" href="#put-in-some-helper-scripts" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">create_scatterplot</span><span class="p">(</span><span class="n">catalog_colx</span><span class="p">,</span> <span class="n">catalog_coly</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; Function to generate a generic scatterplot.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_colx</span><span class="p">,</span><span class="n">catalog_coly</span><span class="p">)</span> 
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">catalog_colx</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">catalog_coly</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

    
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Band info from constants in miricap</span>

<span class="c1"># wref in microns and zeropoint in Jy</span>
<span class="n">band_info</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;2MASS J&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">1.235</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1594</span><span class="p">},</span>
    <span class="s2">&quot;2MASS H&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">1.662</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">},</span>
    <span class="s2">&quot;2MASS Ks&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">2.159</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">666.7</span><span class="p">},</span>
    <span class="s2">&quot;Johnson U&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.36</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1823</span><span class="p">},</span>
    <span class="s2">&quot;Johnson B&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.44</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">4130</span><span class="p">},</span>
    <span class="s2">&quot;Johnson V&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.55</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">3781</span><span class="p">},</span>
    <span class="s2">&quot;Johnson R&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.71</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">2941</span><span class="p">},</span>
    <span class="s2">&quot;Johnson I&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.97</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">2635</span><span class="p">},</span>
    <span class="s2">&quot;Johnson J&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1603</span><span class="p">},</span>
    <span class="s2">&quot;Johnson H&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">1.60</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1075</span><span class="p">},</span>
    <span class="s2">&quot;Johnson K&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">2.22</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">667</span><span class="p">},</span>
    <span class="s2">&quot;Johnson L&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">3.54</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">288</span><span class="p">},</span>
    <span class="s2">&quot;Johnson M&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">4.80</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">170</span><span class="p">},</span>
    <span class="s2">&quot;Johnson N&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">10.6</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">36</span><span class="p">},</span>
    <span class="s2">&quot;Johnson O&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">21.0</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">9.4</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT V&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.5556</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">3540</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT I&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">2250</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT J&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">1.25</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1600</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT H&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">1.65</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">1020</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT K&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">2.20</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">657</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT L&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">3.45</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">290</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT L&#39;&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">3.80</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">252</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT M&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">4.8</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mi">163</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT N&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">10.1</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">39.8</span><span class="p">},</span>
    <span class="s2">&quot;UKIRT Q&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">10.4</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">10.79</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">33.4</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q-s&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">17.90</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">12.4</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">7.91</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">60.9</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">8.81</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">49.4</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">9.69</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">41.1</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">10.27</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">36.7</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">11.70</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">28.5</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN N5&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">12.49</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">25.1</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q0&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">17.20</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">13.4</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">17.93</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">12.3</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">18.64</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">11.4</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">20.81</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">9.2</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">22.81</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">7.7</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN Q5&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">24.48</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">6.7</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN K&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">2.2</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">650.0</span><span class="p">},</span>
    <span class="s2">&quot;MIRLIN M&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">4.68</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span> <span class="mf">165.0</span><span class="p">},</span>
    <span class="s2">&quot;WISE W1&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">3.4</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span><span class="mf">309.54</span><span class="p">},</span>
    <span class="s2">&quot;WISE W2&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">4.6</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span><span class="mf">171.787</span><span class="p">},</span>
    <span class="s2">&quot;WISE W3&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">12.</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span><span class="mf">31.674</span><span class="p">},</span>
    <span class="s2">&quot;WISE W4&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;wref&#39;</span><span class="p">:</span> <span class="mf">22.</span><span class="p">,</span> <span class="s1">&#39;zeropoint&#39;</span><span class="p">:</span><span class="mf">8.363</span><span class="p">},</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># code from miricap.imager section written by Christophe Cossou of the MIRI EC team.</span>

<span class="k">def</span> <span class="nf">get_band_info</span><span class="p">(</span><span class="n">band</span><span class="p">,</span> <span class="n">system</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Retrieve information on a given band in a dictionnary &#39;band_info&#39; that need to be</span>
<span class="sd">    available in global variable of the script at this level.</span>
<span class="sd">    :param str band: Band name (e.g. V for Johnson)</span>
<span class="sd">    :param str system: possible values: Johnson, 2MASS, UKIRT, MARLIN)</span>
<span class="sd">    :return: wref in microns and zeropoint in Jy</span>
<span class="sd">    :rtype: tuple(Quantity, Quantity)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">system_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Johnson&quot;</span><span class="p">,</span> <span class="s2">&quot;2MASS&quot;</span><span class="p">,</span> <span class="s2">&quot;UKIRT&quot;</span><span class="p">,</span> <span class="s2">&quot;MARLIN&quot;</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">system</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">system_list</span><span class="p">:</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown system &#39;</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">&#39;. Possible values: </span><span class="si">{</span><span class="n">system_list</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="n">key</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">band_dict</span> <span class="o">=</span> <span class="n">band_info</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">zeropoint</span> <span class="o">=</span> <span class="n">band_dict</span><span class="p">[</span><span class="s2">&quot;zeropoint&quot;</span><span class="p">]</span>
        <span class="n">wref</span> <span class="o">=</span> <span class="n">band_dict</span><span class="p">[</span><span class="s2">&quot;wref&quot;</span><span class="p">]</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">bands</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">band_info</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">system</span> <span class="ow">in</span> <span class="n">k</span><span class="p">]</span>
        <span class="n">LOG</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Unknown band &#39;</span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2">&#39; for &#39;</span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2">&#39;. Available bands are: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

    <span class="k">return</span> <span class="n">wref</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span><span class="p">,</span> <span class="n">zeropoint</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Jy</span>



<span class="k">def</span> <span class="nf">mag2flux</span><span class="p">(</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">band</span><span class="p">,</span> <span class="n">system</span><span class="o">=</span><span class="s2">&quot;Johnson&quot;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Convert magnitude in a given band/system into flux in mJy (and return the corresponding wavelength reference</span>
<span class="sd">    :param float magnitude: magnitude in a given bandpass</span>
<span class="sd">    :param str band: band name (e.g &#39;V&#39; or Johnson system)</span>
<span class="sd">    :param str system: (By default Johnson, possible values: Johnson, 2MASS, UKIRT, MARLIN)</span>
<span class="sd">    :return: flux in mJy and wref in microns</span>
<span class="sd">    :rtype: tuple(float, float)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">wref</span><span class="p">,</span> <span class="n">zero_point</span> <span class="o">=</span> <span class="n">get_band_info</span><span class="p">(</span><span class="n">band</span><span class="p">,</span> <span class="n">system</span><span class="p">)</span>

    <span class="n">flux</span> <span class="o">=</span> <span class="n">zero_point</span> <span class="o">*</span> <span class="mf">10.0</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="mf">0.4</span> <span class="o">*</span> <span class="n">magnitude</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Magnitude </span><span class="si">{</span><span class="n">magnitude</span><span class="si">}</span><span class="s2"> in </span><span class="si">{</span><span class="n">system</span><span class="si">}</span><span class="s2"> band </span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2"> -&gt; Flux: </span><span class="si">{</span><span class="n">flux</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">wref</span><span class="si">}</span><span class="s2"> microns&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">flux</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">mJy</span><span class="p">)</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">wref</span><span class="o">.</span><span class="n">value</span>


<span class="k">def</span> <span class="nf">extrapolate_flux</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">wref</span><span class="p">,</span> <span class="n">waves</span><span class="p">,</span> <span class="n">temperature_star</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    From a flux and reference wavelength, will return the flux for other wavelength</span>
<span class="sd">    (using the star effective temperature for the spectrum shape)</span>
<span class="sd">    To convert magnitude flux in a band, use one of the following website for instance:</span>
<span class="sd">    - http://ssc.spitzer.caltech.edu/warmmission/propkit/pet/magtojy/</span>
<span class="sd">    - https://www.gemini.edu/sciops/instruments/midir-resources/imaging-calibrations/fluxmagnitude-conversion</span>
<span class="sd">    :param float flux: Star flux in mJy</span>
<span class="sd">    :param float wref: reference wavelength (microns) corresponding to the flux given in parameter</span>
<span class="sd">    :param waves: list of wavelengths you want to extrapolate the star flux on.</span>
<span class="sd">    :type waves: float or list(float) or np.array(float)</span>
<span class="sd">    :param float temperature_star: star effective temperature in K</span>
<span class="sd">    :return: flux values for all required wavelengths. Unit will be the unit of the input flux</span>
<span class="sd">    :rtype: quantity or np.array(quantity)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">flux</span> <span class="o">=</span> <span class="n">flux</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mJy</span>
    <span class="n">wref</span> <span class="o">=</span> <span class="n">wref</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>
    <span class="n">waves</span> <span class="o">=</span> <span class="n">waves</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">micron</span>

    <span class="n">bb_star</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">BlackBody</span><span class="p">(</span><span class="n">temperature_star</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">)</span>

    <span class="n">extrapolated_flux</span> <span class="o">=</span> <span class="n">flux</span> <span class="o">*</span> <span class="n">bb_star</span><span class="p">(</span><span class="n">waves</span><span class="p">)</span> <span class="o">/</span> <span class="n">bb_star</span><span class="p">(</span><span class="n">wref</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Assuming T=</span><span class="si">{</span><span class="n">temperature_star</span><span class="si">}</span><span class="s2"> K, Flux: </span><span class="si">{</span><span class="n">flux</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">wref</span><span class="si">}</span><span class="s2"> -&gt; Flux: </span><span class="si">{</span><span class="n">extrapolated_flux</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">waves</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">extrapolated_flux</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="print-pipeline-version-number">
<h3>Print pipeline version number<a class="headerlink" href="#print-pipeline-version-number" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">jwst</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.5.3
&lt;TemporaryDirectory &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmp_guls9_e&#39;&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="read-in-data">
<h3>Read in data<a class="headerlink" href="#read-in-data" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in new dataset from Box</span>

<span class="k">def</span> <span class="nf">get_box_files</span><span class="p">(</span><span class="n">file_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">box_url</span><span class="p">,</span><span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;https&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">box_url</span><span class="p">:</span>
            <span class="n">box_url</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/&#39;</span> <span class="o">+</span> <span class="n">box_url</span>
        <span class="n">downloaded_file</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">box_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">box_url</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">file_name</span> <span class="o">+=</span> <span class="n">ext</span>
        <span class="n">move</span><span class="p">(</span><span class="n">downloaded_file</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

<span class="c1"># Use F560W data set</span>
        
<span class="c1">#file_urls = [&#39;https://stsci.box.com/shared/static/g8ozd2wkdo9klrtkafpe9qegpzhpd66a.fits&#39;, </span>
<span class="c1">#             &#39;https://stsci.box.com/shared/static/ym75nbqdi32t9wnbanm6s57itqixniyc.fits&#39;, </span>
<span class="c1">#             &#39;https://stsci.box.com/shared/static/0bqh6ijsc6kd7cyv6gtnj9kvly9t885f.fits&#39;,</span>
<span class="c1">#             &#39;https://stsci.box.com/shared/static/tywadpqcjhp9yxyv0sy91hc79red92xm.fits&#39;,</span>
<span class="c1">#             &#39;https://stsci.box.com/shared/static/lpcgp7jkq6lmjj2lxpk63jz9u05qgk3a.cat&#39;,</span>
<span class="c1">#             &#39;https://stsci.box.com/shared/static/15j6hkjc28zow4rjepob2t75dl887zs3.cat&#39;]</span>

<span class="c1">#file_names = [&#39;det_image_seq1_MIRIMAGE_F560Wexp1_rate.fits&#39;, </span>
<span class="c1">#             &#39;det_image_seq2_MIRIMAGE_F560Wexp1_rate.fits&#39;, </span>
<span class="c1">#             &#39;det_image_seq3_MIRIMAGE_F560Wexp1_rate.fits&#39;,</span>
<span class="c1">#             &#39;det_image_seq4_MIRIMAGE_F560Wexp1_rate.fits&#39;,</span>
<span class="c1">#             &#39;input_sim_stars.cat&#39;,</span>
<span class="c1">#             &#39;input_sim_galaxies.cat&#39;]</span>

<span class="c1"># Test with F770W data set</span>

<span class="n">file_urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://stsci.box.com/shared/static/8573htf1p8mhk4e49z9b483dp975y3lz.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/p69h7uzlmqwlzf6kqqbf4lu9ibz28tc6.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/js8k6j20rek1oago057wxn08dhuticij.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/es253mc3m1sptusj9c9ctl1blidr1qdl.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/lpcgp7jkq6lmjj2lxpk63jz9u05qgk3a.cat&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/15j6hkjc28zow4rjepob2t75dl887zs3.cat&#39;</span><span class="p">]</span>


<span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;input_sim_stars.cat&#39;</span><span class="p">,</span>
             <span class="s1">&#39;input_sim_galaxies.cat&#39;</span><span class="p">]</span>


<span class="n">box_download_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">url</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">url</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_urls</span><span class="p">,</span><span class="n">file_names</span><span class="p">)]</span>


<span class="n">get_box_files</span><span class="p">(</span><span class="n">box_download_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a id="pipeline_ID"></a></p>
</section>
</section>
<section id="run-pipelines">
<h2>Run Pipelines<a class="headerlink" href="#run-pipelines" title="Permalink to this headline">#</a></h2>
<p>Read in the data and run the JWST calibration pipelines.</p>
<section id="run-output-of-calwebb-detector1-through-calwebb-image2">
<h3>Run output of calwebb_detector1 through calwebb_image2<a class="headerlink" href="#run-output-of-calwebb-detector1-through-calwebb-image2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image2 on output files from detector1</span>
<span class="n">ratefiles</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*rate.fits&#39;</span><span class="p">)</span>    
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">ratefiles</span><span class="p">),</span> <span class="s1">&#39; images.&#39;</span><span class="p">)</span>
    
<span class="n">callist</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># cycle through files</span>
<span class="k">for</span> <span class="n">im</span> <span class="ow">in</span> <span class="n">ratefiles</span><span class="p">:</span>
    <span class="n">pipe2</span> <span class="o">=</span> <span class="n">Image2Pipeline</span><span class="p">()</span>
    
    <span class="n">rampfile</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">im</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">rampfile</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">filename</span>
    <span class="c1"># Set pipeline parameters</span>

    <span class="n">pipe2</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">pipe2</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;_cal.fits&#39;</span>
    <span class="n">pipe2</span><span class="o">.</span><span class="n">resample</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">pipe2</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">calfile</span> <span class="o">=</span> <span class="n">pipe2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rampfile</span><span class="p">)</span>

    <span class="n">callist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calfile</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">callist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:17,499 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:17,501 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:17,503 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:17,505 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:17,506 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:17,508 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  4  images.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,700 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,706 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmp_guls9_e/det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,714 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,960 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,963 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,964 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,966 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,967 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,968 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,970 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,972 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,973 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,976 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0729.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,979 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,979 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,980 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,981 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,982 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,982 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,983 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,984 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,985 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,986 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,987 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,987 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,988 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:18,988 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,047 - stpipe.Image2Pipeline - INFO - Processing product det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,048 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,177 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,179 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,386 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,462 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.019532801 -0.016148437 0.021999351 0.015037204 359.990697211 0.017630101 359.987889352 -0.013569562
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,464 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.019532801 -0.016148437 0.021999351 0.015037204 359.990697211 0.017630101 359.987889352 -0.013569562
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,464 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,502 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,561 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,685 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:19,687 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,353 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,355 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,356 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,362 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,497 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,622 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,624 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,653 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,655 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,733 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,734 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,735 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,736 - stpipe.Image2Pipeline.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,787 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,790 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,791 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,792 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 0.592788
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,809 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,936 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,938 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:30,966 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:31,093 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:31,791 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:32,158 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:32,774 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:33,133 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:33,710 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:34,074 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:34,651 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,030 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.019529555 -0.016361102 0.022282742 0.015012100 359.990664196 0.017786817 359.987911009 -0.013586385
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,155 - stpipe.Image2Pipeline.resample - INFO - Saved model in det_image_seq1_MIRIMAGE_F770Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,156 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,157 - stpipe.Image2Pipeline - INFO - Finished processing product det_image_seq1_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,159 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,160 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0914.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,328 - stpipe.Image2Pipeline - INFO - Saved model in det_image_seq1_MIRIMAGE_F770Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,329 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,335 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,337 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,339 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,340 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,342 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,343 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,541 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,547 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmp_guls9_e/det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,554 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,561 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,563 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,564 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,564 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,565 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,565 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,567 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,568 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,569 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,570 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0729.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,572 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,572 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,573 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,573 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,574 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,574 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,575 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,576 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,578 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,578 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,578 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,579 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,579 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,580 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,630 - stpipe.Image2Pipeline - INFO - Processing product det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,631 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,756 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,758 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:35,950 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,024 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020171943 -0.017470230 0.022638493 0.013715410 359.991336353 0.016308307 359.988528494 -0.014891356
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,025 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020171943 -0.017470230 0.022638493 0.013715410 359.991336353 0.016308307 359.988528494 -0.014891356
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,026 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,064 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,124 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,246 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,248 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,356 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,357 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,358 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,365 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,499 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,626 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,629 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,655 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,656 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,739 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,740 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,741 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,741 - stpipe.Image2Pipeline.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,794 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,797 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,798 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,799 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 0.592788
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,817 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,948 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,950 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:36,976 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:37,111 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:37,741 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:38,095 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:38,715 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:39,087 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:39,675 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:40,034 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:40,612 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:40,990 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020168697 -0.017682896 0.022921883 0.013690306 359.991303338 0.016465023 359.988550151 -0.014908179
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,117 - stpipe.Image2Pipeline.resample - INFO - Saved model in det_image_seq2_MIRIMAGE_F770Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,119 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,119 - stpipe.Image2Pipeline - INFO - Finished processing product det_image_seq2_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,121 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,122 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0914.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,291 - stpipe.Image2Pipeline - INFO - Saved model in det_image_seq2_MIRIMAGE_F770Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,293 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,298 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,300 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,302 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,304 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,305 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,307 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,504 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,510 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmp_guls9_e/det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,517 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,521 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,524 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,524 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,525 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,526 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,526 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,528 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,529 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,530 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,531 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0729.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,532 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,533 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,533 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,534 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,535 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,535 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,536 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,536 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,538 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,538 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,538 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,539 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,539 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,540 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,588 - stpipe.Image2Pipeline - INFO - Processing product det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,590 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,711 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,713 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,902 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,975 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020403086 -0.019920994 0.022869636 0.011264646 359.991567495 0.013857543 359.988759636 -0.017342120
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,976 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020403086 -0.019920994 0.022869636 0.011264646 359.991567495 0.013857543 359.988759636 -0.017342120
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:41,977 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,017 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,077 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,199 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,201 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,310 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,311 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,312 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,319 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,451 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,569 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,571 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,596 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,597 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,682 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,683 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,684 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,684 - stpipe.Image2Pipeline.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,734 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,736 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,737 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,738 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 0.592788
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,756 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,874 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,876 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:42,902 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:43,036 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:43,656 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:44,011 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:44,602 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:44,987 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:45,585 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:45,943 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:46,530 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:46,912 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020399840 -0.020133660 0.023153026 0.011239542 359.991534480 0.014014259 359.988781294 -0.017358943
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,034 - stpipe.Image2Pipeline.resample - INFO - Saved model in det_image_seq3_MIRIMAGE_F770Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,035 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,036 - stpipe.Image2Pipeline - INFO - Finished processing product det_image_seq3_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,038 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,038 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0914.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,207 - stpipe.Image2Pipeline - INFO - Saved model in det_image_seq3_MIRIMAGE_F770Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,208 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,213 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,215 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,217 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,218 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,220 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,222 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,423 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,428 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmp_guls9_e/det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,435 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,439 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,442 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,442 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,443 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,443 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,444 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,446 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,447 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,448 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,450 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0729.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,451 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,451 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,452 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,452 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,453 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,453 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,454 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,454 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,456 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,457 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,457 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,457 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,458 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,458 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,505 - stpipe.Image2Pipeline - INFO - Processing product det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,506 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,635 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,637 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,827 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,901 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.021938953 -0.019422149 0.024405503 0.011763492 359.993103362 0.014356389 359.990295503 -0.016843274
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,903 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.021938953 -0.019422149 0.024405503 0.011763492 359.993103362 0.014356389 359.990295503 -0.016843274
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,903 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:47,941 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,002 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,129 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,130 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,244 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,245 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,246 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,253 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,392 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,516 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,518 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,545 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,546 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,629 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,630 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,631 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,632 - stpipe.Image2Pipeline.photom - INFO -  filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,681 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,684 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,685 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,686 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 0.592788
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,704 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,824 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,826 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,853 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:48,980 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:49,616 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:49,969 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:50,586 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:50,943 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:51,531 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:51,892 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,474 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1023, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,849 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021935707 -0.019634814 0.024688893 0.011738388 359.993070347 0.014513105 359.990317161 -0.016860097
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,964 - stpipe.Image2Pipeline.resample - INFO - Saved model in det_image_seq4_MIRIMAGE_F770Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,965 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,966 - stpipe.Image2Pipeline - INFO - Finished processing product det_image_seq4_MIRIMAGE_F770Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,968 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:52,968 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0914.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,132 - stpipe.Image2Pipeline - INFO - Saved model in det_image_seq4_MIRIMAGE_F770Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,133 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&lt;ImageModel(1024, 1032) from det_image_seq1_MIRIMAGE_F770Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from det_image_seq2_MIRIMAGE_F770Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from det_image_seq3_MIRIMAGE_F770Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from det_image_seq4_MIRIMAGE_F770Wexp1_cal.fits&gt;]]
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-output-of-calwebb-image2-through-calwebb-image3">
<h3>Run output of calwebb_image2 through calwebb_image3<a class="headerlink" href="#run-output-of-calwebb-image2-through-calwebb-image3" title="Permalink to this headline">#</a></h3>
</section>
<section id="create-an-association-file-to-combine-the-input-calibrated-files">
<h3>Create an association file to combine the input calibrated files<a class="headerlink" href="#create-an-association-file-to-combine-the-input-calibrated-files" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use asn_from_list to create association table</span>

<span class="n">calfiles</span> <span class="o">=</span> <span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*_cal.fits&#39;</span><span class="p">)</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">asn_from_list</span><span class="o">.</span><span class="n">asn_from_list</span><span class="p">(</span><span class="n">calfiles</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="n">DMS_Level3_Base</span><span class="p">,</span> <span class="n">product_name</span><span class="o">=</span><span class="s1">&#39;starfield_combined.fits&#39;</span><span class="p">)</span>

<span class="c1"># use this if you need to add non&#39;science&#39; exposure types</span>
<span class="c1">#asn[&#39;products&#39;][0][&#39;members&#39;][1][&#39;exptype&#39;] = &#39;background&#39;</span>
<span class="c1">#asn[&#39;products&#39;][0][&#39;members&#39;][2][&#39;exptype&#39;] = &#39;sourcecat&#39;</span>

<span class="c1"># dump association table to a .json file for use in image3</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;starfield_asnfile.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">asn</span><span class="o">.</span><span class="n">dump</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">asn</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jwnoprogram-a3001_none_006_asn with 1 products
Rule=DMS_Level3_Base
No constraints
Products:
	starfield_combined.fits with 4 members
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-calwebb-image3-pipeline">
<h3>Run Calwebb_Image3 pipeline<a class="headerlink" href="#run-calwebb-image3-pipeline" title="Permalink to this headline">#</a></h3>
<p>For MIRI, the FWHM values are dependent on filter and should be set using the table below:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Filter</p></th>
<th class="head"><p>FWHM</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>F560W</p></td>
<td><p>1.636</p></td>
</tr>
<tr class="row-odd"><td><p>F770W</p></td>
<td><p>2.187</p></td>
</tr>
<tr class="row-even"><td><p>F1000W</p></td>
<td><p>2.888</p></td>
</tr>
<tr class="row-odd"><td><p>F1130W</p></td>
<td><p>3.318</p></td>
</tr>
<tr class="row-even"><td><p>F1280W</p></td>
<td><p>3.713</p></td>
</tr>
<tr class="row-odd"><td><p>F1500W</p></td>
<td><p>4.354</p></td>
</tr>
<tr class="row-even"><td><p>F1800W</p></td>
<td><p>5.224</p></td>
</tr>
<tr class="row-odd"><td><p>F2100W</p></td>
<td><p>5.989</p></td>
</tr>
<tr class="row-even"><td><p>F2550W</p></td>
<td><p>7.312</p></td>
</tr>
<tr class="row-odd"><td><p>F2550WR</p></td>
<td><p>7.312</p></td>
</tr>
</tbody>
</table>
<p>For the fit geometry keyword, the following options are available:
fitgeometry: A str value indicating the type of affine transformation to be considered when fitting catalogs. Allowed values:</p>
<ul class="simple">
<li><p>shift: x/y shifts only</p></li>
<li><p>rscale: rotation and scale</p></li>
<li><p>rshift: rotation and shifts</p></li>
<li><p>general: shift, rotation, and scale (Default=general)</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image3 on the association table</span>
    
<span class="c1"># set any specific parameters</span>
<span class="c1"># tweakreg parameters to allow data to run</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mf">2.187</span>  <span class="c1"># Gaussian kernel FWHM of objects expected, default=2.5</span>
<span class="n">minobj</span> <span class="o">=</span> <span class="mi">5</span>   <span class="c1"># minimum number of objects needed to match positions for a good fit, default=15</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mi">8</span>      <span class="c1"># signal to noise threshold, default=5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">5</span>    <span class="c1"># clipping limit, in sigma units, used when performing fit, default=3</span>
<span class="n">fit_geom</span> <span class="o">=</span> <span class="s1">&#39;shift&#39;</span> <span class="c1"># ftype of affine transformation to be considered when fitting catalogs, default=&#39;general&#39;</span>
<span class="n">use2dhist</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># boolean indicating whether to use 2D histogram to find initial offset, default=True</span>
   
<span class="n">pipe3</span><span class="o">=</span><span class="n">Image3Pipeline</span><span class="p">()</span>    
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">kernel_fwhm</span> <span class="o">=</span> <span class="n">fwhm</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">snr_threshold</span> <span class="o">=</span> <span class="n">snr</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">minobj</span> <span class="o">=</span> <span class="n">minobj</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">fitgeometry</span> <span class="o">=</span> <span class="n">fit_geom</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">use2dhist</span> <span class="o">=</span> <span class="n">use2dhist</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">snr_threshold</span> <span class="o">=</span> <span class="n">snr</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">kernel_fwhm</span> <span class="o">=</span> <span class="n">fwhm</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># run Image3</span>

<span class="n">image</span> <span class="o">=</span> <span class="n">pipe3</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;starfield_asnfile.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image 3 pipeline finished.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,160 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,162 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,164 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,166 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,168 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,169 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,171 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,296 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;starfield_asnfile.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,303 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;steps&#39;: {&#39;assign_mtwcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;assign_mtwcs&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;}, &#39;tweakreg&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: False, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 2.187, &#39;snr_threshold&#39;: 8, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: False, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;shift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 5, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}, &#39;skymatch&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}, &#39;outlier_detection&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}, &#39;source_catalog&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.187, &#39;snr_threshold&#39;: 8, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,437 - stpipe.Image3Pipeline - INFO - Prefetching reference files for dataset: &#39;det_image_seq1_MIRIMAGE_F770Wexp1_cal.fits&#39; reftypes = [&#39;abvegaoffset&#39;, &#39;apcorr&#39;, &#39;drizpars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,452 - stpipe.Image3Pipeline - INFO - Prefetch for ABVEGAOFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,455 - stpipe.Image3Pipeline - INFO - Prefetch for APCORR reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,457 - stpipe.Image3Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:53,459 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:54,033 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:54,035 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: False, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 2.187, &#39;snr_threshold&#39;: 8, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: False, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;shift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 5, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:54,274 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 36 sources in det_image_seq1_MIRIMAGE_F770Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:54,529 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 33 sources in det_image_seq2_MIRIMAGE_F770Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:54,769 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 35 sources in det_image_seq3_MIRIMAGE_F770Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,022 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 46 sources in det_image_seq4_MIRIMAGE_F770Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,041 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,042 - stpipe.Image3Pipeline.tweakreg - INFO - Number of image groups to be aligned: 4.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,042 - stpipe.Image3Pipeline.tweakreg - INFO - Image groups:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,067 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;det_image_seq1_MIRIMAGE_F770Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,068 - stpipe.Image3Pipeline.tweakreg - INFO -      det_image_seq1_MIRIMAGE_F770Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,092 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;det_image_seq2_MIRIMAGE_F770Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,093 - stpipe.Image3Pipeline.tweakreg - INFO -      det_image_seq2_MIRIMAGE_F770Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,117 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;det_image_seq3_MIRIMAGE_F770Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,118 - stpipe.Image3Pipeline.tweakreg - INFO -      det_image_seq3_MIRIMAGE_F770Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,142 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;det_image_seq4_MIRIMAGE_F770Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,143 - stpipe.Image3Pipeline.tweakreg - INFO -      det_image_seq4_MIRIMAGE_F770Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,143 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,144 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,145 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() started on 2022-07-07 08:18:55.144509
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,145 - stpipe.Image3Pipeline.tweakreg - INFO -       Version 0.7.4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,146 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,239 - stpipe.Image3Pipeline.tweakreg - INFO - Selected image &#39;GROUP ID: det_image_seq1_MIRIMAGE_F770Wexp1_cal&#39; as reference image
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,246 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: det_image_seq2_MIRIMAGE_F770Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,364 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;det_image_seq2_MIRIMAGE_F770Wexp1_cal&#39; catalog with sources from the reference &#39;det_image_seq1_MIRIMAGE_F770Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,366 - stpipe.Image3Pipeline.tweakreg - INFO - Found 25 matches for &#39;GROUP ID: det_image_seq2_MIRIMAGE_F770Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,369 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;shift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,371 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;shift&#39; fit for GROUP ID: det_image_seq2_MIRIMAGE_F770Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,372 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.00523577  YSH: -0.00460672
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,373 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,374 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.0292529   FIT MAE: 0.0158524
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,375 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 25 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,418 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: det_image_seq3_MIRIMAGE_F770Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,540 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;det_image_seq3_MIRIMAGE_F770Wexp1_cal&#39; catalog with sources from the reference &#39;det_image_seq1_MIRIMAGE_F770Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,542 - stpipe.Image3Pipeline.tweakreg - INFO - Found 24 matches for &#39;GROUP ID: det_image_seq3_MIRIMAGE_F770Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,543 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;shift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,546 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;shift&#39; fit for GROUP ID: det_image_seq3_MIRIMAGE_F770Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,547 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000198679  YSH: -0.00267906
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,548 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,549 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00680934   FIT MAE: 0.00551607
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,550 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 24 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,593 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: det_image_seq4_MIRIMAGE_F770Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,710 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;det_image_seq4_MIRIMAGE_F770Wexp1_cal&#39; catalog with sources from the reference &#39;det_image_seq1_MIRIMAGE_F770Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,713 - stpipe.Image3Pipeline.tweakreg - INFO - Found 25 matches for &#39;GROUP ID: det_image_seq4_MIRIMAGE_F770Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,715 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;shift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,718 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;shift&#39; fit for GROUP ID: det_image_seq4_MIRIMAGE_F770Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,718 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: 0.00566956  YSH: 0.00118207
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,719 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,721 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.0314286   FIT MAE: 0.0153639
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,722 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 25 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,764 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,765 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() ended on 2022-07-07 08:18:55.764473
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,766 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() TOTAL RUN TIME: 0:00:00.619964
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,767 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:55,965 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,131 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,133 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,252 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,253 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() started on 2022-07-07 08:18:56.252570
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,254 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,255 - stpipe.Image3Pipeline.skymatch - INFO - Sky computation method: &#39;match&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,256 - stpipe.Image3Pipeline.skymatch - INFO - Sky matching direction: DOWN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,257 - stpipe.Image3Pipeline.skymatch - INFO - Sky subtraction from image data: OFF
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,258 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:56,259 - stpipe.Image3Pipeline.skymatch - INFO - ----  Computing differences in sky values in overlapping regions.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,896 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=det_image_seq1_MIRIMAGE_F770Wexp1_cal.fits. Sky background: 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,897 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=det_image_seq2_MIRIMAGE_F770Wexp1_cal.fits. Sky background: 0.00699337
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,899 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=det_image_seq3_MIRIMAGE_F770Wexp1_cal.fits. Sky background: 0.000671442
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,901 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=det_image_seq4_MIRIMAGE_F770Wexp1_cal.fits. Sky background: 0.00201467
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,902 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,903 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() ended on 2022-07-07 08:18:58.902858
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,904 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() TOTAL RUN TIME: 0:00:02.650288
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,904 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:58,929 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:59,208 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:59,211 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;crf&#39;, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:59,219 - stpipe.Image3Pipeline.outlier_detection - INFO - Performing outlier detection on 4 inputs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:18:59,999 - stpipe.Image3Pipeline.outlier_detection - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:01,225 - stpipe.Image3Pipeline.outlier_detection - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:02,416 - stpipe.Image3Pipeline.outlier_detection - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:03,617 - stpipe.Image3Pipeline.outlier_detection - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:04,301 - stpipe.Image3Pipeline.outlier_detection - INFO - Generating median from 4 images
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:04,939 - stpipe.Image3Pipeline.outlier_detection - INFO - Blotting median...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:05,648 - stpipe.Image3Pipeline.outlier_detection - INFO - Blotting (1024, 1032) &lt;-- (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:06,573 - stpipe.Image3Pipeline.outlier_detection - INFO - Blotting (1024, 1032) &lt;-- (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:07,509 - stpipe.Image3Pipeline.outlier_detection - INFO - Blotting (1024, 1032) &lt;-- (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,433 - stpipe.Image3Pipeline.outlier_detection - INFO - Blotting (1024, 1032) &lt;-- (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,455 - stpipe.Image3Pipeline.outlier_detection - INFO - Flagging outliers
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,531 - stpipe.Image3Pipeline.outlier_detection - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/jwst/outlier_detection/outlier_detection.py:418: RuntimeWarning: overflow encountered in multiply
  threshold1 = scale1 * blot_deriv + snr1 * err_data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,551 - stpipe.Image3Pipeline.outlier_detection - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/jwst/outlier_detection/outlier_detection.py:427: RuntimeWarning: overflow encountered in multiply
  threshold2 = scale2 * blot_deriv + snr2 * err_data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,569 - stpipe.Image3Pipeline.outlier_detection - INFO - New pixels flagged as outliers: 650 (0.06%)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,652 - stpipe.Image3Pipeline.outlier_detection - INFO - New pixels flagged as outliers: 639 (0.06%)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,732 - stpipe.Image3Pipeline.outlier_detection - INFO - New pixels flagged as outliers: 660 (0.06%)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:08,813 - stpipe.Image3Pipeline.outlier_detection - INFO - New pixels flagged as outliers: 995 (0.09%)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:09,087 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in det_image_seq1_MIRIMAGE_F770Wexp1_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:09,369 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in det_image_seq2_MIRIMAGE_F770Wexp1_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:09,656 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in det_image_seq3_MIRIMAGE_F770Wexp1_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:09,946 - stpipe.Image3Pipeline.outlier_detection - INFO - Saved model in det_image_seq4_MIRIMAGE_F770Wexp1_a3001_crf.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:09,948 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:10,266 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:10,268 - stpipe.Image3Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:10,287 - stpipe.Image3Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:10,444 - stpipe.Image3Pipeline.resample - INFO - Blending metadata for starfield_combined.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:11,137 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:11,721 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:12,847 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:13,999 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:15,097 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:15,448 - stpipe.Image3Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:16,029 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:17,208 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:18,503 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:19,845 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:20,212 - stpipe.Image3Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:20,940 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:22,238 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:23,533 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:24,828 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:25,190 - stpipe.Image3Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:25,904 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:27,204 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:28,593 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:29,918 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:30,317 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021881996 -0.020264477 0.024955446 0.014758198 359.990668798 0.017767056 359.987595348 -0.017255618
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:30,773 - stpipe.Image3Pipeline.resample - INFO - Saved model in starfield_combined_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:30,774 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,019 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1142, 1118) from starfield_combined_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,022 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.187, &#39;snr_threshold&#39;: 8, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,043 - stpipe.Image3Pipeline.source_catalog - INFO - Using APCORR reference file: /grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,052 - stpipe.Image3Pipeline.source_catalog - INFO - Using ABVEGAOFFSET reference file: /grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,053 - stpipe.Image3Pipeline.source_catalog - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,054 - stpipe.Image3Pipeline.source_catalog - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,054 - stpipe.Image3Pipeline.source_catalog - INFO - Filter: F770W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,055 - stpipe.Image3Pipeline.source_catalog - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,110 - stpipe.Image3Pipeline.source_catalog - INFO - AB to Vega magnitude offset 4.38398
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:31,774 - stpipe.Image3Pipeline.source_catalog - INFO - Detected 537 sources
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:32,308 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote source catalog: starfield_combined_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:32,430 - stpipe.Image3Pipeline.source_catalog - INFO - Saved model in starfield_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:32,432 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote segmentation map: starfield_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:32,434 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:32,436 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image 3 pipeline finished.
</pre></div>
</div>
</div>
</div>
<p><a id="output_ID"></a></p>
</section>
</section>
<section id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">#</a></h2>
<p>Read in the output of the pipeline and check your results.</p>
<section id="read-in-output-table-of-source-catalog-step-and-print-ecsv-table">
<h3>Read in output table of source_catalog step and print ecsv table<a class="headerlink" href="#read-in-output-table-of-source-catalog-step-and-print-ecsv-table" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">photfile</span> <span class="o">=</span> <span class="s1">&#39;starfield_combined_cat.ecsv&#39;</span>
<span class="n">input_file</span> <span class="o">=</span> <span class="s1">&#39;starfield_combined_i2d.fits&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at subset of table with full columns</span>
<span class="c1"># If you have negative fluxes or repeated values of xcentroid or ycentroid, you may be finding spurious sources at image edges</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">photfile</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>

<span class="n">smalltable</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">,</span> <span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span><span class="s1">&#39;aper30_flux&#39;</span><span class="p">,</span> <span class="s1">&#39;aper50_flux&#39;</span><span class="p">,</span> <span class="s1">&#39;aper70_flux&#39;</span><span class="p">,</span> <span class="s1">&#39;CI_50_30&#39;</span><span class="p">,</span> <span class="s1">&#39;CI_70_50&#39;</span><span class="p">,</span><span class="s1">&#39;aper_total_flux&#39;</span><span class="p">]</span>
<span class="n">smalltable</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
<span class="c1">#print(smalltable)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>label xcentroid ycentroid  aper30_flux   aper50_flux   aper70_flux  CI_50_30 CI_70_50 aper_total_flux
                                Jy            Jy            Jy                               Jy      
----- --------- --------- ------------- ------------- ------------- -------- -------- ---------------
    1  675.9528    4.5782  9.821837e-07  1.534174e-06  1.941163e-06   1.5620   1.2653    2.845180e-06
    2  800.8166   16.5479  2.376843e-06  4.612498e-06  1.487258e-05   1.9406   3.2244    2.179888e-05
    3  773.0351   12.4837  4.884717e-07  8.393948e-07  1.537787e-06   1.7184   1.8320    2.253949e-06
    4  695.1160   14.3526  3.457290e-06  5.722881e-06  9.466951e-06   1.6553   1.6542    1.387580e-05
    5  562.6560   17.9919  1.190594e-06  2.281449e-06  6.606575e-06   1.9162   2.8958    9.683317e-06
    6  575.8128   15.8102  3.930516e-07  7.520629e-07  2.026116e-06   1.9134   2.6941    2.969696e-06
    7  764.1451   20.3239  6.260836e-07  1.104910e-06  2.078210e-06   1.7648   1.8809    3.046051e-06
    8  537.2964   24.0008  4.691052e-07  9.154008e-07  2.360698e-06   1.9514   2.5789    3.460096e-06
    9  548.5314   23.3973  3.594430e-07  6.589327e-07  1.941445e-06   1.8332   2.9463    2.845594e-06
   10  824.0595   23.5101  7.607507e-07  1.237287e-06  1.840419e-06   1.6264   1.4875    2.697519e-06
   11  490.9781   28.9787  5.710564e-07  1.052914e-06  1.989122e-06   1.8438   1.8892    2.915474e-06
   12  722.8227   33.2893  3.634556e-06  6.257255e-06  1.056465e-05   1.7216   1.6884    1.548471e-05
   13  777.4443   37.8275  3.135899e-05  5.104670e-05  8.489836e-05   1.6278   1.6632    1.244363e-04
   14  559.9213   34.7914  1.601296e-06  2.824706e-06  4.804072e-06   1.7640   1.7007    7.041372e-06
   15  858.0125   34.0096  9.945870e-07  1.765651e-06  2.832869e-06   1.7753   1.6044    4.152162e-06
   16  468.1539   37.0217  1.226006e-06  1.682297e-06  2.125025e-06   1.3722   1.2632    3.114669e-06
   17  364.9088   41.4692  2.893489e-06  5.126348e-06  9.062275e-06   1.7717   1.7678    1.328266e-05
   18  886.7570   42.4209  2.023480e-06  3.364064e-06  5.826487e-06   1.6625   1.7320    8.539935e-06
   19  703.7833   43.9687  9.936887e-07  1.717563e-06  2.837639e-06   1.7285   1.6521    4.159153e-06
   20  591.8094   53.6074  1.426906e-05  2.515115e-05  5.604806e-05   1.7626   2.2284    8.215016e-05
   21  567.1784   47.1122  1.130031e-06  1.959262e-06  3.128050e-06   1.7338   1.5965    4.584811e-06
   22  689.2860   48.9377  7.539445e-07  1.329511e-06  2.450931e-06   1.7634   1.8435    3.592352e-06
   23  394.4599   49.9843  1.150278e-06  1.878748e-06  2.951443e-06   1.6333   1.5710    4.325957e-06
   24  964.7653   55.4967  7.022312e-06  1.142904e-05  1.891777e-05   1.6275   1.6552    2.772795e-05
   25  404.9633   71.4839  7.545403e-07  1.223346e-06  2.009069e-06   1.6213   1.6423    2.944711e-06
   26  446.8357   73.1839  6.234599e-07  1.072277e-06  1.717581e-06   1.7199   1.6018    2.517475e-06
   27  593.9256   77.9214  1.036805e-05  1.838455e-05  3.049914e-05   1.7732   1.6590    4.470286e-05
   28  929.4827   76.5522  1.016624e-06  1.624435e-06  2.924809e-06   1.5979   1.8005    4.286920e-06
   29  538.8932   90.2254  8.233694e-07  2.100978e-06  2.199934e-05   2.5517  10.4710    3.224463e-05
   30  497.9415   86.3635  1.056851e-06  1.752244e-06  2.802964e-06   1.6580   1.5996    4.108330e-06
   31  971.7377   94.0753  7.882784e-07  1.417575e-06  2.840934e-06   1.7983   2.0041    4.163982e-06
   32  708.8037  127.9683  3.407568e-08  6.003363e-08  3.083919e-07   1.7618   5.1370    4.520128e-07
   33  975.6859  109.8783  9.681441e-07  1.877997e-06  6.497937e-06   1.9398   3.4600    9.524085e-06
   34  628.8523  108.5176  2.300928e-06  3.835289e-06  6.835629e-06   1.6668   1.7823    1.001904e-05
   35  462.7366  109.6454  1.339866e-06  2.224021e-06  3.856226e-06   1.6599   1.7339    5.652105e-06
   36  939.3676  110.2782  3.074605e-06  5.192556e-06  9.071011e-06   1.6889   1.7469    1.329546e-05
   37  579.2272  114.5446  1.280037e-06  2.145097e-06  3.597570e-06   1.6758   1.6771    5.272991e-06
   38  681.9541  115.0409  7.257973e-07  1.324986e-06  2.400765e-06   1.8256   1.8119    3.518823e-06
   39  758.5180  116.7321  1.097714e-06  1.794764e-06  3.130107e-06   1.6350   1.7440    4.587827e-06
   40  896.2336  125.0185  2.281138e-05  3.986274e-05  6.665186e-05   1.7475   1.6720    9.769223e-05
   41  848.8299  123.4302  2.775097e-06  4.501811e-06  7.560891e-06   1.6222   1.6795    1.108207e-05
   42  763.5633  129.9472  4.235478e-06  7.074773e-06  1.192831e-05   1.6704   1.6860    1.748343e-05
   43 1077.5901  131.6386  3.388582e-06  5.701395e-06  1.039631e-05   1.6825   1.8235    1.523796e-05
   44  546.5155  131.7354  1.311695e-06  2.115304e-06  3.405994e-06   1.6126   1.6102    4.992197e-06
   45  685.0088  131.1708  8.014873e-07  1.447398e-06  2.289802e-06   1.8059   1.5820    3.356184e-06
   46 1071.3577  142.8649  3.583452e-06  6.305635e-06  1.424275e-05   1.7597   2.2587    2.087572e-05
   47  553.8850  144.0206  2.013854e-05  3.651596e-05  6.225993e-05   1.8132   1.7050    9.125494e-05
   48  751.6135  143.9485  3.600552e-06  6.106809e-06  1.030856e-05   1.6961   1.6880    1.510936e-05
   49  612.4862  143.4168  9.172852e-07  1.512518e-06  2.763274e-06   1.6489   1.8269    4.050156e-06
   50  562.9848  144.4953  5.153019e-07  9.143456e-07  2.220233e-06   1.7744   2.4282    3.254215e-06
   51  676.6665  146.9598  7.204158e-07  1.247070e-06  1.992304e-06   1.7310   1.5976    2.920138e-06
   52  370.0515  150.0032  5.294822e-06  9.617291e-06  1.608656e-05   1.8164   1.6727    2.357822e-05
   53  700.9981  151.0056  2.865071e-07  5.462639e-07  1.407228e-06   1.9066   2.5761    2.062587e-06
   54  524.1085  157.5183  2.913870e-06  5.523280e-06  1.560964e-05   1.8955   2.8262    2.287919e-05
   55  928.7838  154.5010  2.016883e-06  3.214425e-06  5.295457e-06   1.5938   1.6474    7.761599e-06
   56  847.5694  161.0196  4.678317e-06  8.499289e-06  2.080956e-05   1.8167   2.4484    3.050076e-05
   57  475.4655  160.5682  4.752705e-06  7.888648e-06  1.641775e-05   1.6598   2.0812    2.406365e-05
   58  653.7524  159.8164  3.832577e-06  6.541608e-06  1.110985e-05   1.7068   1.6983    1.628381e-05
   59  663.6746  161.8966  4.317980e-06  7.328312e-06  1.227316e-05   1.6972   1.6748    1.798889e-05
   60  758.9493  165.4972  7.014888e-07  1.159653e-06  2.102507e-06   1.6531   1.8130    3.081664e-06
   61  516.7241  168.4962  1.089790e-06  1.743002e-06  2.771091e-06   1.5994   1.5898    4.061614e-06
   62  541.4132  177.5730 -1.875399e-07 -3.373540e-07  3.822127e-06   1.7988 -11.3297    5.602126e-06
   63  851.4826  170.9583  5.196476e-07  8.645296e-07  1.644620e-06   1.6637   1.9023    2.410534e-06
   64  694.1673  181.9533 -9.862042e-08 -1.937106e-07  8.891614e-07   1.9642  -4.5902    1.303252e-06
   65 1011.4618  174.9303  2.926677e-06  4.998786e-06  8.795928e-06   1.7080   1.7596    1.289227e-05
   66  782.2875  176.0160  5.240486e-07  9.334939e-07  1.738730e-06   1.7813   1.8626    2.548472e-06
   67  899.1365  180.1171  1.425862e-06  2.488233e-06  4.127817e-06   1.7451   1.6589    6.050178e-06
   68  944.2988  182.3369  7.942103e-06  1.307621e-05  2.231247e-05   1.6464   1.7063    3.270359e-05
   69  630.1490  185.8757  6.718229e-07  1.175486e-06  2.022208e-06   1.7497   1.7203    2.963969e-06
   70 1010.9063  192.5313  1.224268e-05  2.256330e-05  5.571410e-05   1.8430   2.4692    8.166066e-05
   71  802.5177  193.4771  1.453892e-06  2.313162e-06  4.111465e-06   1.5910   1.7774    6.026211e-06
   72  985.0575  197.4082  4.246557e-06  7.814151e-06  2.103145e-05   1.8401   2.6915    3.082599e-05
   73  376.5208  200.7263  2.275868e-07  4.600164e-07  1.648756e-05   2.0213  35.8412    2.416597e-05
   74  809.1211  205.9757  3.395620e-05  6.080266e-05  1.019169e-04   1.7906   1.6762    1.493806e-04
   75  496.5264  204.8464  1.811036e-06  3.012282e-06  4.939639e-06   1.6633   1.6398    7.240074e-06
   76  487.6514  210.5197  1.171266e-06  1.852663e-06  3.039401e-06   1.5818   1.6406    4.454878e-06
   77  658.0120  211.0184  4.557855e-07  8.428746e-07  1.355637e-06   1.8493   1.6083    1.986970e-06
   78  908.5321  212.4810  9.308956e-07  1.480115e-06  2.502435e-06   1.5900   1.6907    3.667842e-06
   79  576.0072  218.3242  4.407989e-06  7.638643e-06  1.291029e-05   1.7329   1.6901    1.892273e-05
   80  639.3360  217.9887  1.273847e-06  2.192431e-06  3.674048e-06   1.7211   1.6758    5.385085e-06
   81  895.9323  217.6012  1.596047e-06  2.722359e-06  4.739856e-06   1.7057   1.7411    6.947250e-06
   82  956.6780  220.9450  6.530717e-07  1.124356e-06  1.964820e-06   1.7216   1.7475    2.879854e-06
   83  924.6418  225.8755  7.926043e-07  1.340676e-06  2.247392e-06   1.6915   1.6763    3.294023e-06
   84  961.3971  228.1815  5.726710e-07  9.617401e-07  1.630177e-06   1.6794   1.6950    2.389366e-06
   85  487.1238  233.0244  4.957411e-06  9.477700e-06  2.669400e-05   1.9118   2.8165    3.912564e-05
   86  698.8284  234.6496  1.024342e-05  1.747406e-05  3.068835e-05   1.7059   1.7562    4.498020e-05
   87  459.1518  233.9420  3.173158e-06  5.678484e-06  9.639504e-06   1.7895   1.6975    1.412871e-05
   88  648.2853  233.7315  1.730781e-06  2.895235e-06  5.053531e-06   1.6728   1.7455    7.407006e-06
   89  640.0224  233.0151  4.187095e-07  7.560985e-07  1.000500e-06   1.8058   1.3232    1.466443e-06
   90  780.0122  236.7570  6.129956e-07  1.088690e-06  1.970152e-06   1.7760   1.8097    2.887670e-06
   91  626.9593  239.9956  6.227454e-07  1.115802e-06  1.689793e-06   1.7917   1.5144    2.476745e-06
   92  464.2278  248.2259  5.269435e-07  9.166976e-07  1.724406e-06   1.7397   1.8811    2.527478e-06
   93  819.8726  251.7841  1.111985e-06  1.957029e-06  3.329733e-06   1.7599   1.7014    4.880420e-06
   94 1046.3801  258.0974  5.474141e-06  9.927361e-06  2.514603e-05   1.8135   2.5330    3.685676e-05
   95  403.1387  254.2967  6.675828e-07  1.231583e-06  2.395964e-06   1.8448   1.9454    3.511786e-06
   96  576.8493  254.8617  6.705570e-07  1.174759e-06  2.000171e-06   1.7519   1.7026    2.931669e-06
   97  509.8211  256.1751  5.404500e-07  9.394064e-07  1.466634e-06   1.7382   1.5612    2.149658e-06
   98  495.6229  263.8840  7.229812e-07  1.230972e-06  1.869083e-06   1.7026   1.5184    2.739532e-06
   99  539.0647  264.4835  5.442254e-07  9.107649e-07  1.607893e-06   1.6735   1.7654    2.356703e-06
  100  802.7682  266.9764  6.870351e-07  1.204519e-06  2.105060e-06   1.7532   1.7476    3.085405e-06
  101  626.6319  273.6304  9.039048e-07  1.487497e-06  2.602991e-06   1.6456   1.7499    3.815227e-06
  102  924.6992  273.9355  5.160247e-07  8.846914e-07  1.465092e-06   1.7144   1.6560    2.147398e-06
  103  939.1263  274.6318  9.500336e-07  1.642061e-06  2.950705e-06   1.7284   1.7970    4.324875e-06
  104  514.0232  277.7683  7.803180e-06  1.401244e-05  2.467868e-05   1.7957   1.7612    3.617177e-05
  105  992.6913  296.4231 -2.817544e-07 -5.478151e-07 -9.485849e-07   1.9443   1.7316   -1.390349e-06
  106  634.8945  286.9026  1.959658e-06  4.047562e-06  1.298049e-05   2.0654   3.2070    1.902562e-05
  107  501.7856  288.3626  2.561797e-05  4.281592e-05  7.403986e-05   1.6713   1.7293    1.085209e-04
  108  867.4494  290.7361  9.250309e-07  1.517829e-06  2.734707e-06   1.6408   1.8017    4.008285e-06
  109  647.9136  291.5488  1.060223e-06  1.762043e-06  2.883331e-06   1.6620   1.6364    4.226125e-06
  110  931.1717  293.4415  2.513358e-06  4.172202e-06  7.118886e-06   1.6600   1.7063    1.043422e-05
  111  708.4936  295.7656  3.348066e-06  5.842949e-06  1.491250e-05   1.7452   2.5522    2.185738e-05
  112  913.7927  295.3121  7.852655e-07  1.348472e-06  2.394991e-06   1.7172   1.7761    3.510360e-06
  113 1067.9909  298.9549  1.820857e-05  3.316640e-05  5.696602e-05   1.8215   1.7176    8.349562e-05
  114  869.5681  299.6693  6.192420e-07  1.219697e-06  4.011676e-06   1.9697   3.2891    5.879950e-06
  115  939.0222  303.0744  6.325236e-07  1.144790e-06  1.997046e-06   1.8099   1.7445    2.927088e-06
  116 1019.5093  308.3034  1.975212e-06  3.202877e-06  5.339557e-06   1.6215   1.6671    7.826238e-06
  117  791.3937  309.9825  8.874325e-07  1.546967e-06  2.690439e-06   1.7432   1.7392    3.943401e-06
  118  827.6122  320.6381  5.167231e-06  9.570754e-06  3.040655e-05   1.8522   3.1770    4.456715e-05
  119  687.7900  312.0407  4.927193e-07  9.161531e-07  1.951359e-06   1.8594   2.1299    2.860124e-06
  120 1032.0575  319.6163  3.083010e-06  6.574127e-06  2.929146e-05   2.1324   4.4556    4.293276e-05
  121 1067.9049  317.0935  5.386678e-07  1.081410e-06  3.205687e-06   2.0076   2.9644    4.698604e-06
  122 1017.5650  321.2051  7.744310e-07  1.619144e-06  6.932651e-06   2.0908   4.2817    1.016125e-05
  123  411.4849  321.9788  5.712221e-07  1.004258e-06  1.757903e-06   1.7581   1.7504    2.576574e-06
  124  398.3173  323.0844  6.510241e-07  1.094090e-06  1.862567e-06   1.6806   1.7024    2.729981e-06
  125 1093.0716  324.3338  8.404510e-07  1.421765e-06  2.536118e-06   1.6917   1.7838    3.717212e-06
  126  860.2832  324.4219  5.733586e-07  9.251490e-07  1.560665e-06   1.6136   1.6869    2.287480e-06
  127  646.2312  327.4668  2.245756e-06  3.658791e-06  6.409511e-06   1.6292   1.7518    9.394478e-06
  128  807.0261  325.9983  4.119259e-07  7.580446e-07  1.298042e-06   1.8402   1.7124    1.902551e-06
  129 1070.7247  346.3368  1.657666e-06  3.245001e-06  1.263082e-05   1.9576   3.8924    1.851310e-05
  130  666.7662  331.5023  9.446171e-07  1.511110e-06  2.518808e-06   1.5997   1.6669    3.691840e-06
  131  974.0080  334.5121  1.137230e-06  1.967650e-06  3.334673e-06   1.7302   1.6947    4.887660e-06
  132 1020.4412  337.5670  9.496120e-07  1.524338e-06  2.520788e-06   1.6052   1.6537    3.694742e-06
  133  411.5545  341.0263  3.128630e-06  5.240454e-06  8.553786e-06   1.6750   1.6323    1.253736e-05
  134  639.4831  339.0144  7.237495e-07  1.252422e-06  2.287323e-06   1.7305   1.8263    3.352550e-06
  135  775.5372  340.3043  3.508795e-07  6.785621e-07  1.839094e-06   1.9339   2.7103    2.695577e-06
  136  937.9288  374.4056 -7.367106e-08 -1.647432e-07 -8.394762e-07   2.2362   5.0957   -1.230428e-06
  137  975.6010  344.2056  9.617439e-07  1.634611e-06  2.785000e-06   1.6996   1.7038    4.081999e-06
  138  939.8712  350.2971  1.631296e-06  2.869260e-06  4.963934e-06   1.7589   1.7300    7.275683e-06
  139  539.2824  353.8081  8.501101e-07  1.487331e-06  2.886277e-06   1.7496   1.9406    4.230442e-06
  140  931.5985  354.2280  3.958250e-07  6.670565e-07  1.203112e-06   1.6852   1.8036    1.763412e-06
  141  466.5701  359.5521  1.106292e-05  1.783284e-05  3.134199e-05   1.6119   1.7575    4.593824e-05
  142  694.0268  365.5746  7.258887e-07  1.328728e-06  3.850540e-06   1.8305   2.8979    5.643771e-06
  143  726.7474  376.6060  2.722941e-06  5.089392e-06  1.658611e-05   1.8691   3.2590    2.431042e-05
  144 1003.1368  370.1636  7.651881e-07  1.357808e-06  2.416151e-06   1.7745   1.7794    3.541374e-06
  145  889.6152  377.0719  8.708101e-07  1.499345e-06  2.617021e-06   1.7218   1.7454    3.835792e-06
  146 1001.1638  380.1569  5.796363e-07  1.016959e-06  1.679738e-06   1.7545   1.6517    2.462007e-06
  147  828.0444  382.0969  5.693310e-07  1.021419e-06  1.625889e-06   1.7941   1.5918    2.383080e-06
  148  994.1778  384.1644  4.508766e-07  7.930684e-07  1.211904e-06   1.7589   1.5281    1.776298e-06
  149  814.6997  388.6848  1.830575e-06  2.991092e-06  5.121283e-06   1.6340   1.7122    7.506310e-06
  150  903.7215  389.9108  6.637072e-07  1.227396e-06  3.080987e-06   1.8493   2.5102    4.515831e-06
  151  548.0353  399.6530  4.223603e-06  8.161224e-06  2.287730e-05   1.9323   2.8032    3.353146e-05
  152 1004.2792  398.7266  1.009483e-06  2.557853e-06  2.391109e-05   2.5338   9.3481    3.504670e-05
  153  618.5691  399.3623  2.643415e-06  4.292624e-06  7.677369e-06   1.6239   1.7885    1.125279e-05
  154  413.0340  399.4876  5.333231e-07  9.017785e-07  1.629966e-06   1.6909   1.8075    2.389055e-06
  155 1102.1858  405.8229  7.699502e-07  1.347499e-06  2.430488e-06   1.7501   1.8037    3.562388e-06
  156  917.5014  410.8137  1.133784e-06  1.926512e-06  3.544706e-06   1.6992   1.8400    5.195508e-06
  157  503.6950  412.1884  9.947891e-07  1.672240e-06  2.741990e-06   1.6810   1.6397    4.018959e-06
  158  596.4056  412.5970  3.616300e-07  6.581860e-07  2.020833e-06   1.8201   3.0703    2.961953e-06
  159  513.9504  414.8208  1.483355e-06  2.591928e-06  4.237882e-06   1.7473   1.6350    6.211502e-06
  160 1027.4081  425.0273  3.810778e-07  7.664395e-07  9.893235e-06   2.0112  12.9080    1.450060e-05
  161  754.4062  434.5771  9.680058e-07  1.798380e-06  6.702370e-06   1.8578   3.7269    9.823724e-06
  162  826.8730  429.8341  1.503431e-05  2.674080e-05  4.634886e-05   1.7787   1.7333    6.793395e-05
  163  896.1771  435.1362  5.703479e-07  1.027266e-06  1.829851e-06   1.8011   1.7813    2.682030e-06
  164  870.9295  446.9722  3.657529e-07  7.281505e-07  2.909589e-06   1.9908   3.9959    4.264612e-06
  165 1066.5468  450.0202  1.302625e-06  2.208846e-06  3.583533e-06   1.6957   1.6224    5.252417e-06
  166  694.1668  451.6232  1.109788e-06  1.837259e-06  2.972191e-06   1.6555   1.6177    4.356367e-06
  167  578.8806  452.1365  5.386103e-07  9.418069e-07  1.559652e-06   1.7486   1.6560    2.285997e-06
  168  652.4169  459.4940  7.675600e-06  1.354465e-05  3.477757e-05   1.7646   2.5676    5.097380e-05
  169  419.3142  464.0808  6.107833e-06  1.072527e-05  1.894371e-05   1.7560   1.7663    2.776596e-05
  170  572.2443  465.4318  4.467258e-07  7.587192e-07  1.744254e-06   1.6984   2.2989    2.556569e-06
  171  458.6800  468.8483  1.147944e-06  1.973770e-06  3.511405e-06   1.7194   1.7790    5.146699e-06
  172  549.1264  473.5056  1.229662e-06  2.099062e-06  3.629715e-06   1.7070   1.7292    5.320106e-06
  173  895.9983  475.7430  6.134357e-07  1.073586e-06  1.847592e-06   1.7501   1.7210    2.708032e-06
  174  715.7652  495.4931  3.456530e-06  6.586544e-06  2.114239e-05   1.9055   3.2099    3.098860e-05
  175  968.3231  477.1575  6.483961e-07  1.067966e-06  1.776296e-06   1.6471   1.6633    2.603533e-06
  176  724.9773  478.5195  5.899012e-07  1.028181e-06  1.790514e-06   1.7430   1.7414    2.624372e-06
  177  656.0177  480.4602  5.381915e-07  9.012381e-07  1.556242e-06   1.6746   1.7268    2.280998e-06
  178  473.0913  481.3925  7.893348e-07  1.297534e-06  2.088433e-06   1.6438   1.6095    3.061035e-06
  179  513.9458  482.9109  2.372944e-06  4.219426e-06  6.955590e-06   1.7781   1.6485    1.019487e-05
  180  540.1789  482.8267  3.970148e-07  6.881899e-07  1.199667e-06   1.7334   1.7432    1.758363e-06
  181  742.9831  485.2936  4.614852e-07  7.698555e-07  1.229540e-06   1.6682   1.5971    1.802148e-06
  182  787.3815  488.6101  9.447019e-07  1.511475e-06  2.539964e-06   1.5999   1.6805    3.722848e-06
  183 1028.4071  488.5807  8.915941e-07  1.425472e-06  2.462405e-06   1.5988   1.7274    3.609170e-06
  184  995.9661  492.0888  3.424017e-06  6.156521e-06  1.023639e-05   1.7980   1.6627    1.500357e-05
  185  472.6592  492.3029  9.326223e-07  1.590303e-06  2.715759e-06   1.7052   1.7077    3.980513e-06
  186  916.9930  492.0150  5.565327e-07  1.016857e-06  1.707436e-06   1.8271   1.6791    2.502604e-06
  187  643.6078  493.7659  1.323063e-06  2.204428e-06  3.765411e-06   1.6662   1.7081    5.518997e-06
  188  839.7299  492.9810  4.879482e-07  8.495241e-07  1.336459e-06   1.7410   1.5732    1.958861e-06
  189  754.0265  494.0401  5.669743e-07  1.044449e-06  1.738709e-06   1.8421   1.6647    2.548442e-06
  190  810.5470  500.9659  3.683837e-07  6.662243e-07  1.553846e-06   1.8085   2.3323    2.277486e-06
  191  448.5991  507.5609  1.232677e-06  2.208494e-06  6.105550e-06   1.7916   2.7646    8.948960e-06
  192  640.3218  506.2174  7.297062e-07  1.209505e-06  2.055151e-06   1.6575   1.6992    3.012254e-06
  193  595.4674  510.9833  1.987666e-06  3.336125e-06  5.657890e-06   1.6784   1.6959    8.292820e-06
  194  772.9189  510.6878  6.661562e-07  1.156147e-06  2.048622e-06   1.7355   1.7719    3.002684e-06
  195  729.4927  511.0236  4.302573e-07  7.330474e-07  1.372649e-06   1.7037   1.8725    2.011904e-06
  196 1110.8053  512.0882  6.167872e-07  1.152004e-06  8.953646e-06   1.8677   7.7722    1.312344e-05
  197 1060.5501  513.0292  2.277206e-06  3.851193e-06  6.506281e-06   1.6912   1.6894    9.536316e-06
  198  383.5316  513.5306  9.989421e-07  1.522701e-06  2.428737e-06   1.5243   1.5950    3.559823e-06
  199 1072.1883  521.3860  2.559178e-07  5.599398e-07  5.884908e-06   2.1880  10.5099    8.625564e-06
  200  404.5585  520.1218  6.918380e-06  1.156990e-05  1.950855e-05   1.6723   1.6861    2.859386e-05
  201  618.7882  520.3388  7.198550e-07  1.206838e-06  2.116163e-06   1.6765   1.7535    3.101680e-06
  202  428.1576  521.8050  1.387671e-06  2.371190e-06  3.816390e-06   1.7088   1.6095    5.593717e-06
  203  541.8789  521.6851  1.210607e-06  2.087172e-06  3.602661e-06   1.7241   1.7261    5.280452e-06
  204  710.9926  522.9819  4.367565e-07  8.203050e-07  1.783859e-06   1.8782   2.1746    2.614618e-06
  205  910.3384  522.8057  1.355933e-06  2.295752e-06  3.896961e-06   1.6931   1.6975    5.711810e-06
  206  495.9890  527.3590  5.889377e-06  1.005374e-05  1.714847e-05   1.7071   1.7057    2.513467e-05
  207  713.2144  531.3158  1.666365e-06  2.790208e-06  4.701918e-06   1.6744   1.6851    6.891644e-06
  208  854.4916  531.0360  1.065457e-06  1.804187e-06  3.096009e-06   1.6933   1.7160    4.537849e-06
  209  405.3957  532.2208  4.980506e-07  8.388120e-07  1.499551e-06   1.6842   1.7877    2.197905e-06
  210  904.3571  536.0871  6.127976e-06  1.037561e-05  1.737489e-05   1.6932   1.6746    2.546653e-05
  211  736.1684  535.8287  4.241828e-07  7.208368e-07  1.058329e-06   1.6994   1.4682    1.551203e-06
  212  716.4900  549.3393  2.013411e-06  3.683920e-06  1.184047e-05   1.8297   3.2141    1.735468e-05
  213 1094.9613  538.4606  7.589493e-07  1.272184e-06  1.935471e-06   1.6762   1.5214    2.836838e-06
  214  719.0423  540.7898  4.726794e-07  8.427250e-07  1.585622e-06   1.7829   1.8815    2.324061e-06
  215  452.5133  566.9213  2.516965e-06  5.138764e-06  2.098421e-05   2.0417   4.0835    3.075675e-05
  216  917.7419  544.3988  7.523992e-06  1.245340e-05  2.151685e-05   1.6552   1.7278    3.153745e-05
  217  396.0253  542.3152  5.897926e-07  1.020777e-06  1.840239e-06   1.7307   1.8028    2.697254e-06
  218  653.9480  543.1341  4.598694e-07  8.803716e-07  2.354128e-06   1.9144   2.6740    3.450467e-06
  219 1007.6530  543.7117  9.248183e-07  1.528055e-06  2.547223e-06   1.6523   1.6670    3.733488e-06
  220 1098.8197  546.8146  7.040129e-07  1.263029e-06  2.286153e-06   1.7940   1.8101    3.350835e-06
  221  590.5526  548.5067  7.361196e-07  1.139224e-06  1.913155e-06   1.5476   1.6793    2.804129e-06
  222 1105.1882  552.0056  8.080908e-06  1.425536e-05  2.359925e-05   1.7641   1.6555    3.458964e-05
  223  626.8653  553.1180  2.715076e-06  4.829601e-06  8.169993e-06   1.7788   1.6916    1.197483e-05
  224  989.4984  551.5086  1.181608e-06  1.802988e-06  3.063263e-06   1.5259   1.6990    4.489853e-06
  225 1039.3762  552.2758  2.244580e-06  3.691695e-06  6.363200e-06   1.6447   1.7237    9.326601e-06
  226  740.9859  553.2584  4.411824e-07  7.719023e-07  1.327197e-06   1.7496   1.7194    1.945285e-06
  227  539.9691  555.0187  6.237123e-07  1.140581e-06  2.050133e-06   1.8287   1.7974    3.004899e-06
  228  946.6938  557.3861  1.418830e-06  2.297037e-06  4.049236e-06   1.6190   1.7628    5.935002e-06
  229  417.6269  557.3469  1.100671e-06  1.739691e-06  2.881624e-06   1.5806   1.6564    4.223623e-06
  230  966.7292  558.7792  3.123752e-06  5.398581e-06  9.290848e-06   1.7282   1.7210    1.361768e-05
  231  539.8667  561.8529  5.267632e-07  9.411733e-07  1.708629e-06   1.7867   1.8154    2.504353e-06
  232  472.1605  568.5282  4.722550e-06  8.023298e-06  1.386650e-05   1.6989   1.7283    2.032426e-05
  233  607.8944  577.3736  6.678255e-07  1.150250e-06  1.812298e-06   1.7224   1.5756    2.656302e-06
  234  646.9819  588.0500  1.146904e-06  2.057164e-06  3.372675e-06   1.7937   1.6395    4.943360e-06
  235  897.1550  588.5932  1.475328e-06  2.436980e-06  4.088835e-06   1.6518   1.6778    5.993043e-06
  236  876.8875  593.3921  4.815474e-07  9.714188e-07  1.401797e-05   2.0173  14.4304    2.054627e-05
  237  960.2841  589.8741  1.047521e-06  1.798418e-06  3.112969e-06   1.7168   1.7309    4.562707e-06
  238  362.4266  596.8256  1.173698e-06  1.961416e-06  3.287152e-06   1.6711   1.6759    4.818009e-06
  239  931.6759  599.3388  7.965799e-07  1.314079e-06  2.261849e-06   1.6497   1.7212    3.315213e-06
  240  661.5058  600.9998  4.083799e-07  7.151533e-07  1.536373e-06   1.7512   2.1483    2.251876e-06
  241 1086.7862  604.3769  1.435285e-05  2.408012e-05  3.984100e-05   1.6777   1.6545    5.839531e-05
  242  490.1116  604.8398  5.773557e-07  1.045615e-06  1.781447e-06   1.8110   1.7037    2.611084e-06
  243  508.5732  606.2157  9.165367e-07  1.532353e-06  2.656694e-06   1.6719   1.7337    3.893940e-06
  244  742.3310  614.6702  1.236755e-06  2.542807e-06  2.449727e-05   2.0560   9.6339    3.590587e-05
  245  534.0857  611.7072  1.290235e-06  2.216894e-06  3.652791e-06   1.7182   1.6477    5.353929e-06
  246  455.8230  615.4121  1.360951e-06  2.269167e-06  4.005611e-06   1.6673   1.7652    5.871061e-06
  247  860.4239  614.7012  7.405496e-07  1.207259e-06  2.111547e-06   1.6302   1.7490    3.094914e-06
  248 1102.2729  622.8568  1.237639e-06  2.420180e-06  7.761518e-06   1.9555   3.2070    1.137613e-05
  249  774.7901  619.5956  4.095318e-07  6.693616e-07  1.032962e-06   1.6345   1.5432    1.514021e-06
  250  584.6781  625.9185  5.340163e-06  1.069191e-05  3.331368e-05   2.0022   3.1158    4.882817e-05
  251  603.1429  625.8277  5.215676e-07  9.224184e-07  1.644696e-06   1.7686   1.7830    2.410646e-06
  252 1007.3026  628.6306  5.399408e-06  8.902173e-06  1.521618e-05   1.6487   1.7093    2.230250e-05
  253  450.0478  629.0012  5.566293e-07  1.036669e-06  1.673546e-06   1.8624   1.6143    2.452931e-06
  254  564.8608  629.6949  6.078039e-07  1.044209e-06  1.901454e-06   1.7180   1.8210    2.786979e-06
  255  415.5412  636.5034  4.918643e-06  7.883547e-06  1.422210e-05   1.6028   1.8040    2.084546e-05
  256  745.3566  635.8728  5.296144e-07  8.981560e-07  1.583458e-06   1.6959   1.7630    2.320888e-06
  257  779.4110  637.2360  4.898111e-07  7.976919e-07  1.342023e-06   1.6286   1.6824    1.967016e-06
  258  898.8554  638.1273  5.152189e-07  8.995982e-07  1.499925e-06   1.7461   1.6673    2.198454e-06
  259 1004.9720  641.4636  1.726803e-06  3.082778e-06  6.961407e-06   1.7853   2.2582    1.020340e-05
  260  762.1495  641.7665  6.310587e-07  1.104390e-06  2.326403e-06   1.7501   2.1065    3.409830e-06
  261  944.2625  642.0790  1.057096e-06  1.834673e-06  3.111095e-06   1.7356   1.6957    4.559960e-06
  262  747.9407  642.9612  5.570407e-07  1.016026e-06  1.816439e-06   1.8240   1.7878    2.662372e-06
  263  586.3816  648.3528  1.055945e-05  1.762047e-05  3.157570e-05   1.6687   1.7920    4.628079e-05
  264  951.1489  650.6796  6.617469e-07  1.152437e-06  1.935408e-06   1.7415   1.6794    2.836746e-06
  265  565.1098  655.3840  8.632086e-06  1.563767e-05  3.502821e-05   1.8116   2.2400    5.134117e-05
  266  380.7100  658.1451  4.080180e-06  6.901106e-06  1.148811e-05   1.6914   1.6647    1.683823e-05
  267 1086.8654  658.3840  4.727100e-06  7.942895e-06  1.272771e-05   1.6803   1.6024    1.865512e-05
  268  776.9421  659.7608  2.022793e-06  3.502329e-06  5.718206e-06   1.7314   1.6327    8.381227e-06
  269 1011.3269  664.4059  5.387795e-06  8.813672e-06  1.520843e-05   1.6359   1.7255    2.229113e-05
  270  665.2044  666.7926  5.153452e-07  8.901273e-07  1.820267e-06   1.7272   2.0450    2.667982e-06
  271  851.9839  678.2867  7.551677e-06  1.311909e-05  2.203340e-05   1.7372   1.6795    3.229455e-05
  272  674.6633  677.4053  1.172567e-06  1.947582e-06  3.376092e-06   1.6610   1.7335    4.948368e-06
  273  808.8248  688.3250  2.726253e-05  4.736607e-05  8.269010e-05   1.7374   1.7458    1.211996e-04
  274  534.3165  685.5064  1.156487e-06  1.833402e-06  3.303050e-06   1.5853   1.8016    4.841311e-06
  275  763.7604  688.5448  2.104712e-06  3.830970e-06  1.020725e-05   1.8202   2.6644    1.496086e-05
  276  741.1270  690.0137  6.784950e-07  1.203867e-06  2.134051e-06   1.7743   1.7727    3.127898e-06
  277  781.8568  690.8916  3.802048e-07  6.912527e-07  1.495634e-06   1.8181   2.1637    2.192164e-06
  278  663.0104  696.0613  2.177472e-06  4.244424e-06  1.246440e-05   1.9492   2.9367    1.826918e-05
  279  773.3710  703.2125  1.201425e-06  1.991008e-06  3.339322e-06   1.6572   1.6772    4.894475e-06
  280  754.0980  710.5711  1.714447e-05  2.910084e-05  5.044375e-05   1.6974   1.7334    7.393586e-05
  281  815.9438  707.1491  3.864252e-07  7.431587e-07  1.993634e-06   1.9232   2.6826    2.922088e-06
  282  849.4700  709.8398  3.428252e-06  6.013001e-06  1.220627e-05   1.7540   2.0300    1.789085e-05
  283 1002.4890  706.9437  5.630502e-07  9.272039e-07  1.565994e-06   1.6468   1.6889    2.295292e-06
  284  804.2237  708.4981  4.928950e-07  8.331083e-07  1.512054e-06   1.6902   1.8150    2.216231e-06
  285 1092.4493  708.5146  9.901477e-07  1.537593e-06  2.636171e-06   1.5529   1.7145    3.863860e-06
  286  602.9595  713.7796  5.534853e-06  9.747029e-06  1.651397e-05   1.7610   1.6943    2.420468e-05
  287  522.8740  718.1472  1.173205e-06  2.197679e-06  5.397905e-06   1.8732   2.4562    7.911759e-06
  288  978.2109  725.5087  5.961197e-06  9.619248e-06  1.645816e-05   1.6136   1.7110    2.412288e-05
  289  695.1540  729.5530  5.850864e-06  1.133506e-05  3.092230e-05   1.9373   2.7280    4.532310e-05
  290  768.5066  726.0702  5.086688e-07  8.374018e-07  1.303744e-06   1.6463   1.5569    1.910910e-06
  291  407.8201  730.4866  4.714911e-06  8.284589e-06  2.222958e-05   1.7571   2.6832    3.258210e-05
  292  812.7839  728.5794  8.973726e-07  1.521610e-06  2.743654e-06   1.6956   1.8031    4.021399e-06
  293 1002.0276  728.1919  7.488578e-07  1.343921e-06  2.203841e-06   1.7946   1.6399    3.230190e-06
  294  671.2089  729.6048  1.154880e-06  1.978609e-06  3.579271e-06   1.7133   1.8090    5.246170e-06
  295  784.6578  760.9236  4.915670e-08  9.327889e-08  1.678439e-06   1.8976  17.9938    2.460103e-06
  296  627.4413  735.8603  3.821159e-07  7.662312e-07  3.043902e-06   2.0052   3.9726    4.461475e-06
  297  806.3133  730.9576  5.036957e-07  8.694344e-07  1.442016e-06   1.7261   1.6586    2.113575e-06
  298  583.0146  733.0231  5.455204e-07  9.847538e-07  1.525960e-06   1.8052   1.5496    2.236614e-06
  299 1002.6207  734.0889  7.755716e-07  1.326326e-06  2.283199e-06   1.7101   1.7214    3.346505e-06
  300  434.7083  737.1378  3.444545e-06  6.019249e-06  1.060325e-05   1.7475   1.7616    1.554128e-05
  301  828.4480  738.5848  1.209276e-06  1.952027e-06  3.393428e-06   1.6142   1.7384    4.973779e-06
  302  851.8375  741.3853  1.787508e-06  2.983285e-06  5.110201e-06   1.6690   1.7129    7.490068e-06
  303 1025.3197  742.9017  5.741338e-06  9.811095e-06  1.655418e-05   1.7089   1.6873    2.426362e-05
  304  370.7771  742.1685  1.283964e-06  2.207601e-06  3.816591e-06   1.7194   1.7288    5.594012e-06
  305  713.6766  743.9589  5.287247e-07  9.186037e-07  1.662941e-06   1.7374   1.8103    2.437388e-06
  306  805.1856  745.8219  4.315788e-07  7.496068e-07  1.325284e-06   1.7369   1.7680    1.942481e-06
  307  947.8857  754.1321  9.023099e-07  1.589231e-06  2.702412e-06   1.7613   1.7005    3.960950e-06
  308  628.8713  762.1427  1.135322e-06  2.015347e-06  3.383045e-06   1.7751   1.6786    4.958560e-06
  309  328.5802  765.0160  7.080498e-06  1.215917e-05  2.061116e-05   1.7173   1.6951    3.020997e-05
  310  159.3610  765.5292  9.646022e-07  1.494538e-06  2.121882e-06   1.5494   1.4198    3.110062e-06
  311   70.8890  773.6046  1.502518e-05  2.716421e-05  6.053544e-05   1.8079   2.2285    8.872735e-05
  312  210.0038  770.3761  1.651878e-06  2.694089e-06  3.039611e-06   1.6309   1.1283    4.455185e-06
  313  744.7052  773.1952  8.068800e-07  1.572530e-06  5.337727e-06   1.9489   3.3944    7.823556e-06
  314 1008.6970  778.2013  1.917791e-06  3.602731e-06  1.030439e-05   1.8786   2.8602    1.510324e-05
  315   15.6581  777.1194  1.297410e-05  2.699557e-05  7.462681e-05   2.0807   2.7644    1.093812e-04
  316  572.7412  775.0177  2.011382e-06  3.503477e-06  5.521633e-06   1.7418   1.5760    8.093108e-06
  317  519.4009  775.8294  1.762014e-06  2.930169e-06  4.942969e-06   1.6630   1.6869    7.244955e-06
  318  855.3730  776.0472  1.906023e-06  3.266401e-06  5.355200e-06   1.7137   1.6395    7.849165e-06
  319  990.6940  776.4622  9.088147e-07  1.518910e-06  2.733170e-06   1.6713   1.7994    4.006033e-06
  320  713.7404  781.7261  1.152102e-06  1.971961e-06  3.371077e-06   1.7116   1.7095    4.941018e-06
  321  503.1658  785.4109  1.539222e-06  2.534697e-06  4.201034e-06   1.6467   1.6574    6.157493e-06
  322  572.5195  787.9635  1.180774e-05  1.969306e-05  3.294940e-05   1.6678   1.6731    4.829423e-05
  323   32.2168  790.3632  1.445794e-05  2.375676e-05  4.003748e-05   1.6432   1.6853    5.868330e-05
  324 1109.4373  787.8710  3.760317e-06  6.161369e-06  1.516799e-05   1.6385   2.4618    2.223187e-05
  325  594.1476  789.2098  4.465351e-06  7.665496e-06  1.254925e-05   1.7167   1.6371    1.839356e-05
  326  491.7150  789.3212  1.563810e-06  2.573432e-06  4.360905e-06   1.6456   1.6946    6.391819e-06
  327  627.3859  787.8200  4.645401e-07  7.974887e-07  1.368562e-06   1.7167   1.7161    2.005914e-06
  328  318.0661  791.2958  4.854049e-06  8.169199e-06  1.286765e-05   1.6830   1.5751    1.886023e-05
  329  706.7941  790.0136  7.155214e-07  1.276444e-06  2.063910e-06   1.7839   1.6169    3.025091e-06
  330  163.7108  791.5347  9.263261e-07  1.525359e-06  2.780473e-06   1.6467   1.8228    4.075365e-06
  331   94.6204  793.2264  4.691786e-07  8.063274e-07  1.547293e-06   1.7186   1.9189    2.267881e-06
  332  581.7918  797.6508  2.593261e-05  4.278235e-05  7.130113e-05   1.6498   1.6666    1.045067e-04
  333 1029.7712  793.8877  1.122074e-06  1.953346e-06  3.216334e-06   1.7408   1.6466    4.714210e-06
  334  551.4222  795.8690  4.647379e-06  7.724166e-06  1.276441e-05   1.6620   1.6525    1.870891e-05
  335  438.0709  795.9903  2.002762e-06  3.567915e-06  5.763518e-06   1.7815   1.6154    8.447641e-06
  336  929.3931  797.6074  7.511265e-07  1.343355e-06  3.346177e-06   1.7885   2.4909    4.904521e-06
  337  637.2302  798.6186  2.586815e-06  4.264163e-06  7.071373e-06   1.6484   1.6583    1.036458e-05
  338  883.5631  801.4256  1.808623e-05  3.008027e-05  5.563078e-05   1.6632   1.8494    8.153854e-05
  339  944.6108  801.5220  1.640931e-06  3.211863e-06  1.276150e-05   1.9573   3.9732    1.870465e-05
  340  240.8532  799.3628  6.568587e-07  1.135483e-06  1.920760e-06   1.7287   1.6916    2.815276e-06
  341  627.0237  804.0746  7.638779e-06  1.383962e-05  2.358706e-05   1.8118   1.7043    3.457177e-05
  342  868.8089  808.8465  7.923730e-06  1.497154e-05  3.924832e-05   1.8895   2.6215    5.752662e-05
  343  325.8483  801.8553  6.614272e-07  1.105369e-06  1.842249e-06   1.6712   1.6666    2.700200e-06
  344  383.1558  802.8395  4.460814e-07  7.809604e-07  1.451064e-06   1.7507   1.8581    2.126837e-06
  345  480.1902  803.5283  1.139405e-06  1.865604e-06  3.199904e-06   1.6373   1.7152    4.690128e-06
  346  728.5229  806.0273  6.760009e-07  1.139113e-06  1.910347e-06   1.6851   1.6770    2.800013e-06
  347  616.5666  816.7140  5.422847e-07  1.437629e-06  1.890506e-05   2.6511  13.1502    2.770931e-05
  348  911.2628  811.0089  5.017041e-07  8.864876e-07  1.555067e-06   1.7670   1.7542    2.279276e-06
  349  645.6057  812.9757  2.221260e-06  3.774555e-06  6.305759e-06   1.6993   1.6706    9.242408e-06
  350   48.6486  816.9624  1.048922e-06  2.340371e-06  1.477791e-05   2.2312   6.3143    2.166012e-05
  351  700.5074  813.4741  6.329053e-07  1.031591e-06  2.042539e-06   1.6299   1.9800    2.993768e-06
  352  845.7861  818.3429  1.195362e-05  1.995153e-05  3.338649e-05   1.6691   1.6734    4.893488e-05
  353 1066.8577  817.8258  6.954707e-07  1.238655e-06  2.361047e-06   1.7810   1.9061    3.460608e-06
  354 1020.1729  822.5342  1.795523e-06  2.939146e-06  4.762125e-06   1.6369   1.6202    6.979889e-06
  355  924.4318  828.5586  8.259996e-07  1.463750e-06  4.099593e-06   1.7721   2.8007    6.008810e-06
  356  131.0816  830.7373  1.566475e-05  2.718525e-05  4.587869e-05   1.7354   1.6876    6.724482e-05
  357  826.3402  827.0722  8.034751e-07  1.355221e-06  2.012094e-06   1.6867   1.4847    2.949145e-06
  358  984.5878  833.7206  2.805615e-05  4.566793e-05  8.185779e-05   1.6277   1.7925    1.199797e-04
  359  335.9289  835.9180 -3.284606e-08 -5.395978e-08  6.409861e-07   1.6428 -11.8790    9.394992e-07
  360  115.4075  831.6523  8.594912e-07  1.423388e-06  2.705071e-06   1.6561   1.9004    3.964847e-06
  361  526.0561  831.5161  5.252261e-07  8.635876e-07  1.478566e-06   1.6442   1.7121    2.167148e-06
  362  583.8581  835.4235  6.117146e-06  1.053651e-05  2.330661e-05   1.7225   2.2120    3.416071e-05
  363  795.5083  838.6813  2.431197e-06  4.526024e-06  1.412704e-05   1.8616   3.1213    2.070614e-05
  364   47.1580  834.1849  4.912800e-07  8.473349e-07  1.686764e-06   1.7247   1.9907    2.472306e-06
  365  738.4760  835.9806  6.128136e-07  1.029134e-06  1.674199e-06   1.6794   1.6268    2.453888e-06
  366  488.4868  851.3205  4.412787e-07  1.067537e-06  8.837195e-06   2.4192   8.2781    1.295276e-05
  367  685.4532  839.6366  3.959293e-07  8.230669e-07  2.873924e-06   2.0788   3.4917    4.212337e-06
  368   69.1531  845.8548  5.660647e-07  9.942073e-07  1.713049e-06   1.7563   1.7230    2.510831e-06
  369  438.4970  847.5183  7.730035e-07  1.224202e-06  2.097700e-06   1.5837   1.7135    3.074617e-06
  370 1047.9638  847.5264  1.344954e-06  2.331679e-06  4.217311e-06   1.7336   1.8087    6.181351e-06
  371  514.5108  848.5852  1.055759e-06  1.723962e-06  3.141293e-06   1.6329   1.8221    4.604221e-06
  372  568.7470  850.8897  6.020245e-07  1.138748e-06  3.052839e-06   1.8915   2.6809    4.474574e-06
  373 1079.5206  851.1011  3.432258e-06  5.784395e-06  9.940997e-06   1.6853   1.7186    1.457061e-05
  374  814.7055  862.0661  1.672831e-05  3.024919e-05  6.155376e-05   1.8083   2.0349    9.021991e-05
  375   31.4113  853.8612  1.258482e-06  2.021119e-06  3.044286e-06   1.6060   1.5062    4.462037e-06
  376  657.0332  863.3804  7.899531e-06  1.383896e-05  2.434437e-05   1.7519   1.7591    3.568177e-05
  377  562.7571  866.1057  6.146544e-06  1.070589e-05  1.767425e-05   1.7418   1.6509    2.590530e-05
  378  885.0182  867.2847  2.135824e-06  4.272067e-06  1.499026e-05   2.0002   3.5089    2.197136e-05
  379  945.9434  866.8143  5.474905e-07  1.000383e-06  2.114900e-06   1.8272   2.1141    3.099829e-06
  380  938.8373  868.1894  7.469452e-07  1.296201e-06  2.256872e-06   1.7353   1.7411    3.307918e-06
  381  994.7128  875.4765  3.306279e-05  5.310281e-05  8.903792e-05   1.6061   1.6767    1.305037e-04
  382  567.1477  873.3007  1.235607e-06  2.067463e-06  3.354911e-06   1.6732   1.6227    4.917323e-06
  383  210.2766  875.2600  1.538559e-06  2.631903e-06  4.630392e-06   1.7106   1.7593    6.786808e-06
  384  243.0203  873.9905  4.938271e-07  9.012737e-07  1.611473e-06   1.8251   1.7880    2.361950e-06
  385  454.2331  874.8235  7.773479e-07  1.353796e-06  2.340823e-06   1.7416   1.7291    3.430966e-06
  386  621.3249  875.6871  9.730079e-07  1.634510e-06  2.845508e-06   1.6799   1.7409    4.170687e-06
  387 1070.2648  875.9327  2.132874e-06  3.703918e-06  6.111085e-06   1.7366   1.6499    8.957073e-06
  388  829.7953  880.3673  1.779263e-06  2.986849e-06  5.218634e-06   1.6787   1.7472    7.648999e-06
  389  597.8201  882.4814  3.460606e-06  5.733626e-06  9.778450e-06   1.6568   1.7055    1.433236e-05
  390  486.9807  883.5649  1.156244e-06  1.919496e-06  3.084813e-06   1.6601   1.6071    4.521438e-06
  391   26.8448  883.9631  8.301430e-07  1.468303e-06  2.476973e-06   1.7687   1.6870    3.630522e-06
  392  222.6011  884.7749  1.009779e-06  1.703912e-06  2.950043e-06   1.6874   1.7313    4.323906e-06
  393 1003.2937  884.7636  7.564277e-07  1.288487e-06  2.360736e-06   1.7034   1.8322    3.460152e-06
  394  712.3905  885.2199  4.280589e-07  7.276757e-07  1.350177e-06   1.6999   1.8555    1.978967e-06
  395  878.3877  885.3584  1.044145e-06  1.732859e-06  3.057142e-06   1.6596   1.7642    4.480882e-06
  396  337.8042  887.1725  5.090759e-07  8.975539e-07  1.572700e-06   1.7631   1.7522    2.305120e-06
  397  651.3453  887.6332  8.263759e-07  1.402330e-06  2.549776e-06   1.6970   1.8182    3.737230e-06
  398  259.4806  889.5157  8.652413e-07  1.370559e-06  2.387941e-06   1.5840   1.7423    3.500027e-06
  399  224.2610  895.9661  1.920624e-06  3.345867e-06  5.676933e-06   1.7421   1.6967    8.320732e-06
  400  738.3893  894.5374  3.714271e-07  7.018862e-07  2.009500e-06   1.8897   2.8630    2.945342e-06
  401  412.5304  896.7698  9.521239e-07  1.598225e-06  2.668003e-06   1.6786   1.6694    3.910517e-06
  402  755.3755  896.7579  1.204515e-06  2.029913e-06  3.550593e-06   1.6853   1.7491    5.204137e-06
  403  123.1076  902.7617  2.610283e-05  4.553119e-05  7.655388e-05   1.7443   1.6814    1.122057e-04
  404  476.9705  899.0671  6.696389e-07  1.181777e-06  1.928369e-06   1.7648   1.6318    2.826428e-06
  405  748.7969  899.8214  4.326031e-07  7.248312e-07  1.153636e-06   1.6755   1.5916    1.690894e-06
  406   63.8713  940.5954  2.871119e-04  5.184281e-04  1.018933e-03   1.8057   1.9654    1.493459e-03
  407  322.0216  901.4960  5.459377e-07  9.089310e-07  1.583178e-06   1.6649   1.7418    2.320479e-06
  408  711.9285  909.3777  6.000203e-06  1.113961e-05  2.939398e-05   1.8565   2.6387    4.308302e-05
  409  905.4116  903.5415  2.878823e-06  4.570658e-06  7.740002e-06   1.5877   1.6934    1.134459e-05
  410  177.4344  903.2788  2.903507e-07  5.333074e-07  1.581693e-06   1.8368   2.9658    2.318302e-06
  411  927.3302  903.1171  5.863831e-07  1.017344e-06  1.692129e-06   1.7349   1.6633    2.480169e-06
  412  547.7282  912.0328  6.204615e-06  1.177074e-05  3.115282e-05   1.8971   2.6466    4.566097e-05
  413  985.9745  904.6938  6.042518e-07  1.041124e-06  1.686263e-06   1.7230   1.6197    2.471571e-06
  414  140.2163  906.2173  4.768383e-07  8.423314e-07  1.806151e-06   1.7665   2.1442    2.647293e-06
  415  211.9928  907.4430  2.132520e-06  3.526703e-06  5.993226e-06   1.6538   1.6994    8.784325e-06
  416  183.1678  909.7985  1.017627e-06  1.834862e-06  4.847871e-06   1.8031   2.6421    7.105569e-06
  417  667.3317  912.0341  1.975858e-06  3.382037e-06  5.716200e-06   1.7117   1.6902    8.378287e-06
  418 1039.8749  911.1301  5.363007e-07  9.532944e-07  1.620891e-06   1.7775   1.7003    2.375755e-06
  419  794.5809  919.6854  6.572568e-05  1.052124e-04  1.777881e-04   1.6008   1.6898    2.605856e-04
  420  927.1482  916.8667  7.535349e-07  1.481706e-06  5.029837e-06   1.9663   3.3946    7.372277e-06
  421 1078.9601  916.8145  9.819140e-06  1.707439e-05  2.771872e-05   1.7389   1.6234    4.062758e-05
  422  193.9622  916.0632  6.973598e-07  1.244072e-06  2.004793e-06   1.7840   1.6115    2.938444e-06
  423 1057.6032  919.4434  1.829449e-06  3.360560e-06  1.062643e-05   1.8369   3.1621    1.557525e-05
  424  588.7265  917.0129  5.746002e-07  9.891074e-07  1.683940e-06   1.7214   1.7025    2.468166e-06
  425  362.8131  919.7786  2.451120e-06  4.166066e-06  6.901590e-06   1.6997   1.6566    1.011572e-05
  426  107.9542  918.4895  5.205934e-07  8.679616e-07  1.179319e-06   1.6673   1.3587    1.728538e-06
  427  346.3445  924.0761  1.863934e-05  3.208508e-05  5.447106e-05   1.7214   1.6977    7.983873e-05
  428  100.4591  922.9997  1.289773e-06  2.159215e-06  3.413835e-06   1.6741   1.5811    5.003688e-06
  429  773.6755  921.8266  4.403339e-07  7.681576e-07  1.767542e-06   1.7445   2.3010    2.590702e-06
  430  847.7892  923.4889  9.933375e-07  1.652271e-06  2.720703e-06   1.6634   1.6466    3.987759e-06
  431  959.2370  925.3607  3.598422e-06  5.946431e-06  1.004275e-05   1.6525   1.6889    1.471976e-05
  432  446.0108  928.0582  6.447343e-07  1.169162e-06  2.017721e-06   1.8134   1.7258    2.957391e-06
  433  909.9343  935.0034  1.306354e-06  2.583468e-06  8.820693e-06   1.9776   3.4143    1.292857e-05
  434  401.0650  933.2691  1.401976e-05  2.393004e-05  3.902923e-05   1.7069   1.6310    5.720550e-05
  435  174.4964  934.4887  7.089334e-07  1.123610e-06  1.877684e-06   1.5849   1.6711    2.752139e-06
  436  210.5388  962.5363  1.720845e-04  2.812708e-04  5.119865e-04   1.6345   1.8203    7.504233e-04
  437  467.6267  942.5701  7.178776e-06  1.253053e-05  2.998283e-05   1.7455   2.3928    4.394611e-05
  438 1026.4365  944.2348  5.300569e-06  9.967688e-06  2.901070e-05   1.8805   2.9105    4.252124e-05
  439  520.0280  939.2486  7.601183e-07  1.318090e-06  2.192597e-06   1.7341   1.6635    3.213710e-06
  440  601.0038  942.8292  8.905096e-07  1.583122e-06  2.759849e-06   1.7778   1.7433    4.045136e-06
  441  320.6029  943.7725  5.894772e-07  9.614640e-07  1.481554e-06   1.6310   1.5409    2.171528e-06
  442 1088.4941  944.9798  6.097964e-07  1.054315e-06  1.698983e-06   1.7290   1.6115    2.490214e-06
  443 1007.0311  945.4970  3.825103e-07  7.042668e-07  1.886988e-06   1.8412   2.6794    2.765776e-06
  444  751.3131  949.9412  4.826404e-07  8.332149e-07  1.515951e-06   1.7264   1.8194    2.221943e-06
  445  952.4698  956.2271  4.821754e-06  9.036027e-06  2.655019e-05   1.8740   2.9383    3.891485e-05
  446  162.8437  955.1643  4.806818e-07  8.420053e-07  1.574694e-06   1.7517   1.8702    2.308044e-06
  447  995.5357  956.4533  2.189793e-06  3.442291e-06  5.856852e-06   1.5720   1.7014    8.584441e-06
  448  614.7516  958.0797  1.190235e-06  2.082449e-06  3.598450e-06   1.7496   1.7280    5.274280e-06
  449  592.9783  959.5192  3.556352e-06  6.098271e-06  1.030715e-05   1.7148   1.6902    1.510729e-05
  450  743.1003  966.6285  5.314630e-05  9.234724e-05  1.642926e-04   1.7376   1.7791    2.408051e-04
  451  908.6330  964.9113  1.197740e-05  2.049158e-05  3.524173e-05   1.7109   1.7198    5.165413e-05
  452  577.5118  965.7955  6.664166e-06  1.109125e-05  1.927670e-05   1.6643   1.7380    2.825404e-05
  453   44.5319  974.2709  1.241485e-05  2.132353e-05  4.068824e-05   1.7176   1.9081    5.963713e-05
  454  962.4164  967.7699  4.645774e-06  7.661620e-06  1.287032e-05   1.6492   1.6798    1.886414e-05
  455  623.5400  969.8840  3.973084e-06  6.689346e-06  1.155918e-05   1.6837   1.7280    1.694239e-05
  456  122.1847  974.4118  1.105414e-06  1.912924e-06  3.795805e-06   1.7305   1.9843    5.563546e-06
  457  466.8244  974.1822  5.332250e-07  9.383228e-07  1.687512e-06   1.7597   1.7984    2.473402e-06
  458  379.5238  982.7862  1.411735e-05  2.469453e-05  5.110721e-05   1.7492   2.0696    7.490831e-05
  459  281.5620  980.0032  9.885039e-07  1.665451e-06  2.744254e-06   1.6848   1.6478    4.022279e-06
  460  894.8776  980.4209  1.004570e-06  1.699208e-06  2.985736e-06   1.6915   1.7571    4.376220e-06
  461  775.8241  982.1700  7.993711e-07  1.380583e-06  2.259612e-06   1.7271   1.6367    3.311934e-06
  462  597.5755  985.0364  4.619475e-06  7.765151e-06  1.301690e-05   1.6810   1.6763    1.907899e-05
  463  839.1839  982.8382  4.998613e-07  8.707315e-07  1.391957e-06   1.7419   1.5986    2.040204e-06
  464  425.1036  988.9734  6.589843e-06  1.169312e-05  1.880948e-05   1.7744   1.6086    2.756922e-05
  465  367.1346  987.6407  7.228176e-07  1.186276e-06  1.846975e-06   1.6412   1.5570    2.707129e-06
  466  792.5206  988.4619  8.538944e-07  1.336241e-06  2.257738e-06   1.5649   1.6896    3.309188e-06
  467  854.6833  993.4067  1.150176e-07  2.551525e-07  3.061742e-06   2.2184  11.9997    4.487623e-06
  468  930.3859  995.8265  1.975637e-07  4.189471e-07  1.997999e-06   2.1206   4.7691    2.928485e-06
  469  121.0077  990.7178  5.448205e-07  9.615507e-07  1.621527e-06   1.7649   1.6864    2.376686e-06
  470  216.9674  991.0826  6.630395e-07  1.183811e-06  2.037694e-06   1.7854   1.7213    2.986667e-06
  471  261.4780  995.3401  3.159675e-06  5.015053e-06  8.450980e-06   1.5872   1.6851    1.238668e-05
  472  651.8206  995.2057  1.871499e-06  3.241656e-06  5.427691e-06   1.7321   1.6744    7.955415e-06
  473  965.8054  994.4566  7.501396e-07  1.272935e-06  2.391085e-06   1.6969   1.8784    3.504635e-06
  474  715.1385  995.1590  7.161818e-07  1.251667e-06  2.035192e-06   1.7477   1.6260    2.983000e-06
  475  194.2912  999.1119  1.435552e-06  2.447840e-06  3.970450e-06   1.7052   1.6220    5.819524e-06
  476  836.1724  998.8359  4.942348e-07  8.549128e-07  1.199900e-06   1.7298   1.4035    1.758705e-06
  477  452.1426 1002.5643  1.539128e-06  2.570160e-06  4.283483e-06   1.6699   1.6666    6.278340e-06
  478  893.0957 1004.3354  1.186902e-06  2.063953e-06  3.661560e-06   1.7389   1.7741    5.366782e-06
  479 1063.3481 1004.0819  1.056963e-06  1.803279e-06  3.032580e-06   1.7061   1.6817    4.444880e-06
  480  358.6935 1007.1390  8.756982e-07  1.549129e-06  3.621655e-06   1.7690   2.3379    5.308293e-06
  481  538.2075 1014.1521  2.166684e-06  5.840259e-06  4.435117e-05   2.6955   7.5940    6.500591e-05
  482  826.4677 1010.7441  3.229001e-06  5.240756e-06  8.839028e-06   1.6230   1.6866    1.295544e-05
  483  920.1370 1010.5164  1.746150e-06  2.908253e-06  4.937062e-06   1.6655   1.6976    7.236296e-06
  484 1022.7086 1009.0032  6.932633e-07  1.209814e-06  2.075100e-06   1.7451   1.7152    3.041493e-06
  485 1068.1829 1008.8188  7.375257e-07  1.279945e-06  2.049273e-06   1.7355   1.6011    3.003638e-06
  486  778.8239 1012.9059  9.158412e-07  1.601044e-06  2.786203e-06   1.7482   1.7402    4.083762e-06
  487  284.2475 1014.9300  1.409317e-06  2.456524e-06  3.900238e-06   1.7431   1.5877    5.716614e-06
  488  471.6879 1015.0549  6.104529e-07  1.053235e-06  1.699173e-06   1.7253   1.6133    2.490493e-06
  489  973.2734 1017.6101  2.815588e-06  4.635245e-06  8.300561e-06   1.6463   1.7907    1.216621e-05
  490  680.6792 1020.9200  1.476542e-06  2.530620e-06  4.198561e-06   1.7139   1.6591    6.153868e-06
  491 1065.4376 1021.7039  1.124509e-06  1.870635e-06  3.643209e-06   1.6635   1.9476    5.339885e-06
  492  632.2516 1028.5275  1.157337e-06  1.848334e-06  3.034073e-06   1.5971   1.6415    4.447069e-06
  493  979.6684 1029.2182  1.707652e-06  2.865026e-06  4.930155e-06   1.6778   1.7208    7.226173e-06
  494   55.0514 1031.0987  3.749202e-06  6.695970e-06  1.146318e-05   1.7860   1.7120    1.680169e-05
  495  103.4055 1044.3823  3.284296e-06  5.927401e-06  1.842696e-05   1.8048   3.1088    2.700856e-05
  496 1105.0100 1031.9918  2.660792e-06  4.898268e-06  9.929161e-06   1.8409   2.0271    1.455326e-05
  497  762.4351 1036.8353  1.043180e-06  1.780159e-06  3.620424e-06   1.7065   2.0338    5.306488e-06
  498  130.2241 1043.5230  8.251424e-06  1.361068e-05  2.322629e-05   1.6495   1.7065    3.404298e-05
  499  665.0076 1042.6579  1.459125e-06  2.492385e-06  4.143528e-06   1.7081   1.6625    6.073206e-06
  500  752.9802 1043.9327  8.037970e-07  1.429009e-06  2.350898e-06   1.7778   1.6451    3.445732e-06
  501  589.0123 1050.5988  1.208319e-06  2.045276e-06  3.502209e-06   1.6927   1.7123    5.133219e-06
  502  487.4909 1052.4948  1.072102e-06  1.662731e-06  2.745794e-06   1.5509   1.6514    4.024536e-06
  503  222.9666 1054.9450  7.886732e-07  1.407156e-06  2.361829e-06   1.7842   1.6784    3.461754e-06
  504  547.8842 1058.8240  6.357654e-07  1.106758e-06  1.884928e-06   1.7408   1.7031    2.762756e-06
  505  908.5102 1062.3438  1.481863e-06  2.347250e-06  4.073680e-06   1.5840   1.7355    5.970830e-06
  506  199.2984 1065.0076  1.150410e-06  1.995970e-06  3.228483e-06   1.7350   1.6175    4.732017e-06
  507  129.4963 1066.7629  6.786094e-07  1.117979e-06  2.042995e-06   1.6475   1.8274    2.994437e-06
  508  177.2328 1070.4130  3.359846e-06  4.064848e-06  5.328115e-06   1.2098   1.3108    7.809467e-06
  509 1060.2624 1071.3140  1.708692e-06  2.918173e-06  5.244236e-06   1.7078   1.7971    7.686524e-06
  510  921.6135 1074.2275  5.722544e-07  9.633794e-07  1.610208e-06   1.6835   1.6714    2.360097e-06
  511  753.0120 1077.7914  8.796329e-07  1.528311e-06  2.559895e-06   1.7374   1.6750    3.752062e-06
  512  836.6864 1077.5810  7.908533e-07  1.330421e-06  2.457081e-06   1.6823   1.8468    3.601367e-06
  513  476.6464 1079.8823  1.096929e-06  1.902038e-06  3.316796e-06   1.7340   1.7438    4.861458e-06
  514  310.8834 1083.8271  6.481818e-07  1.156915e-06  2.029721e-06   1.7849   1.7544    2.974981e-06
  515  675.3222 1088.9156  9.159236e-06  1.613381e-05  2.861839e-05   1.7615   1.7738    4.194624e-05
  516  820.2807 1087.0762  1.827470e-06  3.133814e-06  5.380167e-06   1.7148   1.7168    7.885760e-06
  517 1037.8390 1088.1589  6.562203e-07  1.132295e-06  1.854907e-06   1.7255   1.6382    2.718754e-06
  518   96.9217 1092.9585  2.391087e-06  4.688402e-06  1.627356e-05   1.9608   3.4710    2.385230e-05
  519  880.3329 1093.9091  6.793336e-07  1.152627e-06  1.958692e-06   1.6967   1.6993    2.870873e-06
  520  610.6338 1102.6624  3.579239e-06  6.578821e-06  1.842506e-05   1.8380   2.8007    2.700578e-05
  521  250.8623 1108.5011  3.948634e-07  1.162666e-06  1.197491e-05   2.9445  10.2995    1.755173e-05
  522  207.9637 1127.0476  1.177875e-04  2.157250e-04  3.708164e-04   1.8315   1.7189    5.435090e-04
  523  566.9704 1113.7938  2.286469e-05  4.007559e-05  6.655534e-05   1.7527   1.6607    9.755076e-05
  524  577.4837 1111.9942  6.262969e-07  1.080553e-06  2.481622e-06   1.7253   2.2966    3.637336e-06
  525  871.8186 1114.5288  1.605775e-06  2.519408e-06  3.670725e-06   1.5690   1.4570    5.380216e-06
  526  537.2825 1120.2079  1.759880e-05  2.913493e-05  4.665099e-05   1.6555   1.6012    6.837678e-05
  527  705.8403 1115.8303  6.105549e-07  1.067964e-06  1.873521e-06   1.7492   1.7543    2.746037e-06
  528  347.2727 1117.0138  4.950475e-07  8.823611e-07  1.629736e-06   1.7824   1.8470    2.388719e-06
  529  191.7102 1119.9676  5.326186e-07  9.465852e-07  1.830131e-06   1.7772   1.9334    2.682440e-06
  530  718.1355 1121.6323  3.490402e-06  5.807847e-06  9.637133e-06   1.6639   1.6593    1.412523e-05
  531  548.2488 1127.3788  4.870325e-06  8.225834e-06  1.638582e-05   1.6890   1.9920    2.401685e-05
  532 1029.9788 1129.4990  1.664960e-06  3.089179e-06  9.415952e-06   1.8554   3.0480    1.380105e-05
  533  118.9411 1127.4900  3.368988e-06  5.452547e-06  8.516107e-06   1.6185   1.5619    1.248213e-05
  534  956.0520 1127.9897  8.280832e-07  1.532876e-06  2.771168e-06   1.8511   1.8078    4.061726e-06
  535  135.0353 1130.0024  1.826118e-06  3.264537e-06  5.260714e-06   1.7877   1.6115    7.710677e-06
  536  177.0265 1131.5377  1.794632e-06  3.039420e-06  5.198656e-06   1.6936   1.7104    7.619717e-06
  537  289.2897 1135.0691  8.678484e-07  1.847315e-06  1.187067e-05   2.1286   6.4259    1.739895e-05
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at catalog table that shows all columns, but subset of rows</span>
<span class="c1"># Pay attention to rows with a large number of nans, as this may indicate a spurious source</span>

<span class="n">catalog</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s2">&quot;starfield_combined_cat.ecsv&quot;</span><span class="p">)</span>
<span class="n">catalog</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=537</i>
<table id="table139893399111712" class="table-striped table-bordered table-condensed">
<thead><tr><th>label</th><th>xcentroid</th><th>ycentroid</th><th>sky_centroid</th><th>aper_bkg_flux</th><th>aper_bkg_flux_err</th><th>aper30_flux</th><th>aper30_flux_err</th><th>aper50_flux</th><th>aper50_flux_err</th><th>aper70_flux</th><th>aper70_flux_err</th><th>aper_total_flux</th><th>aper_total_flux_err</th><th>aper30_abmag</th><th>aper30_abmag_err</th><th>aper50_abmag</th><th>aper50_abmag_err</th><th>aper70_abmag</th><th>aper70_abmag_err</th><th>aper_total_abmag</th><th>aper_total_abmag_err</th><th>aper30_vegamag</th><th>aper30_vegamag_err</th><th>aper50_vegamag</th><th>aper50_vegamag_err</th><th>aper70_vegamag</th><th>aper70_vegamag_err</th><th>aper_total_vegamag</th><th>aper_total_vegamag_err</th><th>CI_50_30</th><th>CI_70_50</th><th>CI_70_30</th><th>is_extended</th><th>sharpness</th><th>roundness</th><th>nn_label</th><th>nn_dist</th><th>isophotal_flux</th><th>isophotal_flux_err</th><th>isophotal_abmag</th><th>isophotal_abmag_err</th><th>isophotal_vegamag</th><th>isophotal_vegamag_err</th><th>isophotal_area</th><th>semimajor_sigma</th><th>semiminor_sigma</th><th>ellipticity</th><th>orientation</th><th>sky_orientation</th><th>sky_bbox_ll</th><th>sky_bbox_ul</th><th>sky_bbox_lr</th><th>sky_bbox_ur</th></tr></thead>
<thead><tr><th></th><th></th><th></th><th>deg,deg</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th>Jy</th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th></th><th>pix</th><th>Jy</th><th>Jy</th><th></th><th></th><th></th><th></th><th>pix2</th><th>pix</th><th>pix</th><th></th><th>deg</th><th>deg</th><th>deg,deg</th><th>deg,deg</th><th>deg,deg</th><th>deg,deg</th></tr></thead>
<thead><tr><th>int64</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>bool</th><th>float64</th><th>float32</th><th>int64</th><th>float64</th><th>float64</th><th>float32</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>SkyCoord</th><th>SkyCoord</th><th>SkyCoord</th><th>SkyCoord</th></tr></thead>
<tr><td>1</td><td>675.9528</td><td>4.5782</td><td>0.0011643021952263142,-0.01830489268840215</td><td>0.000000e+00</td><td>1.715720e-09</td><td>9.821837e-07</td><td>1.339439e-01</td><td>1.534174e-06</td><td>nan</td><td>1.941163e-06</td><td>nan</td><td>2.845180e-06</td><td>nan</td><td>23.919518</td><td>12.836834</td><td>23.435314</td><td>nan</td><td>23.179845</td><td>nan</td><td>22.764726</td><td>nan</td><td>19.535538</td><td>12.836834</td><td>19.051334</td><td>nan</td><td>18.795865</td><td>nan</td><td>18.380746</td><td>nan</td><td>1.5620</td><td>1.2653</td><td>1.9764</td><td>False</td><td>0.568360</td><td>0.078816</td><td>4</td><td>21.512007</td><td>1.649209e-06</td><td>1.891196e-01</td><td>23.356811</td><td>12.648662</td><td>18.972831</td><td>12.648662</td><td>7.0</td><td>0.740210</td><td>0.647046</td><td>0.125861</td><td>2.912358</td><td>97.927558</td><td>0.0012059555612529368,-0.018341867370392867</td><td>0.001216720709398941,-0.018219196007762416</td><td>0.001083284187095296,-0.018331102220009193</td><td>0.0010940493352465512,-0.0182084308573814</td></tr>
<tr><td>2</td><td>800.8166</td><td>16.5479</td><td>359.9973672147296,-0.01760176195917782</td><td>8.985366e-08</td><td>6.958065e-09</td><td>2.376843e-06</td><td>1.538523e-01</td><td>4.612498e-06</td><td>2.196033e-01</td><td>1.487258e-05</td><td>4.843302e-01</td><td>2.179888e-05</td><td>7.098871e-01</td><td>22.959999</td><td>12.027775</td><td>22.240160</td><td>11.694279</td><td>20.969034</td><td>11.281921</td><td>20.553915</td><td>11.281921</td><td>18.576019</td><td>12.027775</td><td>17.856180</td><td>11.694279</td><td>16.585054</td><td>11.281921</td><td>16.169935</td><td>11.281921</td><td>1.9406</td><td>3.2244</td><td>6.2573</td><td>False</td><td>0.534354</td><td>0.133601</td><td>10</td><td>24.263266</td><td>3.508872e-05</td><td>8.083786e-01</td><td>20.037081</td><td>10.906165</td><td>15.653101</td><td>10.906165</td><td>134.0</td><td>3.636112</td><td>2.016595</td><td>0.445398</td><td>-82.555654</td><td>12.459546</td><td>359.99750591166674,-0.017893550174310584</td><td>359.99755704612045,-0.017310861203113183</td><td>359.99716856539334,-0.017863946004112754</td><td>359.997219699847,-0.017281257033337896</td></tr>
<tr><td>3</td><td>773.0351</td><td>12.4837</td><td>359.9982082734572,-0.017801169462608284</td><td>3.914661e-08</td><td>3.140915e-09</td><td>4.884717e-07</td><td>1.319843e-01</td><td>8.393948e-07</td><td>1.889894e-01</td><td>1.537787e-06</td><td>4.324091e-01</td><td>2.253949e-06</td><td>6.337859e-01</td><td>24.677901</td><td>13.579211</td><td>24.090084</td><td>13.381183</td><td>23.432759</td><td>13.622500</td><td>23.017640</td><td>13.622500</td><td>20.293922</td><td>13.579211</td><td>19.706105</td><td>13.381183</td><td>19.048779</td><td>13.622500</td><td>18.633660</td><td>13.622500</td><td>1.7184</td><td>1.8320</td><td>3.1482</td><td>False</td><td>0.611484</td><td>0.414439</td><td>7</td><td>11.853329</td><td>1.255048e-06</td><td>1.996491e-01</td><td>23.653349</td><td>13.004024</td><td>19.269370</td><td>13.004024</td><td>8.0</td><td>0.825088</td><td>0.701610</td><td>0.149655</td><td>89.786287</td><td>184.801487</td><td>359.9982500137629,-0.01786613756742559</td><td>359.9982634701981,-0.017712798364445934</td><td>359.9981273423902,-0.01785537241516954</td><td>359.9981407988254,-0.01770203321223015</td></tr>
<tr><td>4</td><td>695.1160</td><td>14.3526</td><td>0.0006029157608153318,-0.017953557224701003</td><td>8.588586e-10</td><td>1.899990e-09</td><td>3.457290e-06</td><td>1.590210e-01</td><td>5.722881e-06</td><td>2.221751e-01</td><td>9.466951e-06</td><td>4.571927e-01</td><td>1.387580e-05</td><td>6.701116e-01</td><td>22.553160</td><td>11.656820</td><td>22.005963</td><td>11.472730</td><td>21.459475</td><td>11.709745</td><td>21.044355</td><td>11.709745</td><td>18.169181</td><td>11.656820</td><td>17.621983</td><td>11.472730</td><td>17.075495</td><td>11.709745</td><td>16.660375</td><td>11.709745</td><td>1.6553</td><td>1.6542</td><td>2.7383</td><td>False</td><td>0.638095</td><td>-0.029817</td><td>1</td><td>21.512007</td><td>9.051642e-06</td><td>3.869643e-01</td><td>21.508182</td><td>11.577384</td><td>17.124202</td><td>11.577384</td><td>27.0</td><td>1.239715</td><td>1.173809</td><td>0.053163</td><td>19.788371</td><td>114.803571</td><td>0.0006754646742226116,-0.01804808146777341</td><td>0.0006943036834938691,-0.01783340658260945</td><td>0.00046078976987191635,-0.018029242453984667</td><td>0.0004796287791428601,-0.01781456756888773</td></tr>
<tr><td>5</td><td>562.6560</td><td>17.9919</td><td>0.004674973066521394,-0.018198436219100042</td><td>6.299031e-08</td><td>2.725876e-09</td><td>1.190594e-06</td><td>1.432617e-01</td><td>2.281449e-06</td><td>2.015974e-01</td><td>6.606575e-06</td><td>4.567868e-01</td><td>9.683317e-06</td><td>6.695166e-01</td><td>23.710590</td><td>12.700925</td><td>23.004473</td><td>12.365698</td><td>21.850059</td><td>12.099359</td><td>21.434940</td><td>12.099359</td><td>19.326611</td><td>12.700925</td><td>18.620494</td><td>12.365698</td><td>17.466079</td><td>12.099359</td><td>17.050960</td><td>12.099359</td><td>1.9162</td><td>2.8958</td><td>5.5490</td><td>False</td><td>0.551426</td><td>0.383012</td><td>6</td><td>13.336526</td><td>1.343607e-05</td><td>6.295931e-01</td><td>21.079319</td><td>11.676992</td><td>16.695339</td><td>11.676992</td><td>77.0</td><td>2.478983</td><td>1.919964</td><td>0.225504</td><td>21.075816</td><td>116.091016</td><td>0.004821006141421886,-0.018350069574861464</td><td>0.00484791901158842,-0.018043391166382483</td><td>0.00445299201634376,-0.01831777413078785</td><td>0.004479904886539779,-0.018011095722322387</td></tr>
<tr><td>6</td><td>575.8128</td><td>15.8102</td><td>0.004265608904306342,-0.018229936654502305</td><td>1.964075e-08</td><td>2.766051e-09</td><td>3.930516e-07</td><td>1.297218e-01</td><td>7.520629e-07</td><td>1.848884e-01</td><td>2.026116e-06</td><td>4.313434e-01</td><td>2.969696e-06</td><td>6.322240e-01</td><td>24.913876</td><td>13.796412</td><td>24.209365</td><td>13.476643</td><td>23.133339</td><td>13.320402</td><td>22.718220</td><td>13.320402</td><td>20.529896</td><td>13.796412</td><td>19.825385</td><td>13.476643</td><td>18.749360</td><td>13.320402</td><td>18.334240</td><td>13.320402</td><td>1.9134</td><td>2.6941</td><td>5.1548</td><td>False</td><td>0.514474</td><td>-0.206728</td><td>5</td><td>13.336526</td><td>7.853684e-07</td><td>1.702392e-01</td><td>24.162316</td><td>13.339971</td><td>19.778337</td><td>13.339971</td><td>6.0</td><td>0.767940</td><td>0.569826</td><td>0.257980</td><td>43.181550</td><td>138.196750</td><td>0.004302344084623272,-0.018273649854745957</td><td>0.0043131092327074174,-0.018150978491435613</td><td>0.0041796727096503035,-0.01826288470646635</td><td>0.004190437857739842,-0.01814021334314411</td></tr>
<tr><td>7</td><td>764.1451</td><td>20.3239</td><td>359.9985020124224,-0.017584653917550503</td><td>2.054573e-08</td><td>1.774916e-09</td><td>6.260836e-07</td><td>1.313762e-01</td><td>1.104910e-06</td><td>1.867761e-01</td><td>2.078210e-06</td><td>3.972201e-01</td><td>3.046051e-06</td><td>5.822091e-01</td><td>24.408419</td><td>13.304716</td><td>23.791682</td><td>13.069992</td><td>23.105776</td><td>13.203360</td><td>22.690657</td><td>13.203360</td><td>20.024439</td><td>13.304716</td><td>19.407703</td><td>13.069992</td><td>18.721797</td><td>13.203360</td><td>18.306677</td><td>13.203360</td><td>1.7648</td><td>1.8809</td><td>3.3194</td><td>False</td><td>0.629158</td><td>0.143174</td><td>3</td><td>11.853329</td><td>1.536663e-06</td><td>2.072319e-01</td><td>23.433553</td><td>12.824703</td><td>19.049573</td><td>12.824703</td><td>9.0</td><td>0.918582</td><td>0.687141</td><td>0.251955</td><td>-69.842718</td><td>25.172482</td><td>359.99854755464804,-0.017645016434680545</td><td>359.9985610110832,-0.0174916772312152</td><td>359.99842488327516,-0.01763425128266237</td><td>359.99843833971033,-0.01748091207922125</td></tr>
<tr><td>8</td><td>537.2964</td><td>24.0008</td><td>0.005468866604325478,-0.01808240781480801</td><td>-2.828903e-09</td><td>3.994404e-09</td><td>4.691052e-07</td><td>9.342997e-02</td><td>9.154008e-07</td><td>1.302383e-01</td><td>2.360698e-06</td><td>3.341556e-01</td><td>3.460096e-06</td><td>4.897749e-01</td><td>24.721824</td><td>13.248045</td><td>23.995972</td><td>12.882826</td><td>22.967399</td><td>12.877278</td><td>22.552280</td><td>12.877278</td><td>20.337845</td><td>13.248045</td><td>19.611992</td><td>12.882826</td><td>18.583419</td><td>12.877278</td><td>18.168300</td><td>12.877278</td><td>1.9514</td><td>2.5789</td><td>5.0323</td><td>False</td><td>0.446103</td><td>-0.482979</td><td>9</td><td>11.251183</td><td>7.981771e-07</td><td>1.199567e-01</td><td>24.144752</td><td>12.942320</td><td>19.760772</td><td>12.942320</td><td>6.0</td><td>0.931804</td><td>0.549242</td><td>0.410561</td><td>-0.022515</td><td>94.992685</td><td>0.005519920287448713,-0.018133267319444618</td><td>0.005530685435489823,-0.01801059595581501</td><td>0.005366581068588843,-0.018119810885069778</td><td>0.005377346216635454,-0.017997139521446846</td></tr>
<tr><td>9</td><td>548.5314</td><td>23.3973</td><td>0.005122689703194224,-0.018070677107234232</td><td>1.579254e-08</td><td>4.234792e-09</td><td>3.594430e-07</td><td>8.890298e-02</td><td>6.589327e-07</td><td>1.397484e-01</td><td>1.941445e-06</td><td>3.505715e-01</td><td>2.845594e-06</td><td>5.138358e-01</td><td>25.010925</td><td>13.483220</td><td>24.352897</td><td>13.316269</td><td>23.179687</td><td>13.141635</td><td>22.764568</td><td>13.141635</td><td>20.626945</td><td>13.483220</td><td>19.968918</td><td>13.316269</td><td>18.795707</td><td>13.141635</td><td>18.380588</td><td>13.141635</td><td>1.8332</td><td>2.9463</td><td>5.4013</td><td>False</td><td>-0.071966</td><td>0.184805</td><td>8</td><td>11.251183</td><td>1.571135e-06</td><td>1.664748e-01</td><td>23.409467</td><td>12.562848</td><td>19.025487</td><td>12.562848</td><td>13.0</td><td>2.338838</td><td>0.412148</td><td>0.823781</td><td>6.579680</td><td>101.594880</td><td>0.005274577537278771,-0.01811173702438768</td><td>0.005282651398316554,-0.01801973350168089</td><td>0.004967899099616788,-0.018084824155128347</td><td>0.0049759729606624475,-0.017992820632426198</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>528</td><td>347.2727</td><td>1117.0138</td><td>0.014238094862286494,0.014926535571607832</td><td>1.062130e-08</td><td>1.338179e-09</td><td>4.950475e-07</td><td>1.331027e-01</td><td>8.823611e-07</td><td>1.901867e-01</td><td>1.629736e-06</td><td>4.351599e-01</td><td>2.388719e-06</td><td>6.378179e-01</td><td>24.663383</td><td>13.573854</td><td>24.035884</td><td>13.333839</td><td>23.369707</td><td>13.566333</td><td>22.954587</td><td>13.566333</td><td>20.279403</td><td>13.573854</td><td>19.651904</td><td>13.333839</td><td>18.985727</td><td>13.566333</td><td>18.570608</td><td>13.566333</td><td>1.7824</td><td>1.8470</td><td>3.2921</td><td>False</td><td>0.595511</td><td>0.433317</td><td>514</td><td>49.249776</td><td>9.846881e-07</td><td>1.884709e-01</td><td>23.916753</td><td>13.204870</td><td>19.532773</td><td>13.204870</td><td>7.0</td><td>0.735668</td><td>0.678668</td><td>0.077481</td><td>86.653499</td><td>181.668699</td><td>0.014288387150742429,0.014875340127903284</td><td>0.01429915229806017,0.01499801149093188</td><td>0.014165715779467403,0.014886105279389984</td><td>0.014176480926784965,0.015008776642424204</td></tr>
<tr><td>529</td><td>191.7102</td><td>1119.9676</td><td>0.019016810618830805,0.014598459548012855</td><td>5.665596e-09</td><td>1.840528e-09</td><td>5.326186e-07</td><td>1.327808e-01</td><td>9.465852e-07</td><td>1.936473e-01</td><td>1.830131e-06</td><td>4.441310e-01</td><td>2.682440e-06</td><td>6.509669e-01</td><td>24.583959</td><td>13.491802</td><td>23.959601</td><td>13.277134</td><td>23.243794</td><td>13.462577</td><td>22.828675</td><td>13.462577</td><td>20.199979</td><td>13.491802</td><td>19.575621</td><td>13.277134</td><td>18.859815</td><td>13.462577</td><td>18.444695</td><td>13.462577</td><td>1.7772</td><td>1.9334</td><td>3.4361</td><td>False</td><td>0.595625</td><td>0.170710</td><td>522</td><td>17.728544</td><td>1.013688e-06</td><td>1.915931e-01</td><td>23.885240</td><td>13.191195</td><td>19.501260</td><td>13.191195</td><td>7.0</td><td>0.737640</td><td>0.674264</td><td>0.085917</td><td>83.708346</td><td>178.723546</td><td>0.01904997658028063,0.014550193982176161</td><td>0.01906074172706416,0.014672865343502227</td><td>0.018927305212694555,0.01456095913602849</td><td>0.01893807035948024,0.014683630497389447</td></tr>
<tr><td>530</td><td>718.1355</td><td>1121.6323</td><td>0.0028769630615498357,0.01606627389204352</td><td>-1.120955e-09</td><td>2.348914e-09</td><td>3.490402e-06</td><td>1.621290e-01</td><td>5.807847e-06</td><td>2.237109e-01</td><td>9.637133e-06</td><td>4.553017e-01</td><td>1.412523e-05</td><td>6.673398e-01</td><td>22.542811</td><td>11.667486</td><td>21.989962</td><td>11.464208</td><td>21.440130</td><td>11.685901</td><td>21.025011</td><td>11.685901</td><td>18.158832</td><td>11.667486</td><td>17.605982</td><td>11.464208</td><td>17.056151</td><td>11.685901</td><td>16.641031</td><td>11.685901</td><td>1.6639</td><td>1.6593</td><td>2.7610</td><td>False</td><td>0.608856</td><td>0.027462</td><td>527</td><td>13.595424</td><td>9.130446e-06</td><td>3.989905e-01</td><td>21.498770</td><td>11.601201</td><td>17.114790</td><td>11.601201</td><td>29.0</td><td>1.257635</td><td>1.206698</td><td>0.040502</td><td>65.854481</td><td>160.869681</td><td>0.0029493590055750547,0.015963119877205386</td><td>0.002968198014558434,0.016177794762848516</td><td>0.0027346841024657614,0.015981958880930437</td><td>0.0027535231114569456,0.016196633766506402</td></tr>
<tr><td>531</td><td>548.2488</td><td>1127.3788</td><td>0.008102488232169148,0.015785291906440336</td><td>7.230905e-08</td><td>3.841395e-09</td><td>4.870325e-06</td><td>1.788310e-01</td><td>8.225834e-06</td><td>2.445200e-01</td><td>1.638582e-05</td><td>4.893661e-01</td><td>2.401685e-05</td><td>7.172683e-01</td><td>22.181105</td><td>11.412242</td><td>21.612050</td><td>11.182872</td><td>20.863829</td><td>11.187951</td><td>20.448710</td><td>11.187951</td><td>17.797125</td><td>11.412242</td><td>17.228070</td><td>11.182872</td><td>16.479850</td><td>11.187951</td><td>16.064730</td><td>11.187951</td><td>1.6890</td><td>1.9920</td><td>3.3644</td><td>False</td><td>0.581797</td><td>0.018508</td><td>526</td><td>13.102683</td><td>2.769917e-05</td><td>7.576290e-01</td><td>20.293833</td><td>11.092514</td><td>15.909853</td><td>11.092514</td><td>107.0</td><td>2.669015</td><td>1.852658</td><td>0.305865</td><td>-20.908025</td><td>74.107175</td><td>0.008326996745655076,0.01561481607327388</td><td>0.008356600902037329,0.015952162322674438</td><td>0.00783631125160215,0.01565787666582994</td><td>0.007865915408059981,0.015995222915251902</td></tr>
<tr><td>532</td><td>1029.9788</td><td>1129.4990</td><td>359.99333457525603,0.017146788239863073</td><td>3.913970e-08</td><td>5.976516e-09</td><td>1.664960e-06</td><td>1.451954e-01</td><td>3.089179e-06</td><td>2.071294e-01</td><td>9.415952e-06</td><td>4.619581e-01</td><td>1.380105e-05</td><td>6.770962e-01</td><td>23.346490</td><td>12.351385</td><td>22.675392</td><td>12.066013</td><td>21.465339</td><td>11.726868</td><td>21.050220</td><td>11.726868</td><td>18.962510</td><td>12.351385</td><td>18.291412</td><td>12.066013</td><td>17.081360</td><td>11.726868</td><td>16.666240</td><td>11.726868</td><td>1.8554</td><td>3.0480</td><td>5.6554</td><td>False</td><td>0.532994</td><td>-0.955293</td><td>517</td><td>42.080789</td><td>1.712375e-05</td><td>6.535887e-01</td><td>20.816003</td><td>11.454293</td><td>16.432023</td><td>11.454293</td><td>83.0</td><td>3.121849</td><td>1.593708</td><td>0.489499</td><td>-47.106253</td><td>47.908947</td><td>359.99351711987725,0.016945375006633314</td><td>359.99354941532096,0.017313389085365283</td><td>359.9931184379333,0.016980361706632616</td><td>359.9931507333769,0.017348375784701726</td></tr>
<tr><td>533</td><td>118.9411</td><td>1127.4900</td><td>0.02126872921805628,0.014633312066820246</td><td>-1.118574e-08</td><td>2.091267e-09</td><td>3.368988e-06</td><td>1.645035e-01</td><td>5.452547e-06</td><td>2.280033e-01</td><td>8.516107e-06</td><td>4.722876e-01</td><td>1.248213e-05</td><td>6.922363e-01</td><td>22.581251</td><td>11.721711</td><td>22.058502</td><td>11.553380</td><td>21.574397</td><td>11.859933</td><td>21.159278</td><td>11.859933</td><td>18.197271</td><td>11.721711</td><td>17.674522</td><td>11.553380</td><td>17.190417</td><td>11.859933</td><td>16.775298</td><td>11.859933</td><td>1.6185</td><td>1.5619</td><td>2.5278</td><td>False</td><td>0.602370</td><td>0.053774</td><td>535</td><td>16.289166</td><td>7.865112e-06</td><td>3.927388e-01</td><td>21.660738</td><td>11.746019</td><td>17.276758</td><td>11.746019</td><td>26.0</td><td>1.207668</td><td>1.121406</td><td>0.071429</td><td>-89.866878</td><td>5.148322</td><td>0.02133554457814273,0.014535045666212661</td><td>0.021354383584449747,0.014749720546151358</td><td>0.021151537530259158,0.01455119339864678</td><td>0.021170376536625242,0.014765868278761423</td></tr>
<tr><td>534</td><td>956.0520</td><td>1127.9897</td><td>359.9955976876145,0.0169015431180713</td><td>-4.255541e-09</td><td>1.542186e-09</td><td>8.280832e-07</td><td>1.363415e-01</td><td>1.532876e-06</td><td>1.925270e-01</td><td>2.771168e-06</td><td>4.317036e-01</td><td>4.061726e-06</td><td>6.327519e-01</td><td>24.104815</td><td>13.041392</td><td>23.436233</td><td>12.747470</td><td>22.793343</td><td>12.981314</td><td>22.378224</td><td>12.981314</td><td>19.720835</td><td>13.041392</td><td>19.052253</td><td>12.747470</td><td>18.409363</td><td>12.981314</td><td>17.994244</td><td>12.981314</td><td>1.8511</td><td>1.8078</td><td>3.3465</td><td>False</td><td>0.549348</td><td>-0.098827</td><td>510</td><td>63.846605</td><td>1.788253e-06</td><td>2.138606e-01</td><td>23.268927</td><td>12.694263</td><td>18.884948</td><td>12.694263</td><td>9.0</td><td>0.784380</td><td>0.780438</td><td>0.005027</td><td>-66.846304</td><td>28.168896</td><td>359.9956412748451,0.01685167987319435</td><td>359.9956520399931,0.016974351233852762</td><td>359.9955186034758,0.016862445013223624</td><td>359.99552936862375,0.01698511637381536</td></tr>
<tr><td>535</td><td>135.0353</td><td>1130.0024</td><td>0.020781914851667194,0.014753675570665424</td><td>-8.627487e-09</td><td>2.961937e-09</td><td>1.826118e-06</td><td>1.484865e-01</td><td>3.264537e-06</td><td>2.138176e-01</td><td>5.260714e-06</td><td>4.575606e-01</td><td>7.710677e-06</td><td>6.706508e-01</td><td>23.246178</td><td>12.275409</td><td>22.615446</td><td>12.040571</td><td>22.097388</td><td>12.348522</td><td>21.682269</td><td>12.348522</td><td>18.862198</td><td>12.275409</td><td>18.231466</td><td>12.040571</td><td>17.713408</td><td>12.348522</td><td>17.298289</td><td>12.348522</td><td>1.7877</td><td>1.6115</td><td>2.8808</td><td>False</td><td>0.613488</td><td>0.112932</td><td>533</td><td>16.289166</td><td>4.658411e-06</td><td>3.397034e-01</td><td>22.229405</td><td>12.157170</td><td>17.845426</td><td>12.157170</td><td>21.0</td><td>1.109484</td><td>1.092150</td><td>0.015623</td><td>76.909230</td><td>171.924430</td><td>0.020852932976350335,0.014670109805986624</td><td>0.020869080696166123,0.014854116846175719</td><td>0.020668925927687338,0.014686257538164476</td><td>0.02068507364753345,0.0148702645784788</td></tr>
<tr><td>536</td><td>177.0265</td><td>1131.5377</td><td>0.019498266467649128,0.014913771519146132</td><td>5.576285e-09</td><td>3.350800e-09</td><td>1.794632e-06</td><td>1.479083e-01</td><td>3.039420e-06</td><td>2.093931e-01</td><td>5.198656e-06</td><td>4.592599e-01</td><td>7.619717e-06</td><td>6.731414e-01</td><td>23.265062</td><td>12.290056</td><td>22.693023</td><td>12.095445</td><td>22.110272</td><td>12.365431</td><td>21.695153</td><td>12.365431</td><td>18.881082</td><td>12.290056</td><td>18.309043</td><td>12.095445</td><td>17.726293</td><td>12.365431</td><td>17.311173</td><td>12.365431</td><td>1.6936</td><td>1.7104</td><td>2.8968</td><td>False</td><td>0.604867</td><td>-0.204642</td><td>529</td><td>18.694339</td><td>4.952313e-06</td><td>3.566795e-01</td><td>22.162980</td><td>12.143690</td><td>17.779000</td><td>12.143690</td><td>23.0</td><td>1.188099</td><td>1.134902</td><td>0.044775</td><td>-36.526813</td><td>58.488387</td><td>0.019567574916271927,0.014813811768727883</td><td>0.01958641392302075,0.015028486649884886</td><td>0.019383567865608044,0.014829959500013841</td><td>0.019402406872397096,0.0150446343813094</td></tr>
<tr><td>537</td><td>289.2897</td><td>1135.0691</td><td>0.016064902259566687,0.01532420523894071</td><td>1.904178e-08</td><td>2.316119e-09</td><td>8.678484e-07</td><td>1.677204e-01</td><td>1.847315e-06</td><td>nan</td><td>1.187067e-05</td><td>nan</td><td>1.739895e-05</td><td>nan</td><td>24.053890</td><td>13.215361</td><td>23.233648</td><td>nan</td><td>21.213812</td><td>nan</td><td>20.798693</td><td>nan</td><td>19.669911</td><td>13.215361</td><td>18.849668</td><td>nan</td><td>16.829832</td><td>nan</td><td>16.414713</td><td>nan</td><td>2.1286</td><td>6.4259</td><td>13.6783</td><td>True</td><td>0.318986</td><td>0.865758</td><td>521</td><td>46.717533</td><td>4.146719e-06</td><td>4.197192e-01</td><td>22.355738</td><td>12.513146</td><td>17.971759</td><td>12.513146</td><td>23.0</td><td>1.646048</td><td>0.973216</td><td>0.408756</td><td>1.054536</td><td>96.069736</td><td>0.016174209585740784,0.015235216137846898</td><td>0.016187666019650358,0.015388555340142796</td><td>0.015898199003109063,0.015259437731029718</td><td>0.015911655437044293,0.015412776933412576</td></tr>
</table></div></div></div>
</div>
</section>
<section id="display-image-and-overplot-detector-sources-from-ecsv-table">
<h3>Display image and overplot detector sources from ecsv table<a class="headerlink" href="#display-image-and-overplot-detector-sources-from-ecsv-table" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in i2d combined Image</span>
<span class="n">im_i2d</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">input_file</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># read in ecsv photom file</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">LogStretch</span><span class="p">,</span> <span class="n">PercentileInterval</span><span class="p">,</span> <span class="n">ManualInterval</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">table</span>

<span class="n">viz2</span> <span class="o">=</span> <span class="n">LogStretch</span><span class="p">()</span> <span class="o">+</span> <span class="n">ManualInterval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="c1">#plt.imshow(viz2(im_i2d.data), origin=&#39;lower&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im_i2d</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f3b7460dc60&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_32_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_32_1.png" />
</div>
</div>
</section>
<section id="in-the-image-above-check-that-the-stars-found-by-source-catalog-red-overlap-with-stars-in-the-image">
<h3>In the image above, check that the stars found by source catalog (red) overlap with stars in the image<a class="headerlink" href="#in-the-image-above-check-that-the-stars-found-by-source-catalog-red-overlap-with-stars-in-the-image" title="Permalink to this headline">#</a></h3>
</section>
<section id="look-at-the-fluxes-of-the-sources-found">
<h3>Look at the fluxes of the sources found<a class="headerlink" href="#look-at-the-fluxes-of-the-sources-found" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#create_scatterplot(catalog[&#39;label&#39;], catalog[&#39;aper_total_flux&#39;],title=&#39;Total Flux in &#39;+str(catalog[&#39;aper_total_flux&#39;].unit))</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;aper_total_flux&#39;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Total Flux in &#39;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;aper_total_flux&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unit</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;aper_total_flux&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;aper_total_flux&#39;)
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_35_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_35_1.png" />
</div>
</div>
</section>
<section id="look-at-ab-mag-of-sources-found">
<h3>Look at AB mag of sources found<a class="headerlink" href="#look-at-ab-mag-of-sources-found" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">create_scatterplot</span><span class="p">(</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">],</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Total AB mag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_37_0.png" src="../../../_images/exec_jwst_source_catalog_miri_test_37_0.png" />
</div>
</div>
</section>
<section id="look-at-the-errors-on-the-ab-magnitudes">
<h3>Look at the errors on the AB magnitudes<a class="headerlink" href="#look-at-the-errors-on-the-ab-magnitudes" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">create_scatterplot</span><span class="p">(</span><span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">],</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag_err&#39;</span><span class="p">],</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Total AB mag vs error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_39_0.png" src="../../../_images/exec_jwst_source_catalog_miri_test_39_0.png" />
</div>
</div>
</section>
<section id="manually-find-matches">
<h3>Manually find matches<a class="headerlink" href="#manually-find-matches" title="Permalink to this headline">#</a></h3>
<p>Since this is a simulated data set, we can compare the output catalog information from the pipeline with the input catalog information used to create the simulation. Grab the input catalog x,y values and the output catalog x and y values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in catalogs used for simulated data</span>
<span class="n">sim_star_cat</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;input_sim_stars.cat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
<span class="n">sim_gal_cat</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;input_sim_galaxies.cat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_star_cat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=4826</i>
<table id="table139893320157360" class="table-striped table-bordered table-condensed">
<thead><tr><th>x</th><th>y</th><th>Teff</th><th>Ks</th><th>J</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>80.2510308154624</td><td>23.997467884837725</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>-47.261524228197935</td><td>10.919745186379808</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>0.30699104430734203</td><td>-58.51295402429979</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>93.61585359712294</td><td>10.466443553979882</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>70.96910779066107</td><td>63.07387861912006</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>92.9069476014962</td><td>64.30856174275276</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>-15.68679078862531</td><td>31.013432097907607</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>46.755851500202645</td><td>-48.43985094005038</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>89.7351811921786</td><td>53.11182881807044</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>36.8486881036986</td><td>55.211246043351814</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>-53.75703837846754</td><td>-15.056996445192539</td><td>5129.638599639223</td><td>13.89851702505835</td><td>14.41384375773162</td></tr>
<tr><td>-0.03077487414979152</td><td>36.278182742815886</td><td>5115.269231711902</td><td>13.881869560311879</td><td>14.401307904146263</td></tr>
<tr><td>95.63356755906099</td><td>44.16471129241473</td><td>5075.067865858648</td><td>13.826451018457695</td><td>14.3573115045063</td></tr>
<tr><td>90.27300634079342</td><td>14.709913368541772</td><td>5039.59863458312</td><td>13.777190092365087</td><td>14.318203593715223</td></tr>
<tr><td>66.73346488575024</td><td>53.530350294809374</td><td>4892.405122741114</td><td>13.126635236879519</td><td>13.714329206276458</td></tr>
<tr><td>64.8587912432001</td><td>35.35455796920176</td><td>4855.908749660536</td><td>12.776853158671695</td><td>13.375350808436671</td></tr>
<tr><td>-53.64831916556537</td><td>-32.595812402656435</td><td>4854.752641485985</td><td>12.76623009636547</td><td>13.365197793135147</td></tr>
<tr><td>-46.87584310414583</td><td>-39.38515541475271</td><td>4789.363060890498</td><td>12.23192086544233</td><td>12.851491317487538</td></tr>
<tr><td>80.81191419293565</td><td>31.516610885465813</td><td>4747.458346750021</td><td>11.94688436179194</td><td>12.581530000493744</td></tr>
<tr><td>96.33858842136043</td><td>46.06905445046372</td><td>4618.2593456723625</td><td>11.191917165072244</td><td>11.872435221133179</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># join the star and galaxy catalogs used to make the simulations</span>
<span class="n">combined</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">sim_star_cat</span><span class="p">,</span> <span class="n">sim_gal_cat</span><span class="p">])</span>
<span class="n">combined</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><i>Table length=5039</i>
<table id="table139893333212656" class="table-striped table-bordered table-condensed">
<thead><tr><th>x</th><th>y</th><th>Teff</th><th>Ks</th><th>J</th><th>si</th><th>ell</th><th>posang</th><th>reff</th><th>flux</th></tr></thead>
<thead><tr><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th><th>float64</th></tr></thead>
<tr><td>80.2510308154624</td><td>23.997467884837725</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>-47.261524228197935</td><td>10.919745186379808</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>0.30699104430734203</td><td>-58.51295402429979</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>93.61585359712294</td><td>10.466443553979882</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>70.96910779066107</td><td>63.07387861912006</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>92.9069476014962</td><td>64.30856174275276</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>-15.68679078862531</td><td>31.013432097907607</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>46.755851500202645</td><td>-48.43985094005038</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>89.7351811921786</td><td>53.11182881807044</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>36.8486881036986</td><td>55.211246043351814</td><td>2304.0929760558447</td><td>22.320700043360187</td><td>23.18070004336019</td><td>--</td><td>--</td><td>--</td><td>--</td><td>--</td></tr>
<tr><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td></tr>
<tr><td>67.9805698605627</td><td>28.494828715119297</td><td>--</td><td>--</td><td>--</td><td>2.1096031965990987</td><td>0.20429700021417183</td><td>163.06816649011344</td><td>1.2715822225420945</td><td>13.752965618162937</td></tr>
<tr><td>-4.446155064406765</td><td>12.985674228459532</td><td>--</td><td>--</td><td>--</td><td>7.321844705461592</td><td>0.4501652135521971</td><td>105.14019169110954</td><td>1.8511745519437588</td><td>20.07141274178467</td></tr>
<tr><td>64.7244492666461</td><td>10.113732329735475</td><td>--</td><td>--</td><td>--</td><td>8.656346507536115</td><td>0.14694556628740923</td><td>162.43083457274233</td><td>1.610374819963926</td><td>66.30990252944302</td></tr>
<tr><td>-26.44617200253474</td><td>-63.88803361596829</td><td>--</td><td>--</td><td>--</td><td>9.257830349772924</td><td>0.552517577845459</td><td>141.17379575911065</td><td>1.7555307879881636</td><td>85.42806519275359</td></tr>
<tr><td>12.353908822597736</td><td>10.271889771234832</td><td>--</td><td>--</td><td>--</td><td>1.0276353349444474</td><td>0.18091589308864187</td><td>107.22059356945567</td><td>0.4673720066992323</td><td>39.37631906390017</td></tr>
<tr><td>-42.21461912208557</td><td>62.45020775429763</td><td>--</td><td>--</td><td>--</td><td>5.92465228732547</td><td>0.16970442816082973</td><td>202.415935614884</td><td>1.7791109904857216</td><td>131.3721604911842</td></tr>
<tr><td>-48.68869520916011</td><td>-16.576483230280186</td><td>--</td><td>--</td><td>--</td><td>8.178707887219758</td><td>0.5984672675322196</td><td>140.78836334886316</td><td>0.898280342552625</td><td>59.0685397583837</td></tr>
<tr><td>86.72084849551925</td><td>-30.653820797204745</td><td>--</td><td>--</td><td>--</td><td>4.08216110337432</td><td>0.11388325542173025</td><td>167.92605707130545</td><td>1.0411257693724623</td><td>32.74018847376189</td></tr>
<tr><td>90.56731424478109</td><td>-11.922514577935111</td><td>--</td><td>--</td><td>--</td><td>7.5528059599878805</td><td>0.396357895737423</td><td>185.127012207533</td><td>0.25769212999045565</td><td>168.84275608114189</td></tr>
<tr><td>65.4485869690741</td><td>60.09508331438365</td><td>--</td><td>--</td><td>--</td><td>2.379528991927928</td><td>0.3037143249770903</td><td>104.28886580660799</td><td>1.8117913320142096</td><td>144.44919876820663</td></tr>
</table></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim_ra</span> <span class="o">=</span> <span class="n">combined</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">3600.</span>
<span class="n">sim_dec</span> <span class="o">=</span> <span class="n">combined</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">/</span><span class="mf">3600.</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="use-miri-software-to-put-x-y-coordinates-from-input-catalog-into-ra-dec-coordinates">
<h3>Use MIRI software to put x, y coordinates from input catalog into RA, Dec coordinates<a class="headerlink" href="#use-miri-software-to-put-x-y-coordinates-from-input-catalog-into-ra-dec-coordinates" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Put star positions into RA and Dec</span>

<span class="c1"># import coordinate conversion tools</span>
<span class="c1">#import miricoord.tel.tel_tools as teltools</span>
<span class="c1">#import miricoord.imager.mirim_pipetools as mpt</span>
<span class="c1">#import miricoord.imager.mirim_tools as mt</span>
<span class="c1">#import pysiaf</span>

<span class="c1">#filt = &#39;F560W&#39;</span>
<span class="c1"># use pipeline to get v2ref and v3ref coordinates</span>
<span class="c1">#siaf = pysiaf.Siaf(&#39;MIRI&#39;)</span>
<span class="c1">#xref,yref=siaf[&#39;MIRIM_FULL&#39;].XDetRef,siaf[&#39;MIRIM_FULL&#39;].YDetRef</span>
<span class="c1">#xref,yref=xref-1,yref-1</span>
<span class="c1">#v2ref,v3ref=mt.xytov2v3(xref,yref,filt)</span>

<span class="c1"># set reference for RA and Dec</span>
<span class="c1">#raref = 0.0</span>
<span class="c1">#decref = 0.0</span>
<span class="c1">#rollref = 0.0</span>

<span class="c1">#sim_ra = np.zeros(len(combined))</span>
<span class="c1">#sim_dec = np.zeros(len(combined))</span>

<span class="c1"># cycle through list of coordinates input into scene and get RA/Dec values out, printing to file</span>
<span class="c1">#for i in range(len(combined)):</span>
    <span class="c1">#print(combined[&#39;x&#39;][i])</span>
<span class="c1">#    v2 = v2ref + combined[&#39;x&#39;][i]</span>
<span class="c1">#    v3 = v3ref + combined[&#39;y&#39;][i]</span>
<span class="c1">#    ra,dec,newroll=teltools.jwst_v2v3toradec(v2,v3,v2ref=v2ref,v3ref=v3ref,raref=raref,decref=decref,rollref=rollref)</span>
    
<span class="c1">#    sim_ra[i] = ra</span>
<span class="c1">#    sim_dec[i] = dec</span>
    
<span class="c1">#print(np.shape(sim_ra))</span>
<span class="c1">#print(sim_ra, sim_dec)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="compare-ra-dec-coordinates-between-simulator-catalog-and-output-catalog-to-find-matches">
<h3>Compare RA, Dec coordinates between simulator catalog and output catalog to find matches<a class="headerlink" href="#compare-ra-dec-coordinates-between-simulator-catalog-and-output-catalog-to-find-matches" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cat_ra</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;sky_centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cat_ra</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">cat_ra</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">180.</span><span class="p">):</span>
        <span class="n">cat_ra</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">360.</span>
<span class="n">cat_dec</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="s1">&#39;sky_centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set the tolerance for differences and initialize counters</span>

<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.e-5</span>    <span class="c1"># Set tolerance around 30 mas (units here are in degrees; 36 mas ~ 1e-5 deg)</span>
<span class="n">found_count</span><span class="o">=</span><span class="mi">0</span>
<span class="n">multiples_count</span><span class="o">=</span><span class="mi">0</span>
<span class="n">missed_count</span><span class="o">=</span><span class="mi">0</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set up array for matches</span>
<span class="n">detected</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">chararray</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sim_ra</span><span class="p">))</span>
<span class="c1">#print(np.shape(detected))</span>

<span class="k">for</span> <span class="n">ra</span><span class="p">,</span><span class="n">dec</span><span class="p">,</span><span class="n">idx</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sim_ra</span><span class="p">,</span> <span class="n">sim_dec</span><span class="p">,</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">sim_ra</span><span class="p">))):</span>

    <span class="n">match</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">ra</span><span class="o">-</span><span class="n">cat_ra</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">dec</span><span class="o">-</span><span class="n">cat_dec</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tol</span><span class="p">))</span>
    <span class="c1">#print(&#39;match&#39;, match)</span>
    
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
        <span class="n">found_count</span> <span class="o">+=</span><span class="mi">1</span> 
        <span class="n">detected</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Y&#39;</span>

    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>  
        <span class="n">multiples_count</span> <span class="o">+=</span><span class="mi">1</span>       
        
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">match</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">missed_count</span> <span class="o">+=</span><span class="mi">1</span>

<span class="c1">#print(np.shape(detected))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_percent_found</span> <span class="o">=</span> <span class="p">(</span><span class="n">found_count</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">sim_ra</span><span class="p">))</span><span class="o">*</span><span class="mi">100</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;SNR threshold used for pipeline: &#39;</span><span class="p">,</span><span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">snr_threshold</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total matches found:&#39;</span><span class="p">,</span><span class="n">found_count</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total missed:&#39;</span><span class="p">,</span><span class="n">missed_count</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of multiples: &#39;</span><span class="p">,</span><span class="n">multiples_count</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number of input (simulated) sources:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">combined</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total number in output catalog:&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">catalog</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total percent found:&#39;</span><span class="p">,</span><span class="n">total_percent_found</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>SNR threshold used for pipeline:  8
Total matches found: 418
Total missed: 4621
Number of multiples:  0
Total number of input (simulated) sources: 5039
Total number in output catalog: 537
Total percent found: 8.295296685850367
</pre></div>
</div>
</div>
</div>
</section>
<section id="use-photutils-to-find-catalog-matches-and-compare-which-sources-were-found-and-matched">
<h3>Use photutils to find catalog matches and compare which sources were found and matched.<a class="headerlink" href="#use-photutils-to-find-catalog-matches-and-compare-which-sources-were-found-and-matched" title="Permalink to this headline">#</a></h3>
<p>Photutils includes a package to match sources between catalogs by providing a max separation value. Set that value and compare the two catalogs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">catalog_in</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">sim_ra</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">sim_dec</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span> <span class="c1"># full simulated catalog, stars+galaxies</span>
<span class="n">catalog_out</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat_ra</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat_dec</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">max_sep</span> <span class="o">=</span> <span class="mf">0.04</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">arcsec</span> <span class="c1"># Set match at around 30 mas</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># match full tables</span>
<span class="n">idx</span><span class="p">,</span> <span class="n">d2d</span><span class="p">,</span> <span class="n">d3d</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">catalog_in</span><span class="p">,</span> <span class="n">catalog_out</span><span class="p">)</span>
<span class="n">sep_constraint</span> <span class="o">=</span> <span class="n">d2d</span> <span class="o">&lt;</span> <span class="n">max_sep</span>
<span class="n">combined_matched</span> <span class="o">=</span> <span class="n">combined</span><span class="p">[</span><span class="n">sep_constraint</span><span class="p">]</span> <span class="c1"># simulated sources matched</span>
<span class="n">catalog_matched</span> <span class="o">=</span> <span class="n">catalog</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">sep_constraint</span><span class="p">]]</span> <span class="c1"># sources found matched</span>

<span class="nb">print</span><span class="p">(</span><span class="n">catalog_matched</span><span class="o">.</span><span class="n">colnames</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;label&#39;, &#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;sky_centroid&#39;, &#39;aper_bkg_flux&#39;, &#39;aper_bkg_flux_err&#39;, &#39;aper30_flux&#39;, &#39;aper30_flux_err&#39;, &#39;aper50_flux&#39;, &#39;aper50_flux_err&#39;, &#39;aper70_flux&#39;, &#39;aper70_flux_err&#39;, &#39;aper_total_flux&#39;, &#39;aper_total_flux_err&#39;, &#39;aper30_abmag&#39;, &#39;aper30_abmag_err&#39;, &#39;aper50_abmag&#39;, &#39;aper50_abmag_err&#39;, &#39;aper70_abmag&#39;, &#39;aper70_abmag_err&#39;, &#39;aper_total_abmag&#39;, &#39;aper_total_abmag_err&#39;, &#39;aper30_vegamag&#39;, &#39;aper30_vegamag_err&#39;, &#39;aper50_vegamag&#39;, &#39;aper50_vegamag_err&#39;, &#39;aper70_vegamag&#39;, &#39;aper70_vegamag_err&#39;, &#39;aper_total_vegamag&#39;, &#39;aper_total_vegamag_err&#39;, &#39;CI_50_30&#39;, &#39;CI_70_50&#39;, &#39;CI_70_30&#39;, &#39;is_extended&#39;, &#39;sharpness&#39;, &#39;roundness&#39;, &#39;nn_label&#39;, &#39;nn_dist&#39;, &#39;isophotal_flux&#39;, &#39;isophotal_flux_err&#39;, &#39;isophotal_abmag&#39;, &#39;isophotal_abmag_err&#39;, &#39;isophotal_vegamag&#39;, &#39;isophotal_vegamag_err&#39;, &#39;isophotal_area&#39;, &#39;semimajor_sigma&#39;, &#39;semiminor_sigma&#39;, &#39;ellipticity&#39;, &#39;orientation&#39;, &#39;sky_orientation&#39;, &#39;sky_bbox_ll&#39;, &#39;sky_bbox_ul&#39;, &#39;sky_bbox_lr&#39;, &#39;sky_bbox_ur&#39;]

label xcentroid ...                 sky_bbox_ur                 
                ...                   deg,deg                   
----- --------- ... --------------------------------------------
   53  700.9981 ...    0.00072028115522625,-0.013663643833159062
   50  562.9848 ...   0.004933604564422034,-0.014249716371583877
  180  540.1789 ...   0.006551311261702788,-0.003915217224953348
  394  712.3905 ...    0.0023583395513293256,0.00887615713434961
  277  781.8568 ...      359.99968948084245,0.003114985661977709
  249  774.7901 ...       359.9997103830791,0.000888061936113821
  429  773.6755 ...   0.0005565108883456984,0.010177727065777551
  306  805.1856 ...      359.99913214123706,0.004863616628974098
  211  736.1684 ... 0.0006830521428696413,-0.0017623292595226982
  446  162.8437 ...     0.01938337546939097,0.009545389373135508
  ...       ... ...                                          ...
   74  809.1211 ...     359.99735495640607,-0.011514075225784659
  450  743.1003 ...   0.0013404825201330246,0.011715937844013891
  419  794.5809 ...       359.9995912876307,0.010447855280056994
  522  207.9637 ...     0.01800245128918061,0.015291105012232502
  436  210.5388 ...     0.017099998941528558,0.01064198595301808
  406   63.8713 ...     0.02151078559473692,0.010193104786233339
  212  716.4900 ...    0.00096500922171332,-0.001014472182657635
    2  800.8166 ...       359.997219699847,-0.017281257033337896
  143  726.7474 ...  0.0002793590890738714,-0.006362505757850938
  423 1057.6032 ...      359.99160419218157,0.010994250369012575
Length = 419 rows
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#match RA and Dec</span>
<span class="n">idx</span><span class="p">,</span> <span class="n">d2d</span><span class="p">,</span> <span class="n">d3d</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">catalog_in</span><span class="p">,</span> <span class="n">catalog_out</span><span class="p">)</span>
<span class="n">sep_constraint</span> <span class="o">=</span> <span class="n">d2d</span> <span class="o">&lt;</span> <span class="n">max_sep</span>
<span class="n">catalog_in_matches</span> <span class="o">=</span> <span class="n">catalog_in</span><span class="p">[</span><span class="n">sep_constraint</span><span class="p">]</span>
<span class="n">catalog_out_matches</span> <span class="o">=</span> <span class="n">catalog_out</span><span class="p">[</span><span class="n">idx</span><span class="p">[</span><span class="n">sep_constraint</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">catalog_out_matches</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(7.90295027e-04, -1.37468746e-02), (5.00534374e-03, -1.43179638e-02),
     (6.61529834e-03, -4.00344802e-03), (2.41689650e-03,  8.80055455e-03),
     (3.59999764e+02,  3.02787919e-03), (3.59999788e+02,  8.22365332e-04),
     (6.35936258e-04,  1.00881390e-02), (3.59999196e+02,  4.77525717e-03),
     (7.47367578e-04, -1.85052750e-03), (1.94585536e-02,  9.46661052e-03),
     (2.88099926e-03, -1.13959237e-02), (5.58510932e-03, -4.45061598e-03),
     (3.59994265e+02, -6.89387191e-03), (8.85340147e-04, -2.62921378e-03),
     (3.59998010e+02, -8.09487473e-03), (2.27009779e-03, -1.20221007e-02),
     (4.02370459e-04, -3.38198948e-03), (4.76167455e-03,  5.58473896e-03),
     (3.59992427e+02, -5.80736714e-03), (6.46534268e-04, -1.30302918e-03),
     (3.59999694e+02,  1.37579491e-03), (1.22921057e-02,  5.38805910e-03),
     (2.00207560e-02,  7.90461343e-03), (1.08817436e-02, -2.85137800e-03),
     (2.26807919e-02,  5.44509051e-03), (1.33968684e-03,  9.34633005e-03),
     (1.39740703e-03,  1.08901698e-02), (1.90168106e-02,  1.45984595e-02),
     (3.27614191e-03,  1.97486749e-03), (7.98684004e-03,  6.65209429e-03),
     (1.02902691e-02, -6.90146120e-03), (3.59999125e+02,  3.62802822e-03),
     (3.59996033e+02,  1.72458796e-03), (3.59996118e+02,  7.05988362e-03),
     (3.59998791e+02,  1.21355351e-02), (1.01291804e-02, -9.28265984e-03),
     (2.67620880e-04,  4.07079984e-03), (3.59991043e+02,  1.16454634e-02),
     (3.59996229e+02, -1.27299710e-02), (1.28594026e-03, -1.74447224e-03),
     (5.34580569e-03, -4.84049206e-03), (1.44324722e-02,  8.24911193e-03),
     (3.59997456e+02, -2.88586031e-03), (1.01873017e-02,  1.08679485e-02),
     (3.59997516e+02, -6.31788376e-03), (1.67812456e-02,  7.19296216e-03),
     (3.59996372e+02, -7.99988893e-03), (3.05640555e-03, -3.76426979e-03),
     (6.83755632e-03, -1.58072558e-03), (8.31317931e-03, -1.14025563e-02),
     (2.10431924e-02,  8.19415001e-03), (3.59998927e+02,  1.26180432e-02),
     (7.34833811e-04,  1.24233821e-03), (3.59998365e+02, -1.27610868e-02),
     (6.06184613e-03, -1.07025612e-02), (3.59994261e+02, -9.37483694e-03),
     (1.39099072e-02,  7.85231832e-03), (3.59999121e+02,  4.32243459e-03),
     (5.06918639e-03,  5.51536785e-04), (1.42380949e-02,  1.49265356e-02),
     (3.59993040e+02,  4.11394464e-03), (6.29496891e-03,  9.44276255e-03),
     (3.23841548e-03,  1.58552483e-02), (3.59993012e+02, -1.06792486e-02),
     (3.59996509e+02,  1.51600871e-02), (7.16451334e-03,  1.53921607e-02),
     (3.59992443e+02,  1.04765196e-02), (6.90274551e-03, -1.80544005e-02),
     (1.99728229e-03,  4.47184508e-03), (6.93632314e-03, -1.10360658e-02),
     (1.45897584e-02,  9.54182178e-03), (2.20376572e-02,  5.86217611e-03),
     (1.11962820e-02, -2.56702173e-03), (2.08372559e-02,  1.04443671e-02),
     (3.59995569e+02, -4.50791957e-03), (1.01481510e-02,  1.21345148e-02),
     (3.59994079e+02,  1.01340706e-02), (5.97497088e-03,  3.78481951e-03),
     (3.59995873e+02,  9.92788650e-03), (3.59995684e+02, -3.26307709e-03),
     (3.59995084e+02, -2.70754782e-03), (6.74660477e-04,  1.46667825e-03),
     (3.59992202e+02, -5.91146677e-03), (2.07815879e-02,  1.27993503e-02),
     (8.47912703e-03, -3.96314456e-04), (1.05359769e-02, -9.28419177e-03),
     (3.59992982e+02,  1.59001288e-02), (6.25362417e-03,  5.67107506e-04),
     (3.59998598e+02, -1.09044141e-02), (8.72348404e-05, -3.08403343e-03),
     (1.48439392e-03,  7.36069305e-03), (9.36338542e-04, -3.63819472e-03),
     (2.58823713e-03,  6.56828370e-03), (1.40469550e-02,  5.20364485e-03),
     (3.59997149e+02,  9.02730753e-04), (3.59993470e+02, -3.02505157e-03),
     (2.35691993e-04,  1.46828071e-03), (3.30040224e-03, -1.12170044e-02),
     (6.81602358e-03, -1.79003972e-03), (1.70902073e-03,  6.41530467e-03),
     (3.59998502e+02, -1.75846539e-02), (7.92916761e-03,  1.36818825e-02),
     (3.59999553e+02, -2.52263720e-03), (3.59999052e+02, -1.31464847e-02),
     (8.37546818e-03, -1.68175236e-02), (3.59993233e+02,  1.34318745e-02),
     (1.52647628e-02,  1.38108375e-02), (3.05692932e-03, -1.28681600e-02),
     (3.59993900e+02, -8.44266160e-03), (9.67398786e-03,  8.59163557e-03),
     (1.90455445e-02,  8.86389395e-03), (3.59997828e+02,  1.56525811e-02),
     (3.59993137e+02, -1.09138767e-02), (2.33229793e-03,  5.86572057e-03),
     (3.59994939e+02,  1.28326202e-02), (1.78953624e-02,  1.07138102e-02),
     (1.66468616e-02,  4.89845951e-03), (4.87717913e-03, -1.08959520e-02),
     (4.79306381e-03, -9.21655891e-04), (4.30547819e-03, -2.64147270e-03),
     (5.24721163e-03, -1.85361417e-03), (3.59994463e+02,  2.25027704e-03),
     (3.60708300e-03, -3.01659262e-03), (1.07014769e-02,  9.39740771e-03),
     (1.32807949e-02,  1.10123960e-02), (3.59997981e+02, -9.91640721e-03),
     (1.01025367e-03,  2.89133969e-03), (9.65503052e-03, -1.69823490e-02),
     (3.59991838e+02,  1.35486038e-02), (1.83989840e-02,  8.35121091e-03),
     (3.18281513e-03, -8.14660672e-03), (3.59996673e+02, -1.73256926e-02),
     (7.39249926e-03, -1.08378606e-02), (8.74787474e-04, -1.69085973e-02),
     (2.62849828e-03,  1.21795452e-02), (1.52560499e-03, -1.39364357e-02),
     (1.07151528e-02,  6.90720023e-03), (3.59993494e+02,  9.56946365e-03),
     (8.46164532e-03,  9.93979585e-03), (3.59991365e+02,  7.68769477e-03),
     (3.59989655e+02, -5.37613434e-04), (3.59989751e+02, -8.04197057e-04),
     (3.59992114e+02, -6.21263013e-03), (3.59993109e+02,  4.94678358e-03),
     (8.66887348e-03, -4.22798289e-03), (3.59993112e+02,  4.76434079e-03),
     (1.59924115e-03,  1.37771718e-02), (3.59995426e+02,  8.88769783e-03),
     (2.05809116e-02,  5.55109948e-03), (2.37334604e-04,  1.21824173e-02),
     (9.07707499e-03, -4.65147160e-03), (3.59994922e+02,  6.23356625e-04),
     (3.59994133e+02, -1.08488862e-02), (7.32444584e-04,  1.19445224e-02),
     (3.59994653e+02, -8.74861450e-03), (1.27754308e-03, -1.49010887e-02),
     (3.59989233e+02, -7.37609205e-03), (3.59998766e+02,  7.32396234e-03),
     (3.59999123e+02,  1.50343705e-02), (1.68938942e-03,  1.48156299e-02),
     (1.03060481e-02,  7.78694193e-03), (6.29556653e-03, -7.96258387e-03),
     (3.59991658e+02, -2.51302287e-03), (3.59995598e+02,  1.69015431e-02),
     (3.59989173e+02, -4.85246625e-03), (1.78832526e-02,  1.26884768e-02),
     (1.90549963e-02,  3.64153664e-03), (5.98793143e-03,  1.02675339e-02),
     (1.15019683e-02, -3.48340901e-03), (1.22727283e-03, -1.43981989e-02),
     (3.59990286e+02,  4.40423135e-03), (1.63182292e-02,  7.71338722e-03),
     (4.29551769e-03,  8.71027450e-03), (2.34377220e-02,  6.91701183e-03),
     (3.59996062e+02, -9.01367483e-03), (3.59995614e+02, -6.30628569e-03),
     (3.59999050e+02, -3.16078971e-03), (3.40096466e-03, -1.01863775e-02),
     (7.23168643e-04,  1.28951994e-02), (1.16430220e-03, -1.83048927e-02),
     (3.59992443e+02, -8.78130387e-04), (3.48434104e-03, -1.42178195e-02),
     (2.32588277e-03, -8.30355704e-03), (3.59993589e+02,  6.21418513e-03),
     (3.59994591e+02, -1.13030238e-02), (3.59994842e+02,  5.41416048e-03),
     (1.89915860e-02,  4.45077538e-03), (3.59998446e+02, -8.62811528e-03),
     (1.16440422e-02,  8.34775528e-03), (7.91665483e-03, -3.04433794e-04),
     (3.59993583e+02, -1.54152811e-02), (3.59998916e+02,  4.26691623e-03),
     (1.29017813e-03,  1.35849564e-02), (3.59992889e+02, -7.08281157e-03),
     (1.58845657e-02,  1.05478702e-02), (2.07572763e-02,  9.94746245e-03),
     (9.91928402e-03, -1.76699635e-02), (3.59997077e+02,  1.22112875e-02),
     (3.59991496e+02, -7.16572753e-03), (8.71148524e-03, -3.89454870e-03),
     (7.54407302e-03, -6.26796076e-03), (3.59993820e+02, -9.31465355e-03),
     (4.16813012e-04, -1.70219711e-02), (6.48865387e-03, -1.37064098e-02),
     (5.18402695e-03,  8.26312041e-03), (6.84363302e-03, -1.62757937e-02),
     (3.59991974e+02,  1.33903223e-02), (9.76426689e-03,  1.33252438e-02),
     (1.05742614e-02, -2.04789654e-03), (3.59993020e+02, -6.87875838e-04),
     (3.59994020e+02,  4.10087344e-04), (7.34055619e-03,  2.19652514e-03),
     (3.59998368e+02,  1.03385778e-02), (3.59995660e+02, -1.69123185e-02),
     (3.59997106e+02, -1.67906613e-03), (5.26026596e-03,  1.29798111e-02),
     (1.80884544e-03, -4.54596581e-03), (8.38684682e-03,  7.14449524e-03),
     (3.59997326e+02,  9.25154710e-03), (1.74364842e-02,  7.46874288e-03),
     (2.79652447e-03, -9.57958334e-03), (9.32527460e-03,  8.14315608e-03),
     (3.59998934e+02, -1.46431664e-02), (3.59994652e+02,  1.96798231e-03),
     (7.49334837e-03, -1.24958830e-02), (9.31812278e-03,  5.67033040e-03),
     (6.64572318e-03,  1.35403214e-02), (4.61465037e-03, -1.72932081e-02),
     (3.59992438e+02,  6.85375532e-03), (1.86361854e-02,  1.29333765e-02),
     (2.32166644e-02,  6.00613872e-03), (1.23733845e-02, -9.85730534e-04),
     (3.59991957e+02,  1.39363750e-02), (3.59992912e+02, -7.38437719e-03),
     (6.83910298e-03,  8.04412646e-03), (1.01705529e-02,  1.41359743e-02),
     (4.64701428e-03,  4.80126814e-03), (3.59994850e+02, -5.19644984e-03),
     (3.62306889e-03, -4.89038900e-04), (3.01461943e-03,  2.32579471e-03),
     (3.59997416e+02, -1.03362916e-02), (6.66774407e-03, -2.80717018e-03),
     (9.55913868e-03, -1.64364436e-04), (3.59997196e+02,  1.29398986e-02),
     (3.26104225e-03,  3.91734254e-03), (2.12851884e-02,  8.31229694e-03),
     (3.59998463e+02,  4.61591696e-03), (5.69238026e-05,  3.38289550e-03),
     (2.09696788e-03,  5.63025551e-03), (5.47608317e-03, -1.47536082e-02),
     (5.60735950e-03,  1.07722334e-02), (6.31581279e-03, -4.26522736e-03),
     (3.59990384e+02, -3.59294556e-03), (2.86161046e-03, -1.18585975e-02),
     (1.12969312e-03,  9.27008473e-03), (7.98595054e-03, -1.56565319e-02),
     (1.25084501e-02,  3.49409698e-03), (3.47280013e-03, -3.38960984e-03),
     (7.14902093e-03, -6.73604743e-05), (3.59994349e+02, -6.22824799e-04),
     (4.42661855e-03, -1.51927765e-02), (3.59996879e+02,  1.47603755e-02),
     (3.59995371e+02, -1.78117381e-03), (3.59992024e+02,  8.54769870e-03),
     (1.01556547e-02, -3.10954977e-03), (1.86124016e-02,  1.08990221e-02),
     (3.59995952e+02,  2.00908400e-04), (1.58962059e-02,  1.16262264e-02),
     (4.29373917e-03,  1.35013155e-02), (3.59997791e+02, -1.21711481e-02),
     (3.59994792e+02, -1.23208416e-02), (8.56475413e-03,  5.17654474e-03),
     (7.23664897e-03, -6.15963010e-03), (3.75462207e-03,  1.28768401e-02),
     (1.07139447e-02,  1.16988509e-02), (8.92644716e-03,  5.26564690e-03),
     (4.80405154e-03, -1.76905929e-02), (3.59994991e+02, -1.11799068e-02),
     (1.77888425e-02,  7.14377290e-03), (1.43917360e-03, -2.05070364e-03),
     (3.59994608e+02,  1.39359928e-02), (1.94982665e-02,  1.49137715e-02),
     (2.07819149e-02,  1.47536756e-02), (3.59992809e+02,  7.70644928e-03),
     (8.04107012e-03,  4.92639348e-03), (3.59996383e+02,  1.32022338e-02),
     (3.59998803e+02,  8.96770444e-03), (3.59992249e+02,  1.54438796e-02),
     (2.62952395e-03, -1.13517155e-02), (3.59997943e+02, -6.15176253e-03),
     (7.20590173e-03, -1.26459850e-02), (3.59997753e+02,  4.76474787e-03),
     (3.59999651e+02,  1.52814154e-02), (3.59994001e+02, -6.99215734e-03),
     (3.59993814e+02, -1.30266418e-02), (4.57044901e-03,  1.20105708e-02),
     (1.78228237e-02,  8.13537559e-03), (4.99549827e-03, -2.99114888e-03),
     (3.59997738e+02,  5.83726951e-03), (3.59994801e+02, -1.65770015e-02),
     (3.59991446e+02, -8.06568694e-03), (3.87091742e-03,  9.50162288e-03),
     (6.40305330e-03,  5.04505422e-03), (1.05895460e-02,  5.32580190e-03),
     (3.59999830e+02,  2.05993716e-03), (1.74156984e-02,  7.81641990e-03),
     (3.59993925e+02,  1.17471527e-02), (3.59991417e+02,  9.47887849e-03),
     (3.59991493e+02, -5.30111158e-04), (2.94478596e-03, -8.48258554e-03),
     (4.27061307e-03,  6.40524321e-03), (3.59990738e+02, -1.67673468e-03),
     (2.88850558e-03, -1.52440539e-02), (1.32306890e-02,  8.91958252e-03),
     (7.42003941e-03, -4.07146834e-03), (3.59994115e+02, -8.75920975e-03),
     (4.48883314e-03,  5.94239986e-03), (3.59996182e+02, -1.41946942e-02),
     (3.98661487e-03, -6.35215214e-03), (3.59994772e+02,  1.35627863e-02),
     (3.59996547e+02,  9.88191372e-03), (4.14598853e-03, -1.61446683e-03),
     (1.65417771e-02,  1.09641672e-02), (1.01783073e-02, -8.69832580e-03),
     (2.12687292e-02,  1.46333121e-02), (3.59991333e+02, -1.21776097e-02),
     (1.08026361e-02, -1.80106335e-02), (3.59999256e+02,  1.29571257e-02),
     (3.59993370e+02, -1.43543765e-02), (3.59993738e+02, -5.26178657e-04),
     (8.43040506e-03, -1.18542738e-02), (2.87696306e-03,  1.60662739e-02),
     (6.02915761e-04, -1.79535572e-02), (5.92315461e-03,  8.40822718e-03),
     (3.59991066e+02,  8.74225752e-03), (3.59992662e+02, -2.49274687e-03),
     (3.59994955e+02,  1.06959199e-02), (3.59989189e+02, -1.33273030e-02),
     (3.59989978e+02,  6.88364109e-03), (3.59999219e+02, -1.38270808e-02),
     (6.27897181e-03,  1.07577796e-02), (1.05342787e-02,  3.51187372e-03),
     (3.59999804e+02, -1.72982424e-02), (2.26293055e-03, -1.36038193e-02),
     (2.29686702e-02,  1.15052537e-02), (1.19776978e-02,  9.44013223e-04),
     (5.36960558e-03,  1.11578987e-02), (3.59998815e+02, -1.42243106e-02),
     (3.59990322e+02,  2.85180487e-03), (1.96423804e-03, -1.35133191e-02),
     (1.42571995e-02,  4.85886494e-03), (4.80467091e-03, -1.20187466e-02),
     (3.59994971e+02,  1.20050762e-02), (7.11297983e-03,  5.62714125e-03),
     (5.78476046e-03,  5.53790522e-03), (6.20666085e-03,  1.15527094e-02),
     (1.08512586e-02,  3.74049962e-04), (8.93192434e-03, -1.55822630e-03),
     (3.59992655e+02,  2.83318770e-03), (3.59992682e+02,  1.72520742e-03),
     (3.59992437e+02,  5.27814272e-03), (3.59993835e+02,  4.61795552e-03),
     (1.09370161e-02, -1.46682889e-02), (5.31151556e-03,  3.24833887e-03),
     (8.09035656e-03, -2.75666499e-03), (3.59995590e+02, -1.38995744e-03),
     (6.95438955e-03,  7.81165611e-03), (1.15065970e-02,  1.12092771e-02),
     (3.59992444e+02, -1.59660523e-02), (1.02715096e-02, -4.90362499e-03),
     (1.08748582e-02, -3.22468230e-03), (6.77018640e-03,  1.09086356e-02),
     (1.38640293e-02,  4.08121613e-03), (3.59995202e+02, -1.09903382e-03),
     (3.59997579e+02,  2.83004589e-03), (3.59993413e+02, -1.21312210e-02),
     (2.06967237e-02,  1.20885901e-02), (4.81652737e-03,  6.08225560e-03),
     (3.59989474e+02, -3.61279437e-04), (4.05580852e-03,  7.98180291e-03),
     (6.86556733e-03, -1.03625394e-02), (3.59991260e+02,  1.07560356e-02),
     (4.10190590e-03,  1.49477002e-02), (3.87728854e-03, -1.62763722e-02),
     (1.08194728e-03, -1.11875343e-02), (8.54095489e-03, -7.98211745e-03),
     (5.64384186e-03,  1.19722622e-03), (6.44469539e-03,  5.44147575e-03),
     (3.59998146e+02,  7.10858670e-03), (3.59996613e+02,  1.17726626e-02),
     (3.59990179e+02,  1.19531173e-03), (1.20938939e-02,  9.43625391e-03),
     (2.30210701e-02,  4.06096134e-03), (2.00977582e-02,  5.56522054e-03),
     (3.59997680e+02, -4.85704011e-03), (8.41950052e-03,  1.55358628e-02),
     (6.67788735e-04,  3.55669807e-03), (1.37473120e-02,  9.00705607e-03),
     (3.59989934e+02, -8.22190722e-03), (3.59996942e+02,  6.69143792e-03),
     (5.28313834e-03, -1.43570122e-02), (7.49177436e-03,  1.54190543e-02),
     (3.59994733e+02, -1.40184070e-02), (6.18640419e-03,  5.76352133e-03),
     (7.26937986e-03, -1.00705706e-02), (2.05361409e-02,  7.75259376e-03),
     (3.59998930e+02,  3.02174485e-03), (3.59998141e+02, -1.70120654e-02),
     (3.59993732e+02,  9.26155611e-03), (3.59997622e+02, -1.17700700e-02),
     (1.69418636e-03,  1.13798285e-02), (3.59999989e+02,  1.00787333e-02),
     (1.85374070e-02,  1.48593315e-02), (1.80156876e-02,  9.82105475e-03),
     (2.24546126e-02,  8.75344963e-03), (1.38722442e-03, -1.48914699e-03),
     (3.59997367e+02, -1.76017620e-02), (6.07776395e-04, -6.75889975e-03),
     (3.59991922e+02,  1.07791799e-02)]&gt;
</pre></div>
</div>
</div>
</div>
<p>Now, catalog_in_matches and catalog_out_matches are the matched sources in catalog_in and catalog_out, respectively, which are separated less than our max_sep value.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of matched sources using max separation of &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">max_sep</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;: &#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of matched sources using max separation of 0.04 arcsec:  419
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-ra-and-dec-positions-of-both-catalogs">
<h3>Plot RA and Dec positions of both catalogs<a class="headerlink" href="#plot-ra-and-dec-positions-of-both-catalogs" title="Permalink to this headline">#</a></h3>
<p>The simulated positions are in red and the sources found with source catalog are marked in blue. Matched sources from both are marked in green.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#rrr = catalog_in_matches.ra.deg</span>
<span class="c1">#ddd = catalog_in_matches.dec.deg</span>

<span class="n">rrr</span> <span class="o">=</span> <span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;sky_centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">deg</span>
<span class="n">ddd</span> <span class="o">=</span> <span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;sky_centroid&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">deg</span>

<span class="c1"># make sure ra is in proper range for display</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">rrr</span><span class="p">)):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">rrr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mf">180.</span><span class="p">):</span>
        <span class="n">rrr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-=</span> <span class="mf">360.</span>
        
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rrr</span><span class="p">,</span> <span class="n">ddd</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">108</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">sim_ra</span><span class="p">,</span> <span class="n">sim_dec</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cat_ra</span><span class="p">,</span> <span class="n">cat_dec</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">18</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f3b73b11360&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_60_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_60_1.png" />
</div>
</div>
</section>
<section id="convert-matched-ra-dec-coordinates-back-to-x-y-positions-and-plot-matched-stars-on-image">
<h3>Convert matched RA/Dec coordinates back to x,y positions and plot matched stars on image<a class="headerlink" href="#convert-matched-ra-dec-coordinates-back-to-x-y-positions-and-plot-matched-stars-on-image" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert matched RA/Dec values back to x, y to plot on image</span>

<span class="c1">#print(catalog_out_matches)</span>

<span class="c1"># Read in wcs values from file header (in extension 1)</span>
<span class="c1">#hdu = fits.open(input_file)[1]  </span>
<span class="c1">#wcs = WCS(hdu.header)  </span>

<span class="c1"># convert positions from RA/Dec back to x,y</span>

<span class="c1">#x_matched, y_matched = wcs.world_to_pixel(catalog_out_matches)</span>

<span class="c1">#print(x_matched)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot all matched sources in red</span>

<span class="n">viz2</span> <span class="o">=</span> <span class="n">LogStretch</span><span class="p">()</span> <span class="o">+</span> <span class="n">ManualInterval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="c1">#plt.imshow(viz2(im_i2d.data), origin=&#39;lower&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im_i2d</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="c1">#plt.scatter(x_matched, y_matched,lw=1, s=10,color=&#39;red&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>      
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f3b73c6f880&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_63_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_63_1.png" />
</div>
</div>
</section>
<section id="compare-to-full-catalog-and-see-where-differences-are">
<h3>Compare to full catalog and see where differences are<a class="headerlink" href="#compare-to-full-catalog-and-see-where-differences-are" title="Permalink to this headline">#</a></h3>
<p>The full source_catalog output is shown with black dots and the matched sources are shown with smaller white dots over the black dots. This shows the sources that were found in the catalog (source_catalog step) but not listed as a match between the input and calculated catalogs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viz2</span> <span class="o">=</span> <span class="n">LogStretch</span><span class="p">()</span> <span class="o">+</span> <span class="n">ManualInterval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="c1">#plt.imshow(viz2(im_i2d.data), origin=&#39;lower&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im_i2d</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1">#plt.scatter(x_matched, y_matched,lw=1, s=5,color=&#39;white&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f3b73a39ea0&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_65_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_65_1.png" />
</div>
</div>
</section>
<section id="look-at-positions-of-sources-in-the-simulated-images-from-the-catalogs-used-to-create-the-images">
<h3>Look at positions of sources in the simulated images from the catalogs used to create the images<a class="headerlink" href="#look-at-positions-of-sources-in-the-simulated-images-from-the-catalogs-used-to-create-the-images" title="Permalink to this headline">#</a></h3>
<p>Are there more stars/galaxies in the simulation input catalogs than actually fit on the combined image? That would explain the sources beyond image edges.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">catalog_in</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(2.22919530e-02,  0.00666596), (3.59986872e+02,  0.00303326),
     (8.52752901e-05, -0.0162536 ), ..., (2.40891246e-02, -0.00851495),
     (2.51575873e-02, -0.00331181), (1.81801630e-02,  0.01669308)]&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in wcs values from file header (in extension 1)</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>  
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>  

<span class="c1"># convert positions from RA/Dec back to x,y</span>

<span class="n">x_sim</span><span class="p">,</span> <span class="n">y_sim</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">world_to_pixel</span><span class="p">(</span><span class="n">catalog_in</span><span class="p">)</span>

<span class="c1"># Many sources go beyond image edges. Only display sources that were actually in FOV of combined image.</span>
<span class="n">minval</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">maxval</span> <span class="o">=</span> <span class="mi">1140</span>

<span class="n">ind</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">x_sim</span> <span class="o">&gt;</span> <span class="n">minval</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x_sim</span> <span class="o">&lt;</span> <span class="mi">1110</span><span class="p">)</span><span class="o">&amp;</span> <span class="p">(</span><span class="n">y_sim</span> <span class="o">&gt;</span> <span class="n">minval</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">y_sim</span> <span class="o">&lt;</span> <span class="n">maxval</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">viz2</span> <span class="o">=</span> <span class="n">LogStretch</span><span class="p">()</span> <span class="o">+</span> <span class="n">ManualInterval</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="c1">#plt.imshow(viz2(im_i2d.data), origin=&#39;lower&#39;)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">im_i2d</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;rainbow&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x_sim</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span> <span class="n">y_sim</span><span class="p">[</span><span class="n">ind</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7f3b77d537f0&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_69_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_69_1.png" />
</div>
</div>
</section>
</section>
<section id="compare-fluxes-between-input-sources-and-output-catalog">
<h2>Compare fluxes between input sources and output catalog<a class="headerlink" href="#compare-fluxes-between-input-sources-and-output-catalog" title="Permalink to this headline">#</a></h2>
<p>Input catalog combined has Ks and J columns for stars and flux for galaxies.
Output source catalog catalog has aper_total_flux, isophotal_flux, aper_total_abmag, aper_total_vegamag, isophotal_abmag and isophotal_vegamag.</p>
<p>The first plot compares the magnitudes for the input simulated catalog (in blue) and the sources found with source catalog in green.</p>
<section id="compare-the-star-magnitudes-and-magnitude-differences-to-the-x-position-of-the-stars">
<h3>Compare the star magnitudes and magnitude differences to the x position of the stars.<a class="headerlink" href="#compare-the-star-magnitudes-and-magnitude-differences-to-the-x-position-of-the-stars" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">flux</span><span class="p">,</span> <span class="n">wref</span> <span class="o">=</span> <span class="n">mag2flux</span><span class="p">(</span><span class="n">combined_matched</span><span class="p">[</span><span class="s1">&#39;Ks&#39;</span><span class="p">],</span> <span class="n">band</span><span class="o">=</span><span class="s2">&quot;Ks&quot;</span><span class="p">,</span> <span class="n">system</span><span class="o">=</span><span class="s2">&quot;2MASS&quot;</span><span class="p">)</span>
<span class="n">fnew</span> <span class="o">=</span> <span class="n">extrapolate_flux</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">wref</span><span class="p">,</span> <span class="mf">7.7</span><span class="p">,</span> <span class="n">combined_matched</span><span class="p">[</span><span class="s1">&#39;Teff&#39;</span><span class="p">])</span>
<span class="n">F770W_ABmag</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">((</span><span class="n">fnew</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">Jy</span><span class="p">))</span><span class="o">.</span><span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="mf">8.9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:36,353 - stpipe - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/units/quantity.py:611: RuntimeWarning: divide by zero encountered in divide
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:19:36,366 - stpipe - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/units/quantity.py:611: RuntimeWarning: invalid value encountered in divide
  result = super().__array_ufunc__(function, method, *arrays, **kwargs)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Magnitude         Ks        
------------------
20.212416840039857
19.934826556011455
 19.89842611596745
 19.89751610496635
 19.84382545590144
 19.82198519187504
19.782854718827735
 19.74554426778263
 19.74372424578043
 19.73826417977383
               ...
14.565132036559508
14.414375725214086
13.952102383594207
13.881869560311879
13.126635236879519
12.776853158671695
 11.94688436179194
                --
                --
                --
                --
Length = 419 rows in 2MASS band Ks -&gt; Flux: [5.48231164e-06 7.07945512e-06 7.32082472e-06 7.32696325e-06
 7.69839645e-06 7.85482255e-06 8.14307749e-06 8.42777142e-06
 8.44191076e-06 8.48447127e-06 8.54871469e-06 8.70780950e-06
 8.72241867e-06 8.82537138e-06 8.94452043e-06 9.10334816e-06
 9.22625010e-06 9.24172906e-06 9.27276492e-06 9.33514966e-06
 9.33514966e-06 9.59695437e-06 9.62111583e-06 9.63725725e-06
 9.70209421e-06 9.71837149e-06 9.71837149e-06 9.73467608e-06
 9.79195786e-06 9.85783560e-06 1.00497133e-05 1.03488913e-05
 1.04010660e-05 1.04798217e-05 1.05414881e-05 1.05712618e-05
 1.06134138e-05 1.06698781e-05 1.07124233e-05 1.07266427e-05
 1.07408810e-05 1.07765594e-05 1.07765594e-05 1.08770909e-05
 1.08915288e-05 1.08987550e-05 1.09059860e-05 1.09567373e-05
 1.10077248e-05 1.10077248e-05 1.10296491e-05 1.10442896e-05
 1.10736289e-05 1.10956845e-05 1.11621153e-05 1.11621153e-05
 1.12438488e-05 1.12438488e-05 1.12587736e-05 1.12662434e-05
 1.13186712e-05 1.13939915e-05 1.14015511e-05 1.14166852e-05
 1.14546085e-05 1.15155480e-05 1.15614652e-05 1.15768117e-05
 1.16152668e-05 1.16461230e-05 1.16538498e-05 1.16693188e-05
 1.17938126e-05 1.19512992e-05 1.19830480e-05 1.19909983e-05
 1.20388114e-05 1.20788012e-05 1.21672471e-05 1.21995695e-05
 1.21995695e-05 1.22157630e-05 1.24117687e-05 1.24447407e-05
 1.24447407e-05 1.24612595e-05 1.24860789e-05 1.25026526e-05
 1.26528096e-05 1.26612043e-05 1.27032616e-05 1.27962800e-05
 1.27962800e-05 1.28302734e-05 1.28387859e-05 1.29585552e-05
 1.30361392e-05 1.30707698e-05 1.32893056e-05 1.33688697e-05
 1.33777395e-05 1.35204595e-05 1.36647021e-05 1.37556342e-05
 1.38379902e-05 1.38839565e-05 1.39670809e-05 1.39856204e-05
 1.41442036e-05 1.42666853e-05 1.43045849e-05 1.43235725e-05
 1.44667848e-05 1.45148398e-05 1.45244699e-05 1.45437493e-05
 1.45920599e-05 1.46308239e-05 1.46308239e-05 1.46989089e-05
 1.46989089e-05 1.48360307e-05 1.48853122e-05 1.49248552e-05
 1.51233294e-05 1.51874417e-05 1.52887391e-05 1.53442768e-05
 1.53814139e-05 1.54093258e-05 1.54559581e-05 1.55308635e-05
 1.55402521e-05 1.56250059e-05 1.56817651e-05 1.56912450e-05
 1.57959027e-05 1.58150063e-05 1.58245667e-05 1.58820508e-05
 1.59108711e-05 1.59686687e-05 1.60266763e-05 1.60557590e-05
 1.61726187e-05 1.61921779e-05 1.63989825e-05 1.64287409e-05
 1.64784582e-05 1.64884197e-05 1.64884197e-05 1.65083608e-05
 1.66184685e-05 1.66889192e-05 1.67596685e-05 1.69020681e-05
 1.70148019e-05 1.71905075e-05 1.73890324e-05 1.77285861e-05
 1.77607572e-05 1.77929867e-05 1.78145055e-05 1.79008413e-05
 1.79333250e-05 1.79333250e-05 1.80966299e-05 1.81185159e-05
 1.81294688e-05 1.81623674e-05 1.84388542e-05 1.84946546e-05
 1.85618380e-05 1.85730589e-05 1.86630710e-05 1.88786018e-05
 1.91197172e-05 1.91775780e-05 1.91891712e-05 1.92356139e-05
 1.94695194e-05 1.95166407e-05 1.95166407e-05 1.96824651e-05
 1.97181818e-05 1.97301018e-05 1.97420290e-05 1.98257213e-05
 1.98616980e-05 2.00789332e-05 2.02128560e-05 2.02740249e-05
 2.02985443e-05 2.03722805e-05 2.05205575e-05 2.06506823e-05
 2.07066309e-05 2.07189739e-05 2.09424114e-05 2.13837943e-05
 2.14987886e-05 2.15757948e-05 2.16144013e-05 2.19257505e-05
 2.19780763e-05 2.20305270e-05 2.20699471e-05 2.22415845e-05
 2.22813823e-05 2.23611917e-05 2.25485271e-05 2.26697849e-05
 2.27645471e-05 2.28460872e-05 2.28869666e-05 2.30364861e-05
 2.30495456e-05 2.30495456e-05 2.30756868e-05 2.31542884e-05
 2.32595071e-05 2.33255115e-05 2.34182324e-05 2.35780409e-05
 2.36047814e-05 2.37254898e-05 2.44905577e-05 2.46018487e-05
 2.46996432e-05 2.48822941e-05 2.50520934e-05 2.51516777e-05
 2.51659363e-05 2.53951763e-05 2.54239777e-05 2.54672411e-05
 2.56265044e-05 2.57137947e-05 2.57867638e-05 2.58306445e-05
 2.59774537e-05 2.59774537e-05 2.60069155e-05 2.61250973e-05
 2.61695538e-05 2.61843894e-05 2.62884746e-05 2.64528737e-05
 2.66333909e-05 2.66635966e-05 2.69369944e-05 2.73523564e-05
 2.77426594e-05 2.80589079e-05 2.80911693e-05 2.81249499e-05
 2.81587711e-05 2.85506507e-05 2.85849838e-05 2.88958459e-05
 2.99027209e-05 3.01191249e-05 3.01734701e-05 3.02097547e-05
 3.07038893e-05 3.09446805e-05 3.09632810e-05 3.10751185e-05
 3.13941902e-05 3.18119747e-05 3.20807276e-05 3.21579303e-05
 3.27429038e-05 3.29600501e-05 3.32185350e-05 3.46456235e-05
 3.54245445e-05 3.57667762e-05 3.61992188e-05 3.67471321e-05
 3.79590938e-05 3.82797786e-05 3.84180430e-05 3.86495943e-05
 3.86976757e-05 3.88191603e-05 3.88191603e-05 3.95561189e-05
 3.95809237e-05 3.98048678e-05 3.99548674e-05 4.04082661e-05
 4.09180794e-05 4.11753930e-05 4.16948847e-05 4.34561611e-05
 4.34561611e-05 4.36746434e-05 4.46434923e-05 4.49242332e-05
 4.55480931e-05 4.56910834e-05 4.58345226e-05 4.62965610e-05
 4.67632570e-05 4.71754736e-05 4.75614990e-05 4.91990934e-05
 5.06384795e-05 5.09888739e-05 5.10848561e-05 5.13738880e-05
 5.32427838e-05 5.34769357e-05 5.55038117e-05 5.83557094e-05
 5.99172328e-05 6.09401169e-05 6.15205406e-05 6.38980466e-05
 6.39413267e-05 6.79130301e-05 6.90256622e-05 7.03944407e-05
 7.16932091e-05 7.33131782e-05 7.39613527e-05 7.52239926e-05
 7.70801571e-05 7.87530785e-05 7.89005046e-05 8.07416132e-05
 8.15510159e-05 8.25741890e-05 8.50824871e-05 8.56145636e-05
 8.58818484e-05 8.83803564e-05 8.85458048e-05 8.90440107e-05
 8.98805910e-05 9.31899867e-05 9.34226620e-05 9.67417800e-05
 9.96183139e-05 1.00053991e-04 1.02388707e-04 1.05236145e-04
 1.05630519e-04 1.11072583e-04 1.13251811e-04 1.14031116e-04
 1.14684631e-04 1.15144319e-04 1.15605850e-04 1.16069230e-04
 1.27255001e-04 1.28791364e-04 1.39041200e-04 1.42663155e-04
 1.54503139e-04 1.55451849e-04 1.56269665e-04 1.56406385e-04
 1.62328917e-04 1.67081831e-04 1.73484444e-04 1.82032707e-04
 1.82910365e-04 1.86813490e-04 1.88217100e-04 1.88588221e-04
 2.03658780e-04 2.18916126e-04 2.26075728e-04 2.29569297e-04
 2.35809647e-04 2.44001880e-04 2.45379014e-04 2.53696727e-04
 2.54026439e-04 2.92712299e-04 3.11178933e-04 3.25501567e-04
 3.28755549e-04 3.30472978e-04 3.50017967e-04 3.59098450e-04
 3.66040926e-04 3.83711622e-04 3.98491438e-04 4.32269684e-04
 4.43532497e-04 5.01225556e-04 5.16234099e-04 5.21118026e-04
 5.68069522e-04 6.27143347e-04 6.30880897e-04 6.36739187e-04
 6.98896707e-04 7.44336141e-04 7.49118509e-04 8.01996302e-04
 8.28825166e-04 8.58015300e-04 9.43029406e-04 9.67280735e-04
 9.95125008e-04 1.14335255e-03 1.75020734e-03 1.86716471e-03
 3.74348727e-03 5.16641385e-03 1.10962622e-02 6.66700000e+03
 6.66700000e+03 6.66700000e+03 6.66700000e+03] Jy at 2.159 micron microns
Assuming T=       Teff       
------------------
  2932.71330492906
3002.7093847679253
  3011.19710296713
 3011.409603039126
3023.9736866743538
3029.0994864788286
 3038.304949662553
3047.1083045162154
3047.5383883395934
 3048.829004068853
               ...
 5778.862163941193
 5733.506895774656
 5193.997188026154
 5115.269231711902
 4892.405122741114
 4855.908749660536
 4747.458346750021
                --
                --
                --
                --
Length = 419 rows K, Flux: [5.48231164e-03 7.07945512e-03 7.32082472e-03 7.32696325e-03
 7.69839645e-03 7.85482255e-03 8.14307749e-03 8.42777142e-03
 8.44191076e-03 8.48447127e-03 8.54871469e-03 8.70780950e-03
 8.72241867e-03 8.82537138e-03 8.94452043e-03 9.10334816e-03
 9.22625010e-03 9.24172906e-03 9.27276492e-03 9.33514966e-03
 9.33514966e-03 9.59695437e-03 9.62111583e-03 9.63725725e-03
 9.70209421e-03 9.71837149e-03 9.71837149e-03 9.73467608e-03
 9.79195786e-03 9.85783560e-03 1.00497133e-02 1.03488913e-02
 1.04010660e-02 1.04798217e-02 1.05414881e-02 1.05712618e-02
 1.06134138e-02 1.06698781e-02 1.07124233e-02 1.07266427e-02
 1.07408810e-02 1.07765594e-02 1.07765594e-02 1.08770909e-02
 1.08915288e-02 1.08987550e-02 1.09059860e-02 1.09567373e-02
 1.10077248e-02 1.10077248e-02 1.10296491e-02 1.10442896e-02
 1.10736289e-02 1.10956845e-02 1.11621153e-02 1.11621153e-02
 1.12438488e-02 1.12438488e-02 1.12587736e-02 1.12662434e-02
 1.13186712e-02 1.13939915e-02 1.14015511e-02 1.14166852e-02
 1.14546085e-02 1.15155480e-02 1.15614652e-02 1.15768117e-02
 1.16152668e-02 1.16461230e-02 1.16538498e-02 1.16693188e-02
 1.17938126e-02 1.19512992e-02 1.19830480e-02 1.19909983e-02
 1.20388114e-02 1.20788012e-02 1.21672471e-02 1.21995695e-02
 1.21995695e-02 1.22157630e-02 1.24117687e-02 1.24447407e-02
 1.24447407e-02 1.24612595e-02 1.24860789e-02 1.25026526e-02
 1.26528096e-02 1.26612043e-02 1.27032616e-02 1.27962800e-02
 1.27962800e-02 1.28302734e-02 1.28387859e-02 1.29585552e-02
 1.30361392e-02 1.30707698e-02 1.32893056e-02 1.33688697e-02
 1.33777395e-02 1.35204595e-02 1.36647021e-02 1.37556342e-02
 1.38379902e-02 1.38839565e-02 1.39670809e-02 1.39856204e-02
 1.41442036e-02 1.42666853e-02 1.43045849e-02 1.43235725e-02
 1.44667848e-02 1.45148398e-02 1.45244699e-02 1.45437493e-02
 1.45920599e-02 1.46308239e-02 1.46308239e-02 1.46989089e-02
 1.46989089e-02 1.48360307e-02 1.48853122e-02 1.49248552e-02
 1.51233294e-02 1.51874417e-02 1.52887391e-02 1.53442768e-02
 1.53814139e-02 1.54093258e-02 1.54559581e-02 1.55308635e-02
 1.55402521e-02 1.56250059e-02 1.56817651e-02 1.56912450e-02
 1.57959027e-02 1.58150063e-02 1.58245667e-02 1.58820508e-02
 1.59108711e-02 1.59686687e-02 1.60266763e-02 1.60557590e-02
 1.61726187e-02 1.61921779e-02 1.63989825e-02 1.64287409e-02
 1.64784582e-02 1.64884197e-02 1.64884197e-02 1.65083608e-02
 1.66184685e-02 1.66889192e-02 1.67596685e-02 1.69020681e-02
 1.70148019e-02 1.71905075e-02 1.73890324e-02 1.77285861e-02
 1.77607572e-02 1.77929867e-02 1.78145055e-02 1.79008413e-02
 1.79333250e-02 1.79333250e-02 1.80966299e-02 1.81185159e-02
 1.81294688e-02 1.81623674e-02 1.84388542e-02 1.84946546e-02
 1.85618380e-02 1.85730589e-02 1.86630710e-02 1.88786018e-02
 1.91197172e-02 1.91775780e-02 1.91891712e-02 1.92356139e-02
 1.94695194e-02 1.95166407e-02 1.95166407e-02 1.96824651e-02
 1.97181818e-02 1.97301018e-02 1.97420290e-02 1.98257213e-02
 1.98616980e-02 2.00789332e-02 2.02128560e-02 2.02740249e-02
 2.02985443e-02 2.03722805e-02 2.05205575e-02 2.06506823e-02
 2.07066309e-02 2.07189739e-02 2.09424114e-02 2.13837943e-02
 2.14987886e-02 2.15757948e-02 2.16144013e-02 2.19257505e-02
 2.19780763e-02 2.20305270e-02 2.20699471e-02 2.22415845e-02
 2.22813823e-02 2.23611917e-02 2.25485271e-02 2.26697849e-02
 2.27645471e-02 2.28460872e-02 2.28869666e-02 2.30364861e-02
 2.30495456e-02 2.30495456e-02 2.30756868e-02 2.31542884e-02
 2.32595071e-02 2.33255115e-02 2.34182324e-02 2.35780409e-02
 2.36047814e-02 2.37254898e-02 2.44905577e-02 2.46018487e-02
 2.46996432e-02 2.48822941e-02 2.50520934e-02 2.51516777e-02
 2.51659363e-02 2.53951763e-02 2.54239777e-02 2.54672411e-02
 2.56265044e-02 2.57137947e-02 2.57867638e-02 2.58306445e-02
 2.59774537e-02 2.59774537e-02 2.60069155e-02 2.61250973e-02
 2.61695538e-02 2.61843894e-02 2.62884746e-02 2.64528737e-02
 2.66333909e-02 2.66635966e-02 2.69369944e-02 2.73523564e-02
 2.77426594e-02 2.80589079e-02 2.80911693e-02 2.81249499e-02
 2.81587711e-02 2.85506507e-02 2.85849838e-02 2.88958459e-02
 2.99027209e-02 3.01191249e-02 3.01734701e-02 3.02097547e-02
 3.07038893e-02 3.09446805e-02 3.09632810e-02 3.10751185e-02
 3.13941902e-02 3.18119747e-02 3.20807276e-02 3.21579303e-02
 3.27429038e-02 3.29600501e-02 3.32185350e-02 3.46456235e-02
 3.54245445e-02 3.57667762e-02 3.61992188e-02 3.67471321e-02
 3.79590938e-02 3.82797786e-02 3.84180430e-02 3.86495943e-02
 3.86976757e-02 3.88191603e-02 3.88191603e-02 3.95561189e-02
 3.95809237e-02 3.98048678e-02 3.99548674e-02 4.04082661e-02
 4.09180794e-02 4.11753930e-02 4.16948847e-02 4.34561611e-02
 4.34561611e-02 4.36746434e-02 4.46434923e-02 4.49242332e-02
 4.55480931e-02 4.56910834e-02 4.58345226e-02 4.62965610e-02
 4.67632570e-02 4.71754736e-02 4.75614990e-02 4.91990934e-02
 5.06384795e-02 5.09888739e-02 5.10848561e-02 5.13738880e-02
 5.32427838e-02 5.34769357e-02 5.55038117e-02 5.83557094e-02
 5.99172328e-02 6.09401169e-02 6.15205406e-02 6.38980466e-02
 6.39413267e-02 6.79130301e-02 6.90256622e-02 7.03944407e-02
 7.16932091e-02 7.33131782e-02 7.39613527e-02 7.52239926e-02
 7.70801571e-02 7.87530785e-02 7.89005046e-02 8.07416132e-02
 8.15510159e-02 8.25741890e-02 8.50824871e-02 8.56145636e-02
 8.58818484e-02 8.83803564e-02 8.85458048e-02 8.90440107e-02
 8.98805910e-02 9.31899867e-02 9.34226620e-02 9.67417800e-02
 9.96183139e-02 1.00053991e-01 1.02388707e-01 1.05236145e-01
 1.05630519e-01 1.11072583e-01 1.13251811e-01 1.14031116e-01
 1.14684631e-01 1.15144319e-01 1.15605850e-01 1.16069230e-01
 1.27255001e-01 1.28791364e-01 1.39041200e-01 1.42663155e-01
 1.54503139e-01 1.55451849e-01 1.56269665e-01 1.56406385e-01
 1.62328917e-01 1.67081831e-01 1.73484444e-01 1.82032707e-01
 1.82910365e-01 1.86813490e-01 1.88217100e-01 1.88588221e-01
 2.03658780e-01 2.18916126e-01 2.26075728e-01 2.29569297e-01
 2.35809647e-01 2.44001880e-01 2.45379014e-01 2.53696727e-01
 2.54026439e-01 2.92712299e-01 3.11178933e-01 3.25501567e-01
 3.28755549e-01 3.30472978e-01 3.50017967e-01 3.59098450e-01
 3.66040926e-01 3.83711622e-01 3.98491438e-01 4.32269684e-01
 4.43532497e-01 5.01225556e-01 5.16234099e-01 5.21118026e-01
 5.68069522e-01 6.27143347e-01 6.30880897e-01 6.36739187e-01
 6.98896707e-01 7.44336141e-01 7.49118509e-01 8.01996302e-01
 8.28825166e-01 8.58015300e-01 9.43029406e-01 9.67280735e-01
 9.95125008e-01 1.14335255e+00 1.75020734e+00 1.86716471e+00
 3.74348727e+00 5.16641385e+00 1.10962622e+01 6.66700000e+06
 6.66700000e+06 6.66700000e+06 6.66700000e+06] mJy at 2.159 micron -&gt; Flux: [1.18021241e-03 1.48276837e-03 1.52837593e-03 1.52953414e-03
 1.59946526e-03 1.62883007e-03 1.68281398e-03 1.73597357e-03
 1.73860978e-03 1.74654275e-03 1.75851096e-03 1.78811728e-03
 1.79083366e-03 1.80996561e-03 1.83208417e-03 1.86153057e-03
 1.88428708e-03 1.88715137e-03 1.89289318e-03 1.90442990e-03
 1.90442990e-03 1.95277602e-03 1.95723226e-03 1.96020879e-03
 1.97216083e-03 1.97516034e-03 1.97516034e-03 1.97816448e-03
 1.98871540e-03 2.00084335e-03 2.03612980e-03 2.09103890e-03
 2.10060125e-03 2.11502782e-03 2.12631777e-03 2.13183778e-03
 2.13969071e-03 2.15020666e-03 2.15812779e-03 2.16077470e-03
 2.16342487e-03 2.17006465e-03 2.17006465e-03 2.18876550e-03
 2.19145027e-03 2.19279390e-03 2.19413836e-03 2.20357288e-03
 2.21304828e-03 2.21304828e-03 2.21712172e-03 2.21984155e-03
 2.22529129e-03 2.22938745e-03 2.24172155e-03 2.24172155e-03
 2.25688999e-03 2.25688999e-03 2.25965898e-03 2.26104476e-03
 2.27076922e-03 2.28473446e-03 2.28613573e-03 2.28894088e-03
 2.29596894e-03 2.30725909e-03 2.31576340e-03 2.31860518e-03
 2.32572502e-03 2.33143676e-03 2.33286690e-03 2.33572983e-03
 2.35876112e-03 2.38787233e-03 2.39373787e-03 2.39520653e-03
 2.40403753e-03 2.41142176e-03 2.42774761e-03 2.43371186e-03
 2.43371186e-03 2.43669952e-03 2.47284099e-03 2.47891688e-03
 2.47891688e-03 2.48196045e-03 2.48653288e-03 2.48958588e-03
 2.51723342e-03 2.51877844e-03 2.52651785e-03 2.54362901e-03
 2.54362901e-03 2.54988016e-03 2.55144537e-03 2.57346015e-03
 2.58771348e-03 2.59407380e-03 2.63418422e-03 2.64877646e-03
 2.65040284e-03 2.67656216e-03 2.70298163e-03 2.71962707e-03
 2.73469625e-03 2.74310434e-03 2.75830459e-03 2.76169394e-03
 2.79067329e-03 2.81304053e-03 2.81995903e-03 2.82342471e-03
 2.84955443e-03 2.85831837e-03 2.86007441e-03 2.86358976e-03
 2.87239719e-03 2.87946278e-03 2.87946278e-03 2.89186972e-03
 2.89186972e-03 2.91684542e-03 2.92581788e-03 2.93301587e-03
 2.96927209e-03 2.98101491e-03 2.99956238e-03 3.00972807e-03
 3.01652445e-03 3.02163186e-03 3.03016356e-03 3.04386471e-03
 3.04558173e-03 3.06107883e-03 3.07145429e-03 3.07318696e-03
 3.09231145e-03 3.09580147e-03 3.09754797e-03 3.10804778e-03
 3.11331111e-03 3.12386468e-03 3.13445424e-03 3.13976256e-03
 3.16108642e-03 3.16465453e-03 3.20236525e-03 3.20778928e-03
 3.21684987e-03 3.21866507e-03 3.21866507e-03 3.22229858e-03
 3.24235673e-03 3.25518635e-03 3.26806705e-03 3.29398249e-03
 3.31448957e-03 3.34643526e-03 3.38250597e-03 3.44414298e-03
 3.44997907e-03 3.45582510e-03 3.45972799e-03 3.47538395e-03
 3.48127329e-03 3.48127329e-03 3.51087093e-03 3.51483636e-03
 3.51682077e-03 3.52278075e-03 3.57284404e-03 3.58294226e-03
 3.59509804e-03 3.59712803e-03 3.61340953e-03 3.65237583e-03
 3.69593586e-03 3.70638409e-03 3.70847730e-03 3.71686203e-03
 3.75907263e-03 3.76757244e-03 3.76757244e-03 3.79747432e-03
 3.80391286e-03 3.80606148e-03 3.80821132e-03 3.82329444e-03
 3.82977702e-03 3.86890533e-03 3.89301479e-03 3.90402354e-03
 3.90843580e-03 3.92170271e-03 3.94837258e-03 3.97197406e-03
 3.98190208e-03 3.98406997e-03 4.02329660e-03 4.10069181e-03
 4.12083556e-03 4.13432026e-03 4.14107933e-03 4.19555552e-03
 4.20470506e-03 4.21387477e-03 4.22076531e-03 4.25075616e-03
 4.25770766e-03 4.27164515e-03 4.30434556e-03 4.32550075e-03
 4.34202741e-03 4.35624391e-03 4.36336979e-03 4.38942497e-03
 4.39170010e-03 4.39170010e-03 4.39625393e-03 4.40994408e-03
 4.42826467e-03 4.43975407e-03 4.45588988e-03 4.48368928e-03
 4.48833952e-03 4.50932602e-03 4.64215568e-03 4.66145150e-03
 4.67840183e-03 4.71004644e-03 4.73944882e-03 4.75668579e-03
 4.75915338e-03 4.79881124e-03 4.80379189e-03 4.81127268e-03
 4.83880307e-03 4.85388669e-03 4.86649267e-03 4.87407213e-03
 4.89942326e-03 4.89942326e-03 4.90450945e-03 4.92490763e-03
 4.93257903e-03 4.93513885e-03 4.95309519e-03 4.98144579e-03
 5.01256077e-03 5.01776566e-03 5.06485613e-03 5.13633054e-03
 5.20341909e-03 5.25772694e-03 5.26325468e-03 5.26900958e-03
 5.27477084e-03 5.34148554e-03 5.34732703e-03 5.40019237e-03
 5.57111560e-03 5.60779163e-03 5.61699877e-03 5.62314535e-03
 5.70679377e-03 5.74751705e-03 5.75066176e-03 5.76956667e-03
 5.82347288e-03 5.89399139e-03 5.93931619e-03 5.95233081e-03
 6.05086501e-03 6.08740645e-03 6.13087986e-03 6.37042691e-03
 6.50084911e-03 6.55808167e-03 6.63033999e-03 6.72179702e-03
 6.92372519e-03 6.97707171e-03 7.00006164e-03 7.03854864e-03
 7.04642662e-03 7.06625921e-03 7.06625921e-03 7.18645275e-03
 7.19049482e-03 7.22697764e-03 7.25140404e-03 7.32518820e-03
 7.40806650e-03 7.44986260e-03 7.53417562e-03 7.81935559e-03
 7.81935559e-03 7.85466070e-03 8.01103626e-03 8.05629368e-03
 8.15677716e-03 8.17979145e-03 8.20287175e-03 8.27717455e-03
 8.35216162e-03 8.41834163e-03 8.48027174e-03 8.74251706e-03
 8.97240546e-03 9.02828316e-03 9.04358382e-03 9.08964410e-03
 9.38694770e-03 9.42413366e-03 9.73948202e-03 1.01787140e-02
 1.04183186e-02 1.05749437e-02 1.06637055e-02 1.10264539e-02
 1.10330452e-02 1.16361334e-02 1.18044717e-02 1.20112118e-02
 1.22070262e-02 1.24508001e-02 1.25481952e-02 1.27376913e-02
 1.30157244e-02 1.32564846e-02 1.32775181e-02 1.35398195e-02
 1.36549197e-02 1.38002347e-02 1.41556231e-02 1.42308584e-02
 1.42686326e-02 1.46211081e-02 1.46444092e-02 1.47145454e-02
 1.48322194e-02 1.52965481e-02 1.53291248e-02 1.57928767e-02
 1.61933860e-02 1.62539364e-02 1.65779326e-02 1.69720061e-02
 1.70264948e-02 1.77501344e-02 1.80320324e-02 1.81326799e-02
 1.82170172e-02 1.82763059e-02 1.83358034e-02 1.83955104e-02
 1.98284117e-02 2.00240211e-02 2.13221972e-02 2.17782325e-02
 2.32181045e-02 2.33284949e-02 2.34235917e-02 2.34394841e-02
 2.41263997e-02 2.46755729e-02 2.54125586e-02 2.63917665e-02
 2.64920071e-02 2.69339546e-02 2.70902461e-02 2.71315490e-02
 2.88021709e-02 3.04841287e-02 3.12811106e-02 3.16769541e-02
 3.24077115e-02 3.33634075e-02 3.35237119e-02 3.44900788e-02
 3.45283211e-02 3.90277055e-02 4.11882570e-02 4.28677460e-02
 4.32484531e-02 4.34492626e-02 4.57456814e-02 4.68098570e-02
 4.76217056e-02 4.97111799e-02 5.14592824e-02 5.54615463e-02
 5.67941541e-02 6.36701575e-02 6.54734596e-02 6.60597416e-02
 7.17236655e-02 7.88835822e-02 7.93391316e-02 8.00530111e-02
 8.76398415e-02 9.32034433e-02 9.37922049e-02 1.00335182e-01
 1.03658599e-01 1.07309319e-01 1.18000355e-01 1.21062007e-01
 1.24598346e-01 1.43742180e-01 2.32355761e-01 2.50126099e-01
 5.15326268e-01 7.14572980e-01 1.55716970e+00            nan
            nan            nan            nan] mJy at 7.7 micron
</pre></div>
</div>
</div>
</div>
</section>
<section id="plot-ab-mag-vs-x-position">
<h3>Plot AB mag vs x position<a class="headerlink" href="#plot-ab-mag-vs-x-position" title="Permalink to this headline">#</a></h3>
<p>Simulated stars in blue, sources found in green.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">F770W_ABmag</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Simulated stars&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Sources found&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X position in pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;AB mag&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Text(0, 0.5, &#39;AB mag&#39;)
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_74_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_74_1.png" />
</div>
</div>
</section>
<section id="plot-difference-in-magnitude-against-x-and-y-position">
<h3>Plot difference in magnitude against x and y position.<a class="headerlink" href="#plot-difference-in-magnitude-against-x-and-y-position" title="Permalink to this headline">#</a></h3>
<p>Found catalog minus matched simulated AB mag vs. x position and vs. y position, with the median magnitude difference plotted as a horizontal line in red.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">F770W_ABmag</span><span class="o">-</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>

<span class="c1">#ax.legend()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ABmag difference (simulated - found) vs. x position&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;X position in pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta AB mag&#39;</span><span class="p">)</span>

<span class="n">ok</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">F770W_ABmag</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">F770W_ABmag</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">F770W_ABmag</span><span class="p">[</span><span class="n">ok</span><span class="p">]</span><span class="o">-</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">][</span><span class="n">ok</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.LineCollection at 0x7f3b77d57610&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_76_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_76_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span> <span class="n">F770W_ABmag</span><span class="o">-</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1">#ax.legend()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;ABmag difference (simulated - found) vs. y position&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Y position in pixels&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta AB mag&#39;</span><span class="p">)</span>

<span class="n">ok</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">F770W_ABmag</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">F770W_ABmag</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">F770W_ABmag</span><span class="p">[</span><span class="n">ok</span><span class="p">]</span><span class="o">-</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">][</span><span class="n">ok</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="nb">min</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]),</span> <span class="nb">max</span><span class="p">(</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.LineCollection at 0x7f3b738b7df0&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_77_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_77_1.png" />
</div>
</div>
</section>
<section id="plot-ab-magnitude-difference-against-ab-mag-to-see-if-there-is-a-pattern-in-the-differences-by-mag">
<h3>Plot AB magnitude difference against AB mag to see if there is a pattern in the differences by mag.<a class="headerlink" href="#plot-ab-magnitude-difference-against-ab-mag-to-see-if-there-is-a-pattern-in-the-differences-by-mag" title="Permalink to this headline">#</a></h3>
<p>Median difference marked by line in red.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">F770W_ABmag</span><span class="p">,</span> <span class="n">F770W_ABmag</span><span class="o">-</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="c1">#ax.legend()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Difference in AB mag (simulated-found) vs. ABmag (simulated)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;AB mag&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta AB mag&#39;</span><span class="p">)</span>

<span class="n">ok</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">F770W_ABmag</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">,</span> <span class="n">F770W_ABmag</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">)</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">F770W_ABmag</span><span class="p">[</span><span class="n">ok</span><span class="p">]</span><span class="o">-</span><span class="n">catalog_matched</span><span class="p">[</span><span class="s1">&#39;aper_total_abmag&#39;</span><span class="p">][</span><span class="n">ok</span><span class="p">]</span>
<span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hlines</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">m</span><span class="p">),</span> <span class="mi">16</span><span class="p">,</span> <span class="mf">24.5</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.LineCollection at 0x7f3b750c34f0&gt;
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_source_catalog_miri_test_79_1.png" src="../../../_images/exec_jwst_source_catalog_miri_test_79_1.png" />
</div>
</div>
<section id="passing-criteria">
<h4>Passing criteria<a class="headerlink" href="#passing-criteria" title="Permalink to this headline">#</a></h4>
<p>Look at the matched image to see what sources were matched between the simulated and found catalogs and see if there is a pattern to which found sources were not matched to the simulated catalog. Are they mostly galaxies or were the found sources in areas of confusion between two stars or sources where the source finding algorithm might not have pinpointed the actual centroid of the source. If the majority of the sources matched seem to be the stars that are clearly marked and properly found, that part of the test passes.</p>
<p>If the plots showing magnitudes of the matched sources show that theyre close (exact criteria for close TBD), then that test passes.</p>
<p>This test is mostly visual inspection of the images and plots. As long as nothing is obviously wrong (no columns in the table marked as all NaNs, sources found seem to be real sources, and a good number of them match the simulated sources input into the image), then this test passes.</p>
</section>
<section id="about-this-notebook">
<h4>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this headline">#</a></h4>
<p>Authors: M. Cracraft, M. Libralato and T. Temim, MIRI Branch</p>
<p>Updated On: 08/18/2021</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TheRealZoidberg/jwst_validation_test",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/source_catalog/jwst_source_catalog_miri_test"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../example_notebook/example_notebook.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Draft: Notebook title</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="jwst_source_catalog_miri_test.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By STScI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>