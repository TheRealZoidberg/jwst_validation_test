
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging &#8212; Notebook repository template</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging" href="jwst_tweakreg_miri_test.html" />
    <link rel="prev" title="JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests" href="../../regression_test/outlier_detection/exec_jwst_outlier_detection_unit_tests.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Notebook repository template</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/jwst_background_subtraction_miri_imaging_testing.html">
   JWST Pipeline Validation Notebook: calwebb_image2, background subtraction for MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/exec_jwst_background_subtraction_miri_imaging_testing.html">
   JWST Pipeline Validation Notebook: calwebb_image2, background subtraction for MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/exec_background_sub-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: Background_subtract() for MIRI LRS SLIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/background_sub-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: Background_subtract() for MIRI LRS SLIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pathloss/jwst_pathloss_nirspec_test/exec_jwst_pathloss_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, pathloss step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pathloss/jwst_pathloss_nirspec_test/jwst_pathloss_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, pathloss step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../msaflagopen/jwst_msa_flagging_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, msa_flagging step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../msaflagopen/exec_jwst_msa_flagging_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, msa_flagging step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/jwst_resample_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/exec_jwst_resample_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/jwst_resample_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/exec_jwst_resample_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../example_notebook/example_notebook.html">
   Draft: Notebook title
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_miri_test/exec_jwst_source_catalog_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_miri_test/jwst_source_catalog_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_nircam_test/jwst_nircam_imaging_source_catalog.html">
   JWST Pipeline Validation Notebook: NIRCam, calwebb_image3, source_catalog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_nircam_test/exec_jwst_nircam_imaging_source_catalog.html">
   JWST Pipeline Validation Notebook: NIRCam, calwebb_image3, source_catalog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lastframe/exec_jwst_lastframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, lastframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lastframe/jwst_lastframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, lastframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_lrs_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, photom, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, photom, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_lrs_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_jwst_photom_miri_test.html">
   JWST Pipeline Validation Notebook: photom with MIRI Imager
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/jwst_photom_miri_test.html">
   JWST Pipeline Validation Notebook: photom with MIRI Imager
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/run_ami_pipeline.html">
   JWST Pipeline Validation Notebook:  AMI3, AMI3 Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_analyze_verify.html">
   JWST Pipeline Validation Notebook: AMI3, AmiAnalyze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_average.html">
   JWST Pipeline Validation Notebook:  calwebb_ami3, ami_average
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_normalize.html">
   JWST Pipeline Validation Notebook: calwebb_ami3, ami_normalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_run_ami_pipeline.html">
   JWST Pipeline Validation Notebook:  AMI3, AMI3 Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_normalize.html">
   JWST Pipeline Validation Notebook: calwebb_ami3, ami_normalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_average.html">
   JWST Pipeline Validation Notebook:  calwebb_ami3, ami_average
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_analyze_verify.html">
   JWST Pipeline Validation Notebook: AMI3, AmiAnalyze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_nirspec_test/jwst_assign_wcs_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: NIRSpec, spec2, assign_wcs step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_nirspec_test/exec_jwst_assign_wcs_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: NIRSpec, spec2, assign_wcs step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_niriss_test/jwst_assign_wcs_niriss_image.html">
   JWST Pipeline Validation Notebook: NIRISS, image2, assign_wcs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_niriss_test/exec_jwst_assign_wcs_niriss_image.html">
   JWST Pipeline Validation Notebook: NIRISS, image2, assign_wcs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-mrs.html">
   JWST Pipeline Validation Testing Notebook: MIRI MRS Spec2: Assign_wcs()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-mrs.html">
   JWST Pipeline Validation Testing Notebook: MIRI MRS Spec2: Assign_wcs()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../barshadow/jwst_barshadow_nirspec_test/jwst_barshadow_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, barshadow step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../barshadow/jwst_barshadow_nirspec_test/exec_jwst_barshadow_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, barshadow step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reset/jwst_reset_miri_test/exec_jwst_reset_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_detector1, reset step for MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reset/jwst_reset_miri_test/jwst_reset_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_detector1, reset step for MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../refpix/jwst_refpix_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, refpix unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../refpix/exec_jwst_refpix_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, refpix unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_nirspec_test/jwst_flat_field_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, flat_field step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_nirspec_test/exec_jwst_flat_field_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, flat_field step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flatfield_analysis_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_jwst_flat_field_miri_test.html">
   JWST Pipeline Validation Testing notebook: flat_field step with MIRI Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flat-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flatfield_analysis_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flat_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, flat_field, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flat-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/jwst_flat_field_miri_test.html">
   JWST Pipeline Validation Testing notebook: flat_field step with MIRI Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flat_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, flat_field, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/jwst_skymatch_photom_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch and photometry with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/exec_jwst_skymatch_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/exec_jwst_skymatch_photom_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch and photometry with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/jwst_skymatch_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_miri_test/jwst_jump_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, Jump step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_miri_test/exec_jwst_jump_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, Jump step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, jump unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/exec_jwst_jump_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, jump unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_nircam_test/jwst_image3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_nircam_test/exec_jwst_image3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_miri_test/exec_jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_miri_test/jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_nircam_test/jwst_detector1_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_nircam_test/exec_jwst_detector1_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/exec_jwst_detector1_miri_imtso_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1 for MIRI TSO imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/jwst_detector1_miri_imtso_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1 for MIRI TSO imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/exec_caldetector1-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_detector1/jwst_detector1_miri_test/caldetector1-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, rscd unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/exec_jwst_rscd_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, rscd unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_miri_test/exec_jwst_miri_rscd_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, RSCD step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_miri_test/jwst_miri_rscd_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, RSCD step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image2/jwst_image2_nircam_test/jwst_image2_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image2, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image2/jwst_image2_nircam_test/exec_jwst_image2_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image2, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ramp_fitting/exec_jwst_ramp_fitting_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ramp_fitting unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ramp_fitting/jwst_ramp_fitting_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ramp_fitting unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../firstframe/exec_jwst_firstframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, firstframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../firstframe/jwst_firstframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, firstframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dq_init/exec_jwst_dq_init_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dq_init unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dq_init/jwst_dq_init_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dq_init unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/test_cube_build_spec3.html">
   JWST Pipeline Validation Testing Notebook: Cube Build with MIRISIM Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/exec_testing_point_source_flux_conservation_modeshep_all.html">
   JWST Pipeline Validation Testing Notebook: Point Source Flux Conservation Modeshep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/testing_point_source_flux_conservation_modeshep_all.html">
   JWST Pipeline Validation Testing Notebook: Point Source Flux Conservation Modeshep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/exec_test_cube_build_spec3.html">
   JWST Pipeline Validation Testing Notebook: Cube Build with MIRISIM Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../saturation/exec_jwst_saturation_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, saturation unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../saturation/jwst_saturation_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, saturation unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_2d/jwst_extract_2d_nirspec_test/jwst_extract_2d_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, extract_2d step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_2d/jwst_extract_2d_nirspec_test/exec_jwst_extract_2d_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, extract_2d step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../persistence/exec_jwst_persistence_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, persistence unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../persistence/jwst_persistence_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, persistence unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/exec_extract_1d-spec2-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/extract_1d-spec2-miri-lrs-slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/extract_1d-spec2-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/exec_extract_1d-spec2-miri-lrs-slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dark_current/exec_jwst_dark_current_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dark_current unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dark_current/jwst_dark_current_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dark_current unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/jwst_validation_notebook_template.html">
   JWST Pipeline Validation Notebook:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/exec_jwst_validation_notebook_template.html">
   JWST Pipeline Validation Notebook:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/validation_test_template.html">
   JWST Pipeline Validation Testing Notebook: Descriptive Name of Test You Are Performing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/exec_validation_test_template.html">
   JWST Pipeline Validation Testing Notebook: Descriptive Name of Test You Are Performing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ipc/exec_jwst_ipc_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ipc unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ipc/jwst_ipc_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ipc unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/background/exec_jwst_background_unit_tests.html">
   JWST calwebb_image2, background unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/background/jwst_background_unit_tests.html">
   JWST calwebb_image2, background unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_nirspec_regression_tests.html">
   JWST NIRSpec regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/flatfield/exec_jwst_flatfield_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, flatfield unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/flatfield/jwst_flatfield_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, flatfield unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_nircam_regression_tests.html">
   JWST NIRCam regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/resample/exec_jwst_resample_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, resample unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/resample/jwst_resample_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, resample unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_niriss_regression_tests.html">
   JWST NIRISS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/source_catalog/jwst_source_catalog_unit_tests.html">
   JWST calwebb_image3, source_catalog unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/source_catalog/exec_jwst_source_catalog_unit_tests.html">
   JWST calwebb_image3, source_catalog unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_fgs_regression_tests.html">
   JWST FGS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/photom/jwst_photom_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, photom unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/photom/exec_jwst_photom_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, photom unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/assign_wcs/jwst_assign_wcs_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, assign_wcs unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/assign_wcs/exec_jwst_assign_wcs_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, assign_wcs unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/skymatch/jwst_skymatch_unit_tests.html">
   JWST calwebb_image3, skymatch unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/skymatch/exec_jwst_skymatch_unit_tests.html">
   JWST calwebb_image3, skymatch unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_niriss_regression_tests.html">
   JWST NIRISS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_nirspec_regression_tests.html">
   JWST NIRSpec regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_nircam_regression_tests.html">
   JWST NIRCam regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_fgs_regression_tests.html">
   JWST FGS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_miri_regression_tests.html">
   JWST MIRI regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_miri_regression_tests.html">
   JWST MIRI regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/tweakreg/exec_jwst_tweakreg_unit_tests.html">
   JWST calwebb_image3, tweakreg unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/tweakreg/jwst_tweakreg_unit_tests.html">
   JWST calwebb_image3, tweakreg unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/outlier_detection/jwst_outlier_detection_unit_tests.html">
   JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/outlier_detection/exec_jwst_outlier_detection_unit_tests.html">
   JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="jwst_tweakreg_miri_test.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_jwst_outlier_detection_miri_test.html">
   JWST Pipeline Validation Notebook: outlier_detection with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_jwst_outlier_detection_view_miri_test.html">
   JWST Pipeline Validation Notebook: MIRI view outlier_detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_out_det_test2.html">
   JWST Pipeline Validation Notebook: Outlier Detection for MIRI MRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/out_det_test2.html">
   JWST Pipeline Validation Notebook: Outlier Detection for MIRI MRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/jwst_outlier_detection_miri_test.html">
   JWST Pipeline Validation Notebook: outlier_detection with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/jwst_outlier_detection_view_miri_test.html">
   JWST Pipeline Validation Notebook: MIRI view outlier_detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../superbias/exec_jwst_superbias_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, superbias unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../superbias/jwst_superbias_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, superbias unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/exec_MIRI_shared_calcoron3_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Coron3 for MIRI Coronagraphic Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/jwst_calcoron3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_coron3 with NIRCam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/exec_jwst_calcoron3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_coron3 with NIRCam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/MIRI_shared_calcoron3_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Coron3 for MIRI Coronagraphic Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fringe/JWST_fringe_miri_test/exec_fringe_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, fringe, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fringe/JWST_fringe_miri_test/fringe_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, fringe, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../image3/jwst_image3_miri_test/exec_jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../image3/jwst_image3_miri_test/jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../linearity/jwst_linearity_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, linearity unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../linearity/exec_jwst_linearity_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, linearity unit tests
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/TheRealZoidberg/jwst_validation_test/main?urlpath=tree/notebooks/tweakreg/jwst_tweakreg_miri_test/exec_jwst_tweakreg_miri_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/TheRealZoidberg/jwst_validation_test/blob/main/notebooks/tweakreg/jwst_tweakreg_miri_test/exec_jwst_tweakreg_miri_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/TheRealZoidberg/jwst_validation_test"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/TheRealZoidberg/jwst_validation_test/issues/new?title=Issue%20on%20page%20%2Fnotebooks/tweakreg/jwst_tweakreg_miri_test/exec_jwst_tweakreg_miri_test.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/notebooks/tweakreg/jwst_tweakreg_miri_test/exec_jwst_tweakreg_miri_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#table-of-contents">
     Table of Contents
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calibration-wg-requested-algorithm">
     Calibration WG Requested Algorithm:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-terms">
     Defining Terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#description-of-test">
     Description of test
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#description-of-data">
     Description of data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-temporary-directory-to-work-in-and-read-in-data">
     Create a temporary directory to work in and read in data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-calwebb-detector1-pipeline-to-get-rate-fits-files">
     Run the calwebb_detector1 pipeline to get rate.fits files.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-calwebb-image2-pipeline-to-create-cal-fits-files">
     Run calwebb_image2 pipeline to create cal.fits files
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-1-see-what-happens-with-tweakreg-when-given-data-with-no-shifts">
     Test # 1: See what happens with tweakreg when given data with no shifts.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-the-images-through-calwebb-image3-with-tweakreg-on">
       Run the images through calwebb_image3 with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#go-through-list-of-individual-images-and-see-which-sources-were-found-for-each-image">
       Go through list of individual images and see which sources were found for each image.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-position-differences-as-found-earlier-for-the-individual-i2d-files">
       Get position differences as found earlier for the individual i2d files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#look-at-positions-of-ra-dec-and-get-stats-on-differences-for-the-combined-image-run-with-tweakreg-on">
       Look at positions of RA, Dec and get stats on differences for the combined image run with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-calwebb-image3-with-tweakreg-turned-off">
       Run calwebb_image3 with tweakreg turned off
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-2-see-what-happens-with-tweakreg-when-there-are-shifts-between-images-not-tracked-in-the-wcs">
     Test # 2: See what happens with tweakreg when there are shifts between images not tracked in the wcs.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Run the images through calwebb_image3 with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Go through list of individual images and see which sources were found for each image.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Look at positions of RA, Dec and get stats on differences for the combined image run with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#test-again-with-tweakreg-off">
       Test again with tweakreg off
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#criteria-for-success">
       Criteria for success.
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#about-this-notebook">
         About this Notebook
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#table-of-contents">
     Table of Contents
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calibration-wg-requested-algorithm">
     Calibration WG Requested Algorithm:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#defining-terms">
     Defining Terms
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#description-of-test">
     Description of test
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#description-of-data">
     Description of data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-temporary-directory-to-work-in-and-read-in-data">
     Create a temporary directory to work in and read in data
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-the-calwebb-detector1-pipeline-to-get-rate-fits-files">
     Run the calwebb_detector1 pipeline to get rate.fits files.
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-calwebb-image2-pipeline-to-create-cal-fits-files">
     Run calwebb_image2 pipeline to create cal.fits files
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-1-see-what-happens-with-tweakreg-when-given-data-with-no-shifts">
     Test # 1: See what happens with tweakreg when given data with no shifts.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-the-images-through-calwebb-image3-with-tweakreg-on">
       Run the images through calwebb_image3 with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#go-through-list-of-individual-images-and-see-which-sources-were-found-for-each-image">
       Go through list of individual images and see which sources were found for each image.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-position-differences-as-found-earlier-for-the-individual-i2d-files">
       Get position differences as found earlier for the individual i2d files
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#look-at-positions-of-ra-dec-and-get-stats-on-differences-for-the-combined-image-run-with-tweakreg-on">
       Look at positions of RA, Dec and get stats on differences for the combined image run with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-calwebb-image3-with-tweakreg-turned-off">
       Run calwebb_image3 with tweakreg turned off
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#test-2-see-what-happens-with-tweakreg-when-there-are-shifts-between-images-not-tracked-in-the-wcs">
     Test # 2: See what happens with tweakreg when there are shifts between images not tracked in the wcs.
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Run the images through calwebb_image3 with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Go through list of individual images and see which sources were found for each image.
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Look at positions of RA, Dec and get stats on differences for the combined image run with tweakreg on
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#test-again-with-tweakreg-off">
       Test again with tweakreg off
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#criteria-for-success">
       Criteria for success.
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#about-this-notebook">
         About this Notebook
        </a>
       </li>
      </ul>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a id="title_ID"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="jwst-pipeline-validation-testing-notebook-calwebb-image3-tweakreg-step-with-miri-imaging">
<h1>JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging<a class="headerlink" href="#jwst-pipeline-validation-testing-notebook-calwebb-image3-tweakreg-step-with-miri-imaging" title="Permalink to this headline">#</a></h1>
<p><span style="color:red"> <strong>Instruments Affected</strong></span>: FGS, MIRI, NIRCam, NIRISS</p>
<p>Tested on MIRI Simulated data</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<div style="text-align: left"> 
<p><br>  <a class="reference external" href="#intro_ID">Introduction</a> <br> <a class="reference external" href="#pipeline_ID">Run JWST Pipelines</a> <br> <a class="reference external" href="#imports_ID">Imports</a> <br> <a class="reference external" href="#runpipeline_ID">Create an association table for your cal files and run them through calwebb_image3</a> <br> <a class="reference external" href="#runscript_ID">Find Stars in Image and Determine their Coordinates</a> <br> <a class="reference external" href="#residual_ID">Compare RA and Dec to expected Values</a> <br> <a class="reference external" href="#about_ID">About This Notebook</a> <br></p>
</div><p><a id="intro_ID"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h1>
<p>This test is designed to test the tweakreg step in the calwebb_image3 pipeline. At the start of the calwebb_image3 pipeline, the shifts between the images in an association table are found. This step creates image catalogs of point-like sources whose centroids are then used to compute corrections to the WCS of the input images such that sky catalogs obtained from the image catalogs using the corrected WCS will align on the sky.</p>
<p>For more information on the pipeline step visit the links below.</p>
<p>Step description: <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/tweakreg/README.html">https://jwst-pipeline.readthedocs.io/en/latest/jwst/tweakreg/README.html</a></p>
<p>Pipeline code: <a class="reference external" href="https://github.com/spacetelescope/jwst/tree/master/jwst/tweakreg">https://github.com/spacetelescope/jwst/tree/master/jwst/tweakreg</a></p>
<p>The data for this test were created with the MIRI Data Simulator, and the documentation for that code can be found here: <a class="reference external" href="http://miri.ster.kuleuven.be/bin/view/Public/MIRISim_Public">http://miri.ster.kuleuven.be/bin/view/Public/MIRISim_Public</a></p>
<section id="calibration-wg-requested-algorithm">
<h2>Calibration WG Requested Algorithm:<a class="headerlink" href="#calibration-wg-requested-algorithm" title="Permalink to this headline">#</a></h2>
<p>A short description and link to the page: <a class="reference external" href="https://outerspace.stsci.edu/display/JWSTCC/Vanilla+Refine+WCS">https://outerspace.stsci.edu/display/JWSTCC/Vanilla+Refine+WCS</a></p>
</section>
<section id="defining-terms">
<h2>Defining Terms<a class="headerlink" href="#defining-terms" title="Permalink to this headline">#</a></h2>
<p>Definition of terms or acronymns.</p>
<p>JWST: James Webb Space Telescope</p>
<p>MIRI: Mid-Infrared Instrument</p>
<p>MIRISim: MIRI Data Simulator</p>
</section>
<section id="description-of-test">
<h2>Description of test<a class="headerlink" href="#description-of-test" title="Permalink to this headline">#</a></h2>
<p>This test is performed by creating a set of simulated data with multiple point sources located at specified coordinates. The simulator puts in the expected distortion, so the initial output data comes out of the simulator in distorted coordinates. When this data is then run through calwebb_detector1, calwebb_image2 and calwebbb_image3, the combined, undistorted image should have the point sources registered at the expected locations. In flight, this test can be repeated with known stars that should be found at their expected coordinates. If there is a shift in coordinates between the images that was not expected, tweakreg will find the sources to create a better image alignment. This is checked by using DAOStarFinder to find the point sources in each image (individual and combined) so that the catalogs can be compared to the expected RA and Dec values that were used to create the images. The user will look at whether the statistics of the combined sources are better or worse than those of the individual images.</p>
</section>
<section id="description-of-data">
<h2>Description of data<a class="headerlink" href="#description-of-data" title="Permalink to this headline">#</a></h2>
<p>The data used in this simulation were created with the MIRISim simulator.</p>
<p>The simulation consists of eight files, two exposures each at four different dither positions. The images used in this test have 50 bright point sources scattered across the images, and were created in the F1130W filter.</p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;crds&#39;</span><span class="p">,</span> <span class="s1">&#39;cache&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS cache location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>         <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS cache location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]))</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/os.py:679,</span> in <span class="ni">_Environ.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">encodekey</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span>     <span class="c1"># raise KeyError with the original key value</span>
<span class="ne">--&gt; </span><span class="mi">679</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
<span class="g g-Whitespace">    </span><span class="mi">680</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodevalue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;CRDS_PATH&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># set up import statements</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">ascii</span><span class="p">,</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.stats</span> <span class="kn">import</span> <span class="n">sigma_clipped_stats</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Column</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">SqrtStretch</span>
<span class="kn">from</span> <span class="nn">astropy.visualization.mpl_normalize</span> <span class="kn">import</span> <span class="n">ImageNormalize</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">table</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span><span class="p">,</span> <span class="n">match_coordinates_sky</span>

<span class="c1">#from ci_watson.artifactory_helpers import get_bigdata</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">itertools</span> <span class="kn">import</span> <span class="n">product</span>
<span class="kn">from</span> <span class="nn">ci_watson.artifactory_helpers</span> <span class="kn">import</span> <span class="n">get_bigdata</span>

<span class="c1"># Box download imports </span>
<span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">download_file</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">move</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">splitext</span>

<span class="kn">from</span> <span class="nn">jwst.datamodels</span> <span class="kn">import</span> <span class="n">DrizProductModel</span><span class="p">,</span> <span class="n">ImageModel</span>
<span class="kn">from</span> <span class="nn">jwst.pipeline</span> <span class="kn">import</span> <span class="n">Detector1Pipeline</span><span class="p">,</span> <span class="n">Image2Pipeline</span><span class="p">,</span> <span class="n">Image3Pipeline</span>
<span class="kn">from</span> <span class="nn">jwst</span> <span class="kn">import</span> <span class="n">associations</span>
<span class="kn">from</span> <span class="nn">jwst.associations.lib.rules_level3_base</span> <span class="kn">import</span> <span class="n">DMS_Level3_Base</span>
<span class="kn">from</span> <span class="nn">jwst.associations</span> <span class="kn">import</span> <span class="n">asn_from_list</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">photutils</span> <span class="kn">import</span> <span class="n">CircularAperture</span><span class="p">,</span> <span class="n">DAOStarFinder</span><span class="p">,</span> <span class="n">CircularAnnulus</span><span class="p">,</span> <span class="n">aperture_photometry</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="create-a-temporary-directory-to-work-in-and-read-in-data">
<h2>Create a temporary directory to work in and read in data<a class="headerlink" href="#create-a-temporary-directory-to-work-in-and-read-in-data" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a temporary directory to hold notebook output, and change the working directory to that directory.</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="n">data_dir</span> <span class="o">=</span> <span class="n">TemporaryDirectory</span><span class="p">()</span>
<span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">data_dir</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data_dir</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;TemporaryDirectory &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv&#39;&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#print(&quot;Downloading input files&quot;)</span>
 
<span class="c1">#This readnoise file is needed for use with simulated data which has higher readnoise than actual data.</span>
<span class="c1">#readnoise = get_bigdata(&#39;jwst_validation_notebooks&#39;,</span>
<span class="c1">#                     &#39;validation_data&#39;,</span>
<span class="c1">#                     &#39;jump&#39;,                     </span>
<span class="c1">#                     &#39;jump_miri_test&#39;, </span>
<span class="c1">#                     &#39;jwst_mirisim_readnoise.fits&#39;)</span>

<span class="c1">#filelist = [&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1.fits&#39;, </span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2.fits&#39;,</span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1.fits&#39;,</span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2.fits&#39;,</span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1.fits&#39;,</span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2.fits&#39;,</span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1.fits&#39;,</span>
<span class="c1">#            &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2.fits&#39;]</span>

<span class="c1">#for file in filelist:</span>
<span class="c1">#    input_file = get_bigdata(&#39;jwst_validation_notebooks&#39;,</span>
<span class="c1">#                     &#39;validation_data&#39;,</span>
<span class="c1">#                     &#39;outlier_detection&#39;,</span>
<span class="c1">#                     &#39;outlier_detection_miri_test&#39;,</span>
<span class="c1">#                     file)</span>
    
<span class="c1">#coords = get_bigdata(&#39;jwst_validation_notebooks&#39;,</span>
<span class="c1">#                     &#39;validation_data&#39;,</span>
<span class="c1">#                     &#39;resample&#39;,</span>
<span class="c1">#                     &#39;resample_miri_test&#39;, </span>
<span class="c1">#                     &#39;radec_4ptdith_50star_mosaic_coords.txt&#39;)    </span>

<span class="c1">#print(&quot;Finished Downloads&quot;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read rate files in from Box rather than starting with uncal and running through calwebb_detector1</span>

<span class="k">def</span> <span class="nf">get_box_files</span><span class="p">(</span><span class="n">file_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">box_url</span><span class="p">,</span><span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;https&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">box_url</span><span class="p">:</span>
            <span class="n">box_url</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/&#39;</span> <span class="o">+</span> <span class="n">box_url</span>
        <span class="n">downloaded_file</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">box_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">box_url</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">file_name</span> <span class="o">+=</span> <span class="n">ext</span>
        <span class="n">move</span><span class="p">(</span><span class="n">downloaded_file</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>

        
<span class="n">file_urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://stsci.box.com/shared/static/46kwitm6fswmeiuw4gu6xxgeioy7dhca.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/8vs4njvio6y15cdcl3rjtb4veb55h6o9.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/09xjv0lpe35o50f2xf4ydu523g03s9fd.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/tqay5edhq1hstayk897ugd8t5sjbbjme.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/rmri5jb6gwpezva2rgzkkguoeos7nocv.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/pdtjm55j5ahj08i1rm91jw5p2ijpvi68.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/bw5jsrorue4g2eprpd06w8sdvy6etqhv.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/y3thiqwcyihw30vndpy16o8bjxn36o89.fits&#39;</span><span class="p">,</span>
             <span class="s1">&#39;https://stsci.box.com/shared/static/u2wc9ocug98ut8arz383oid0eru06qbo.txt&#39;</span><span class="p">]</span>
    
<span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;radec_4ptdith_50star_mosaic_coords.txt&#39;</span><span class="p">]</span>

    
<span class="n">box_download_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">url</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">url</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_urls</span><span class="p">,</span><span class="n">file_names</span><span class="p">)]</span>


<span class="n">get_box_files</span><span class="p">(</span><span class="n">box_download_list</span><span class="p">)</span>
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coords</span> <span class="o">=</span> <span class="s1">&#39;radec_4ptdith_50star_mosaic_coords.txt&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-the-calwebb-detector1-pipeline-to-get-rate-fits-files">
<h2>Run the calwebb_detector1 pipeline to get rate.fits files.<a class="headerlink" href="#run-the-calwebb-detector1-pipeline-to-get-rate-fits-files" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run the calwebb_detector1 pipeline</span>

<span class="c1"># set up pipeline parameters </span>
<span class="c1">#rej_thresh=10.0  # rejection threshold for jump step</span>

<span class="c1">#print(&#39;There are &#39;, len(filelist), &#39; images.&#39;)</span>
    
<span class="c1">#slopelist = []    </span>
    
<span class="c1"># loop over list of files</span>
<span class="c1">#for file in filelist:</span>
       
    <span class="c1"># set up pipeline parameters for input</span>
<span class="c1">#    pipe1 = Detector1Pipeline()</span>
<span class="c1">#    pipe1.jump.rejection_threshold = rej_thresh</span>
<span class="c1">#    pipe1.jump.override_readnoise = readnoise</span>
<span class="c1">#    pipe1.ramp_fit.override_readnoise = readnoise</span>

<span class="c1">#    pipe1.refpix.skip = True  # needs update to simulator for this to work properly with simulated data</span>
        
    <span class="c1"># set up output file name</span>
<span class="c1">#    base, remainder = file.split(&#39;.&#39;)</span>
<span class="c1">#    outname = base</span>
        
<span class="c1">#    pipe1.jump.output_file = outname+&#39;.fits&#39;    </span>
    <span class="c1">#pipe1.ramp_fit.output_file = outname+&#39;.fits&#39;</span>
<span class="c1">#    pipe1.output_file = outname+&#39;.fits&#39;</span>

    <span class="c1"># Run pipeline on each file</span>
<span class="c1">#    rampfile = pipe1.run(file)</span>
<span class="c1">#    slopelist.append(rampfile)</span>
    
    <span class="c1"># Close the input files</span>
    <span class="c1">#file.close()</span>

<span class="c1">#print(&#39;Detector 1 steps completed on all files.&#39;)</span>
<span class="c1">#print(slopelist)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">slopelist</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span> 
            <span class="s1">&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&#39;</span><span class="p">,</span>
            <span class="s1">&#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="run-calwebb-image2-pipeline-to-create-cal-fits-files">
<h2>Run calwebb_image2 pipeline to create cal.fits files<a class="headerlink" href="#run-calwebb-image2-pipeline-to-create-cal-fits-files" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image2 on output files from detector1</span>
    
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;There are &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">slopelist</span><span class="p">),</span> <span class="s1">&#39; images.&#39;</span><span class="p">)</span>

<span class="n">callist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ratefilenames</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># cycle through files</span>
<span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">slopelist</span><span class="p">:</span>
    <span class="n">rampfile</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
    
    <span class="c1"># create an object for the pipeline    </span>
    <span class="n">pipe2</span> <span class="o">=</span> <span class="n">Image2Pipeline</span><span class="p">()</span>
    
    <span class="n">filename</span> <span class="o">=</span> <span class="n">rampfile</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">filename</span>
    <span class="n">ratefilenames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="c1"># Set pipeline parameters</span>

    <span class="n">pipe2</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">pipe2</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="n">filename</span> <span class="o">+</span><span class="s1">&#39;_cal.fits&#39;</span>
    <span class="n">pipe2</span><span class="o">.</span><span class="n">resample</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">pipe2</span><span class="o">.</span><span class="n">suffix</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="n">calfile</span> <span class="o">=</span> <span class="n">pipe2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">rampfile</span><span class="p">)</span>

    <span class="n">callist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">calfile</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">callist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>There are  8  images.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,153 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,155 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,158 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,160 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,161 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,163 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,272 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,277 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,285 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,630 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,633 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,635 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,636 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,637 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,638 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,641 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,643 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,644 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,646 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,648 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,649 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,649 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,650 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,651 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,652 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,652 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,653 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,655 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,655 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,656 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,657 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,657 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,658 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,730 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,731 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,915 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:09,918 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,129 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,204 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.019532876 -0.016147752 0.021999558 0.015037465 359.990697171 0.017630270 359.987889494 -0.013568846
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,206 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.019532876 -0.016147752 0.021999558 0.015037465 359.990697171 0.017630270 359.987889494 -0.013568846
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,206 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,249 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,310 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,455 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,457 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,692 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,694 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,695 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,702 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,851 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,981 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:10,983 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,010 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,011 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,098 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,100 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,100 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,101 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,191 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,195 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,197 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,198 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,217 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,348 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,350 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,379 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:11,519 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:12,251 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:12,605 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:13,279 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:13,639 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:14,290 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:14,654 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,258 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,653 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.019529633 -0.016360379 0.022280129 0.014982155 359.990661583 0.017756872 359.987911088 -0.013585662
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,785 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,786 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,787 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,789 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,790 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,978 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:15,981 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,026 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,028 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,030 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,032 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,033 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,035 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,189 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,195 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,203 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,212 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,214 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,215 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,216 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,216 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,217 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,219 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,221 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,222 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,224 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,226 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,226 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,227 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,228 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,228 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,229 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,229 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,230 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,232 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,232 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,233 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,233 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,234 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,234 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,291 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,292 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,424 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,426 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,614 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,697 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.019532876 -0.016147752 0.021999558 0.015037465 359.990697171 0.017630270 359.987889494 -0.013568846
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,699 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.019532876 -0.016147752 0.021999558 0.015037465 359.990697171 0.017630270 359.987889494 -0.013568846
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,700 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,736 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,794 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,927 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:16,929 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,035 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,036 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,037 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,044 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,175 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,294 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,296 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,321 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,322 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,405 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,406 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,407 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,408 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,456 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,458 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,460 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,461 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,479 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,594 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,597 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,623 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:17,758 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:18,380 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:18,733 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:19,327 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:19,735 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:20,338 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:20,762 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,373 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,748 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.019529633 -0.016360379 0.022280129 0.014982155 359.990661583 0.017756872 359.987911088 -0.013585662
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,869 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,870 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,871 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,873 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:21,874 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,043 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,044 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,084 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,086 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,088 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,090 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,092 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,094 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,227 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,233 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,244 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,249 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,251 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,252 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,253 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,254 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,255 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,258 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,261 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,261 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,264 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,266 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,267 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,267 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,268 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,269 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,270 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,271 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,271 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,273 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,274 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,275 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,275 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,276 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,277 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,326 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,328 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,455 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,458 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,651 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,724 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020172025 -0.017469545 0.022638707 0.013715672 359.991336319 0.016308478 359.988528642 -0.014890638
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,725 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020172025 -0.017469545 0.022638707 0.013715672 359.991336319 0.016308478 359.988528642 -0.014890638
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,726 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,763 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,820 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,945 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:22,947 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,060 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,062 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,062 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,070 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,208 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,334 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,336 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,362 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,363 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,446 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,448 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,448 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,449 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,507 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,510 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,511 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,512 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,531 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,663 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,666 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,693 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:23,826 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:24,512 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:24,869 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:25,505 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:25,867 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:26,480 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:26,858 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:27,458 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:27,873 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020168782 -0.017682172 0.022919277 0.013660362 359.991300731 0.016435079 359.988550236 -0.014907455
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:27,997 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:27,999 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,000 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,002 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,004 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,183 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,188 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,229 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,231 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,233 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,234 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,236 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,238 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,481 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,487 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,495 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,504 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,507 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,507 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,509 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,509 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,510 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,512 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,514 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,515 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,517 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,519 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,519 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,520 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,520 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,521 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,522 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,522 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,523 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,525 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,525 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,526 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,527 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,527 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,528 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,587 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,588 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,835 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:28,838 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,027 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,107 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020172025 -0.017469545 0.022638707 0.013715672 359.991336319 0.016308478 359.988528642 -0.014890638
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,108 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020172025 -0.017469545 0.022638707 0.013715672 359.991336319 0.016308478 359.988528642 -0.014890638
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,108 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,145 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,202 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,442 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,444 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,560 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,561 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,562 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,570 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,719 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,956 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,958 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,984 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:29,985 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,073 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,074 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,075 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,076 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,125 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,127 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,128 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,129 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,148 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,393 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,395 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,423 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:30,558 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:31,244 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:31,597 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:32,200 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:32,553 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:33,137 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:33,495 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,065 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,456 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020168782 -0.017682172 0.022919277 0.013660362 359.991300731 0.016435079 359.988550236 -0.014907455
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,577 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,579 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,580 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,582 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,583 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,752 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,754 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,794 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,796 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,798 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,800 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,802 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:34,804 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,085 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,092 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,101 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,109 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,112 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,112 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,113 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,114 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,114 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,116 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,118 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,118 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,120 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,122 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,123 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,123 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,124 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,125 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,125 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,126 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,127 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,129 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,130 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,130 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,131 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,131 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,132 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,200 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,201 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,437 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,440 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,628 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,712 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020403170 -0.019920319 0.022869851 0.011264898 359.991567464 0.013857704 359.988759787 -0.017341412
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,714 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020403170 -0.019920319 0.022869851 0.011264898 359.991567464 0.013857704 359.988759787 -0.017341412
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,715 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,751 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:35,810 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,009 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,012 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,137 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,138 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,140 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,146 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,287 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,485 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,487 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,514 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,515 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,602 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,603 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,604 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,605 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,654 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,656 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,658 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,659 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,676 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,865 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,868 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:36,895 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:37,025 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:37,693 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:38,050 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:38,704 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:39,081 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:39,704 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:40,063 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:40,689 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,082 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020399927 -0.020132946 0.023150422 0.011209589 359.991531876 0.013984305 359.988781381 -0.017358229
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,214 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,216 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,217 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,219 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,220 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,394 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,395 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,433 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,435 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,437 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,439 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,440 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,442 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,679 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,684 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,693 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,700 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,704 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,705 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,706 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,707 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,709 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,712 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,715 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,716 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,718 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,722 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,722 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,723 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,724 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,725 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,726 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,727 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,728 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,731 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,732 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,733 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,735 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,736 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,736 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,801 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:41,802 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,005 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,007 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,196 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,268 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020403170 -0.019920319 0.022869851 0.011264898 359.991567464 0.013857704 359.988759787 -0.017341412
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,270 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020403170 -0.019920319 0.022869851 0.011264898 359.991567464 0.013857704 359.988759787 -0.017341412
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,271 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,308 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,366 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,599 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,601 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,720 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,722 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,723 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,730 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:42,867 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,057 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,060 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,086 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,087 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,176 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,177 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,178 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,178 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,229 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,232 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,233 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,234 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,251 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,445 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,447 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,474 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:43,609 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:44,310 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:44,698 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:45,357 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:45,726 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:46,363 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:46,719 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,297 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,673 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020399927 -0.020132946 0.023150422 0.011209589 359.991531876 0.013984305 359.988781381 -0.017358229
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,795 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,796 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,797 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,799 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:47,800 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,007 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,008 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,049 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,051 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,053 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,055 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,058 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,060 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,348 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,355 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,365 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,370 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,374 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,375 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,376 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,377 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,378 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,380 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,383 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,384 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,386 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,388 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,389 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,390 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,391 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,391 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,392 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,393 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,393 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,395 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,396 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,397 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,397 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,398 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,398 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,455 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,456 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,739 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,741 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:48,966 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,063 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.021939052 -0.019421471 0.024405733 0.011763747 359.993103346 0.014356552 359.990295669 -0.016842564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,065 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.021939052 -0.019421471 0.024405733 0.011763747 359.993103346 0.014356552 359.990295669 -0.016842564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,066 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,108 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,177 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,449 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,452 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,600 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,601 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,602 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,613 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:49,798 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,061 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,064 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,092 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,093 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,181 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,183 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,183 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,184 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,235 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,238 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,239 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,240 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,258 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,523 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,526 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,555 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:50,692 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:51,336 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:51,688 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:52,294 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:52,648 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:53,221 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:53,585 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,159 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,538 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021935809 -0.019634097 0.024686304 0.011708437 359.993067758 0.014483153 359.990317263 -0.016859381
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,658 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,659 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,660 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,663 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,664 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,831 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,832 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,872 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,874 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,876 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,878 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,880 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:54,883 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,151 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,159 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits_cal.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,169 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,174 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,178 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,179 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,180 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,181 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,182 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,184 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,186 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,187 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,189 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,192 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,193 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,193 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,194 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,195 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,196 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,196 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,197 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,199 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,199 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,200 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,201 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,201 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,202 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,269 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,271 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,522 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,524 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,715 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,789 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.021939052 -0.019421471 0.024405733 0.011763747 359.993103346 0.014356552 359.990295669 -0.016842564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,790 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.021939052 -0.019421471 0.024405733 0.011763747 359.993103346 0.014356552 359.990295669 -0.016842564
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,791 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,828 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:55,886 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,132 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,134 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,243 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,244 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,246 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,255 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,393 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,640 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,642 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,670 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,671 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,759 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,760 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,761 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,762 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,812 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,814 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,816 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,818 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:56,836 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:57,072 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:57,075 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:57,103 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:57,237 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:57,843 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:58,201 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:58,819 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:59,192 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:24:59,817 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:00,182 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:00,790 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,164 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021935809 -0.019634097 0.024686304 0.011708437 359.993067758 0.014483153 359.990317263 -0.016859381
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,295 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,296 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,297 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_rate.fits_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,300 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,301 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,466 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:01,468 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits&gt;], [&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits&gt;]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">imagelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ele</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;rate&#39;</span><span class="p">,</span> <span class="s1">&#39;cal&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ratefilenames</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imagelist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits&#39;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="test-1-see-what-happens-with-tweakreg-when-given-data-with-no-shifts">
<h2>Test # 1: See what happens with tweakreg when given data with no shifts.<a class="headerlink" href="#test-1-see-what-happens-with-tweakreg-when-given-data-with-no-shifts" title="Permalink to this headline">#</a></h2>
<p>This test uses MIRISim data using only the simulated dithers, and no shifts. Two exposures each of four different dithers, perfect alignment.</p>
<p>First look at the cal images out of calwebb_image2.</p>
<ul class="simple">
<li><p>Use DAOStarFinder to get the x,y positions of the stars in each image</p></li>
<li><p>Use wcs info from image to convert x,y positions to RA, Dec</p></li>
<li><p>Compare the RA, Dec calculated values to the RA, Dec positions put into the simulated images</p></li>
<li><p>Get statistics on the differences of the calculated and input positions in units of mas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find stars and get RA, Dec from *_cal.fits files</span>

<span class="c1"># Run DAOStarFinder to find sources in image</span>
<span class="n">allRAdiff_cal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">allDecdiff_cal</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">calimage</span> <span class="ow">in</span> <span class="n">imagelist</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">calimage</span><span class="p">)</span>
    
    <span class="c1"># pull out data portion of input file</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># print stats on input image</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">calimage</span><span class="p">)</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

    <span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>     

    <span class="c1"># Create apertures for x,y positions</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
    <span class="c1">#print(positions)</span>

    <span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
    <span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>
    
    <span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
    <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

    <span class="c1"># add RA, Dec to sources table</span>

    <span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
    <span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
    <span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
    <span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

    <span class="c1"># print RA, Dec for each x, y position found</span>
    <span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

    <span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
    <span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
    
    <span class="c1"># read in text file with RA and Dec input coordinates</span>
    <span class="n">RA_in</span><span class="p">,</span> <span class="n">Dec_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span> <span class="n">coords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># put RA and Dec into floats</span>
    <span class="n">RA_sim</span> <span class="o">=</span> <span class="n">RA_in</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Dec_sim</span> <span class="o">=</span> <span class="n">Dec_in</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="c1"># Put ra, dec coords into a table</span>
    <span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    <span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    
    <span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
    <span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
    <span class="c1"># Find where the catalogs match</span>
    
    <span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
    <span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
    <span class="c1">#print(cat1_matched)</span>
    
    <span class="c1"># Get differences in RA, Dec</span>
    <span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
    <span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
    <span class="c1">#print(ra_diff)</span>
    
    <span class="c1"># put differences in milliarcseconds</span>
    <span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    <span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    
    
    <span class="c1"># Compare input RA, Dec to found RA, Dec</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
    <span class="c1"># Find if the differences are within the allowed 30 mas range</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
        <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
        <span class="n">allRAdiff_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">allDecdiff_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
            <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
    <span class="c1"># Plot ra and dec differences</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">,</span><span class="n">dec_diff</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
 
    <span class="c1"># Plot should show no differences greater than 30 milliarcseconds  </span>
    
<span class="n">meanRAdiff_cal</span><span class="p">,</span> <span class="n">medianRAdiff_cal</span><span class="p">,</span> <span class="n">stdRAdiff_cal</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">allRAdiff_cal</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_cal</span><span class="p">,</span> <span class="n">medianDecdiff_cal</span><span class="p">,</span> <span class="n">stdDecdiff_cal</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">allDecdiff_cal</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_cal</span><span class="p">,</span> <span class="n">medianRAdiff_cal</span><span class="p">,</span> <span class="n">stdRAdiff_cal</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_cal</span><span class="p">,</span> <span class="n">medianDecdiff_cal</span><span class="p">,</span> <span class="n">stdDecdiff_cal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.393542 10.826687 55.011623
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    xcentroid          ycentroid                RA                   Dec          
------------------ ------------------ --------------------- ----------------------
 608.5415674187961 2.5119766176307223 0.0008812919624467749  -0.014594789515541495
 685.5194495798157 5.5188105009736175     359.9985262521632  -0.014309517462321978
 886.3394041097413 32.119070281158955    359.99243205390275  -0.012997454423196865
    953.8640393199  37.04011242844017     359.9903742953238  -0.012674257323148128
444.47609551197064 61.922582668650286  0.006066875156909462  -0.013223542150700983
  708.539078792773  73.05874981354657     359.9979903713137   -0.01222441448341229
373.69156711571156  82.73445867221936   0.00829150779169885  -0.012772340592118013
 429.1719580852977   96.9350873606011 0.0066252609207797806   -0.01220541183653611
486.33656250883286 111.09479540127342 0.0049071267763785495  -0.011634212317900124
  812.818016502769 135.61499300669485     359.9949510782622  -0.010070810306428344
 550.2541709849713 143.00728324989907  0.003027257861743836  -0.010506369320026828
  856.669674639311   163.941532747077    359.99367943542825  -0.009101781916248714
 943.4770993700253 165.11663853495494    359.99102011241314  -0.008847567308604684
 379.3675519242359 175.61124295871804  0.008352878219398573  -0.009943295128109814
 390.9846006266449 182.23371017799838  0.008013454071705377  -0.009712529245328462
464.78741113955334  193.6264598801728  0.005779073595006636  -0.009180116965875892
 706.4675734066059  205.4374537771488    359.99839582116016  -0.008215197294039717
 471.0120867553802 208.50201007466694  0.005626274700481911  -0.008710684120420042
 848.6281552463014 225.05905956689554    359.99408676890266  -0.007263193491265538
 717.2680096211556 238.78542812577177     359.9981519861035  -0.007170315851777638
 640.8254738397458  287.3850110723211  0.000623866158697791  -0.005872632451303791
  696.647862932052  311.4570263322215     359.9989761969678  -0.004996253375845009
 534.5080406150863  350.3689320851547  0.004046584544183354  -0.004204164820881179
432.09694109427744  418.3411466005772  0.007357153703276762  -0.002371455183037188
 665.3824794715022  444.0669679431664 0.0002867232340403056 -0.0009972307220539013
 704.8442236777602  454.5198152664274      359.999107133171  -0.000579048618063702
 397.1594591938331  455.0466542459958  0.008519471619160033 -0.0013305641705300796
  670.371981463498  468.5413077513855 0.0001994299693774992 -0.0002316467303177302
  857.038262255815  554.7270783588783     359.9947248543858  0.0028686960910657405
 890.8576431575337  564.4910139563399    359.99371776586474  0.0032483115672433368
 971.7410107427238  581.0301273603288    359.99129032918023    0.00394460501697729
 769.8182651492822  587.3991534539016    359.99748044484795   0.003666592325947924
 815.4649708309157    621.70236297117     359.9961801265635   0.004829526225418064
 457.3069563867852  695.4839439228793  0.007299417401295441   0.006221092374688667
 663.7522305772287  727.5606487303378 0.0010956440902465164   0.007718343531580888
 956.3618123173031  732.7240339832271    359.99218701382824   0.008563603509703683
  762.012822991855  738.3493833972611     359.9981307363725   0.008284707812831934
 475.7809197718267  787.1175421157932  0.006972911155176817   0.009078806556077986
 820.4534971417371  846.8578899992237     359.9966476213018   0.011744457761829495
 775.2535830946825   852.768447668375    359.99803938143555   0.011819236104458666
 821.2496942034151  862.1639462053263     359.9966653732796   0.012214125952000665
 811.2868482580394  907.0113339507423     359.9970911975458   0.013560409281168691
 979.8333015194123  908.5670123070836    359.99196470996947   0.013994547909521428
 798.8612490361676   917.691370731965     359.9974981525205   0.013857233119648482
 757.3289724429274   919.148267240695    359.99876455354797    0.01380396414649375
 897.3875798865843  936.7583695764755    359.99455365921426   0.014667036969114682
 628.0267683752969  974.7373812387208 0.0028386713057134997   0.015187773153686161
 456.3574329732993  987.6670781265088  0.008076589320650552   0.015153509703638865

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -5.207227        3.470927 pass
      -3.050926        4.439231 pass
      -0.996357       -4.430599 pass
       0.939315        2.117388 pass
      11.707788        5.337136 pass
       7.149973        6.062934 pass
       0.553332       -5.238659 pass
       1.601453       -5.067627 pass
       1.697829       -5.631014 pass
      -1.281275       -9.563286 pass
      -4.963313        1.647943 pass
       3.280159       -0.696398 pass
       6.368050        6.503431 pass
       0.456395        2.835656 pass
       2.121554        1.834933 pass
       5.167542        4.385102 pass
      -1.183299        2.783353 pass
      -2.226832        4.449976 pass
      -4.049435        1.648257 pass
       0.479416       -0.175025 pass
       4.309084        2.687847 pass
      -2.888835        5.073412 pass
       1.185049       -5.021939 pass
       7.481744        4.282897 pass
       1.336729        5.707860 pass
      -2.097355      -14.067451 pass
      -3.550218       -8.627365 pass
      -1.495641       -4.193355 pass
       0.264942        3.178923 pass
      -1.044110       -1.627526 pass
       1.063166       -0.926363 pass
      -1.226829        3.733089 pass
      -3.144371       -8.905588 pass
      -0.949059       -4.651874 pass
       1.828050        2.373868 pass
       1.634658        5.294717 pass
      -0.842887       -2.478358 pass
      -2.052110        1.271771 pass
      -0.524211       -8.294072 pass
       0.194050       -1.635924 pass
       0.988922        8.337166 pass
      -0.438410        2.537539 pass
      -2.256193        4.053427 pass
       0.928302        5.870448 pass
       7.604687        1.557689 pass
       2.956177       10.089741 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_2.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_2.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.394609 10.827406 55.007805
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 608.5461714111817 2.5131153270429225  0.0008811535076687153   -0.014594743852346248
 685.5165542363047  5.522005289569982      359.9985263490218   -0.014309429398466314
 886.3377102041173  32.12032234845156     359.99243210897583   -0.012997421405947096
  953.858650908105 37.038714754591744     359.99037445698593   -0.012674313169426505
 444.4760693354769 61.921174725845646   0.006066872395400456   -0.013223584608591675
 708.5375051993097  73.05653065791925      359.9979904139565   -0.012224485327696166
 373.6920713251912  82.73362445593573   0.008291490212003361   -0.012772364504572807
 429.1710480615856   96.9361473590585  0.0066252915340002895   -0.012205382067991825
486.33656507950644  111.0929968883717   0.004907122116154008   -0.011634266764592633
 812.8169111357602 135.61175256667016      359.9949511037864   -0.010070911221503798
 550.2506815991629  143.0082980431957   0.003027367540328657   -0.010506347247348124
  856.666574138678 163.94025852158114     359.99367952721065   -0.009101828365468878
 943.4725862005791  165.1160847976937      359.9910202493613   -0.008847595467969826
379.36603019242443 175.61024962497083   0.008352922362656737   -0.009943329177441321
 390.9868475960879 182.23166489994372   0.008013379965691413   -0.009712585890208804
 464.7874252509071 193.62567333213758    0.00577907114864779   -0.009180140912869495
 706.4641169351513 205.44112744056818     359.99839593680207    -0.00821509388991974
 471.0128665836423 208.50627769129127   0.005626261725713367   -0.008710551901505456
 848.6275210111238 225.06047475891756      359.9940867921008   -0.007263151929571056
 717.2689344128596 238.78521514635145     359.99815195717895    -0.00717032006242251
 640.8223349387042  287.3876388648545  0.0006239692904470007   -0.005872559700757004
  696.649043669952  311.4598971472418      359.9989761683857   -0.004996162404240498
 534.5084442349707 350.37099693129943   0.004046577556716191    -0.00420410034973628
432.09618931856727  418.3419770115535    0.00735717883136822  -0.0023714315343018777
 665.3849005558758  444.0678377273824 0.00028665146587420707  -0.0009971980130367556
 704.8443491573435  454.5162471160152     359.99910711974667  -0.0005791581225037081
397.16046445276737 455.04418207058586   0.008519434584673621  -0.0013306377093679634
  670.369979887094 468.54191939872646 0.00019949283603036086 -0.00023163279961321113
 857.0397112859981  554.7274188893667     359.99472481101884    0.002868709976703097
 890.8578568837343  564.4940272892437      359.9937177677001   0.0032484046780216053
 971.7393022215407  581.0309188009905      359.9912903836618     0.00394462536976469
 769.8173270515161  587.4004878427158      359.9974804771503   0.0036666311271152862
  815.465578086775   621.703407654051     359.99618011089166    0.004829559764486471
457.30976496488194  695.4853021868445   0.007299335355773578    0.006221141229410244
 663.7519356998866  727.5614345432715   0.001095655178011445   0.0077183669280205805
 956.3618069104094  732.7218311115429       359.992187007799    0.008563535989006233
 762.0142852652106  738.3497994697638      359.9981306929402    0.008284724036588096
475.77984981811954  787.1204617950921   0.006972951205655511    0.009078893288449403
 820.4530900979327  846.8571043631532     359.99664763153703    0.011744432795549499
 775.2564955710666  852.7653273770777      359.9980392843252    0.011819147585457136
 821.2501449789805  862.1642779577346        359.99666536047     0.01221413713982896
 811.2847022881816  907.0118295127575     359.99709126416207    0.013560419393838364
 979.8325668501478   908.565764385858     359.99196472886814     0.01399450816804262
 798.8585276961667  917.6911602746128      359.9974982346854    0.013857220326868504
 757.3271158499823  919.1512240355106      359.9987646179659    0.013804049958067223
 897.3858508178394  936.7555527010198      359.9945537040557    0.014666947106948183
   628.02654407017  974.7375500319221  0.0028386785543619677    0.015187777746555775
 456.3583448650907  987.6657631916269   0.008076558329031239    0.015153471999927788

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -4.975323        3.779849 pass
      -2.755133        4.393177 pass
      -1.254723       -4.312847 pass
       1.049522        2.224555 pass
      12.056479        5.654166 pass
       7.045844        6.047775 pass
       0.643793       -5.153523 pass
       1.717741       -4.927942 pass
       1.564505       -5.895754 pass
      -1.241359       -9.479059 pass
      -4.926467        1.558064 pass
       3.424340       -0.384162 pass
       6.451563        6.653054 pass
       0.439618        2.639647 pass
       2.009985        1.699200 pass
       5.497958        4.217884 pass
      -1.157204        2.799888 pass
      -2.576429        4.131308 pass
      -4.059377        1.495409 pass
       0.431088       -0.569241 pass
       4.206189        3.015345 pass
      -2.649017        5.109818 pass
       1.381183       -4.948669 pass
       7.573631        3.919603 pass
       1.490243        5.452820 pass
      -2.392719      -13.891574 pass
      -3.571924       -8.870440 pass
      -1.520796       -3.961259 pass
       0.256135        3.092714 pass
      -0.976075       -1.770595 pass
       1.645149       -1.127410 pass
      -1.065399        3.409585 pass
      -3.200790       -8.784848 pass
      -1.105415       -4.593468 pass
       1.764763        2.287784 pass
       1.367876        5.090795 pass
      -0.836280       -2.143159 pass
      -1.825790        1.321921 pass
      -0.680332       -8.244084 pass
       0.392313       -1.517061 pass
       0.942213        8.813155 pass
      -0.279494        2.414961 pass
      -2.302308        4.093703 pass
       1.323145        5.949910 pass
       8.097701        1.456315 pass
       3.372487       10.461996 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_4.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_4.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.459499 10.829639 55.680965
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
  632.757520509536  43.52799873198921  0.0008804967979520648  -0.014626457969967293
 709.8257801184594 47.507856164720145     359.99852516247785  -0.014311550857858348
 910.5959218383333  74.15073580836673     359.99243330115337  -0.012997209251142885
 978.1734916601412  79.09634950402457     359.99037406382115  -0.012674008968996101
 468.7130887677887 103.70932107395348   0.006068286014852335   -0.01322360404683915
  732.790984782116 114.80235210425441     359.99799208670777  -0.012224549793193257
  397.984710427444 124.51324600589399   0.008291256163280063  -0.012770390494991906
453.48648150451567  138.5482319055374   0.006624203827780067  -0.012205946184055615
 510.5826324979371 152.64448533976542   0.004908405341258196  -0.011634774691144639
 837.2149603482594  177.1785834572367      359.9949499615408  -0.010070545641559236
 574.5481104859573 184.43873533137992   0.003027600457347842  -0.010506876620650508
 881.0720770864376  205.4811392291359     359.99367911021494   -0.00910047240755286
 967.9227669585642 206.66121780659034     359.99101887212703   -0.00884787365368245
 403.5962440387207   216.998785601212   0.008354373151629148   -0.00994252422160558
 415.2777583527195 223.52829021424284   0.008012874091052141  -0.009713721429904707
 489.0920184154513 234.93882953827853   0.005778885460870573  -0.009179436773304156
 730.7977037082132 246.70779432945926     359.99839704252184  -0.008216395799283889
495.33441450714344 249.70017562299645   0.005625489983602337  -0.008712222746655486
 873.0776664428001 266.42458939825514      359.9940861819049   -0.00726229994756828
 741.6867097679047  279.9382786626609     359.99815100970363  -0.007172803098400693
380.14033396361117  301.2436539679342   0.009287748779498183  -0.007423548358097951
 665.2235848015512  328.5104074590912  0.0006236098759626848  -0.005872363696826033
 721.1009889243013 352.48437128381073     359.99897510732956  -0.004998591785375306
 558.8356054855649  391.3900339558093   0.004047855226464509  -0.004203748397144104
456.46867164126957  459.2609164373239  0.0073561127832601925  -0.002371745888469407
 689.8327353648502 485.06169266959915 0.00028755014973561054 -0.0009973537094344351
 729.3781725739266  495.5207376473076      359.9991061775121 -0.0005793868444065472
 421.5313298328499  495.9474141851409    0.00851819173856682 -0.0013308055493282981
 694.8390061976295  509.5305205319393 0.00020019156541582563 -0.0002319329312739653
14.081606885276077  557.2166447486212   0.021107528702098505 -0.0005205285248208323
 881.6543299915564  595.8568645041335      359.9947254230886  0.0028688929381400895
 915.4735869466531  605.5705900525442      359.9937187373024  0.0032461369049492667
 996.4781613563033  622.2440029897667      359.9912890038844   0.003944930128583014
 794.4678033778682  628.5049053250357     359.99747921198633   0.003667173736498765
  840.081104132367  662.8420150991536      359.9961810901739  0.0048294298273538795
 481.7458734746978  736.5408482211899   0.007300242502125687   0.006221561579575905
 688.4363469452317  768.8245040889547  0.0010937407243143905    0.00772151655478467
 981.1057496757138  774.1328899034736     359.99218742384153    0.00856640104398379
 786.7033611257062  779.6094428435799     359.99813025456774   0.008285777187910513
 500.3213435066071  828.2875623678548   0.006972292739396447   0.009079392487024846
 845.1395260116918  888.2486429009447      359.9966490980914   0.011744618340666048
 799.9582256550444  894.1529473093893      359.9980397938047   0.011819651703137203
  845.956261130645  903.5178548940592     359.99666619433395   0.012212638460852125
 835.9945894894588  948.4929444611175     359.99709237310265   0.013561331318791536
1004.5948488048369  950.0992666738197      359.9919654017713   0.013995388320326398
 823.5753939434358  959.1642392517674      359.9974990166614   0.013857674611357278
 782.0375957577447  960.5590014045085     359.99876499345754   0.013802953255150834
 922.1356667374224  978.2850292332223      359.9945543794388   0.014667538039234738
 652.6937363556877 1016.2119840128314  0.0028391970295941005   0.015188260679953809

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -3.623553       -0.168281 pass
       0.059981        6.028601 pass
       1.980539       -4.873354 pass
      -2.866220        0.193737 pass
       7.784920       -1.983088 pass
       3.634933       -2.891154 pass
      -3.193980       -6.285198 pass
      -2.836849       -2.974549 pass
      -2.909741       -6.499978 pass
      -8.133392        1.859597 pass
       0.353129        2.226026 pass
       1.053862        1.412953 pass
       4.254858        9.720189 pass
       5.059229        0.811112 pass
       3.996774        9.099333 pass
       0.709307        4.538448 pass
      -0.742303        5.946131 pass
       1.029653        1.425431 pass
      -2.960956       -1.392640 pass
       0.386387       -5.730427 pass
      -0.904394       -1.974089 pass
       1.343169        8.392748 pass
      -3.586016       -3.851537 pass
       3.461547        5.235690 pass
       7.512148        5.220745 pass
       0.873008      -12.378314 pass
      -2.074170        1.443758 pass
       3.078815       -2.694230 pass
      -0.412341        5.627616 pass
       1.446377        1.397953 pass
       0.229756       -0.032288 pass
       1.365980        5.536941 pass
       0.324626       -9.252622 pass
      -2.683556       -0.802124 pass
       0.922188        9.394218 pass
      -0.453272        1.002852 pass
       2.654289      -10.307142 pass
       0.689635        0.241447 pass
       1.523119       -7.585423 pass
       4.684152       -0.753304 pass
       8.988473       -1.648692 pass
      -1.836059        2.798112 pass
       4.943346        5.312802 pass
       0.699602       -1.301541 pass
       2.161646        4.044166 pass
       3.139657        0.454847 pass
       7.353079        5.775123 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_6.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_6.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.461396 10.8295555 55.684906
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 632.7561014527342  43.52872182023289  0.0008805421841502914   -0.014626439834395417
 709.8260670657803   47.5058809583951     359.99852514867274   -0.014311609453108201
 910.5951520227544  74.15262735916836     359.99243332955854   -0.012997154434847552
 978.1739871993807   79.0963228230719     359.99037404856495   -0.012674008483594294
468.71224848996206 103.70989382247947   0.006068313256945353   -0.013223588820502662
 732.7915923131342 114.80647731539594     359.99799207867466   -0.012224423456660083
397.98413357499743 124.51335799099897   0.008291274143771397   -0.012770388542114123
  453.486222463101  138.5458169269537   0.006624205620663413   -0.012206020133662565
510.58256909558963  152.6453203832899   0.004908409425163492   -0.011634749468877803
 837.2169099602804 177.17912292467238      359.9949499031466   -0.010070524367891584
 574.5467924282938 184.53495588155457  0.0030278892909903717   -0.010503947947691706
  881.072757297264 205.48539115095912      359.9936791005724   -0.009100341356131934
  967.924538456573 206.66197471295982       359.991018819812    -0.00884784623803236
403.59519404561934 216.99772079775687    0.00835440263089767   -0.009942559373896534
415.27622730365823 223.52761937893004   0.008012919319993475   -0.009713745774778241
 489.0946428106659 234.93889167070938   0.005778805149752866   -0.009179428285502186
 730.7995005378147 246.70662956366752     359.99839698434306   -0.008216426945869442
495.33518932760904  249.7024097932946      0.005625471984489   -0.008712152430070601
 873.0774447239464 266.42532686273233      359.9940861906751   -0.007262277967259131
 741.6859285461186 279.93870052952946     359.99815103477613   -0.007172792110716809
 380.1370486212538  301.2438407112605   0.009287849891110325   -0.007423550962244108
 665.2269225901222 328.50792691218294  0.0006235010275023399   -0.005872431596713497
 721.1001264694142  352.4851006313926      359.9989751357025   -0.004998571502228098
 558.8372234547588 391.38558179923365  0.0040477940412439895   -0.004203881330246453
456.46151568364206 459.25963414936314  0.0073563282770390155  -0.0023718034928518613
 689.8318563457915 485.05914533128765 0.00028757019837587086  -0.0009974342669445198
 729.3758901700103 495.52228213954953     359.99910625149573   -0.000579344832615903
 421.5314421564851  495.9455044748265    0.00851818341899201   -0.001330864069702006
  694.837657200127  509.5318564734783 0.00020023640497505223 -0.00023189508643074546
14.081803113089986  557.2159960609778   0.021107521175067694   -0.000520547899563331
 881.6523091352415  595.8547570266802       359.994725479002   0.0028688234541196776
 915.4741065868286  605.5711695752242      359.9937187230363    0.003246155913113313
 996.4784351276294  622.2423567819199      359.9912889908665    0.003944880235320652
  794.469839790824  628.5055976724658      359.9974791517016    0.003667199836169508
 840.0786466311152  662.8404021273825     359.99618116074055    0.004829374543359347
481.74592656195796  736.5414197031473   0.007300242361110165    0.006221579246730632
 688.4356820369527  768.8238940960294  0.0010937593293049244    0.007721496260231114
 981.1089672696557  774.1361073647035      359.9921873347029    0.008566506832542512
 786.7045617896734   779.611802202087     359.99813022444624    0.008285852281610964
500.32197626807886  828.2892825101978   0.006972277957364353    0.009079446707737027
 845.1369459333854   888.244390359914      359.9966491649181    0.011744482514498526
 799.9586443996288  894.1555172153749     359.99803978807853    0.011819731140030567
 845.9561015097216  903.5187293444774      359.9966662015916    0.012212664779821414
 835.9932678302781  948.4906491194473      359.9970924070118    0.013561258281447422
1004.5949500781727  950.1001812322297      359.9919654012403    0.013995416431897886
 823.5785927457607  959.1670105496879      359.9974989269903     0.01385776651294443
 782.0375591951885  960.5596213741295     359.99876499624685    0.013802972059644389
 922.1365503429363  978.2855175769723      359.9945543539023    0.014667554933993935
 652.6933028870272 1016.2125890007942  0.0028392117697740244    0.015188278029826733

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -3.613511       -0.100585 pass
      -0.262835        6.359447 pass
       2.052714       -5.163361 pass
      -2.859766       -0.072481 pass
       7.735222       -2.194031 pass
       3.725194       -2.851599 pass
      -2.418203       -6.492574 pass
      -3.053874       -2.880590 pass
      -2.939692       -6.710651 pass
      -8.066415        1.786537 pass
       0.593705        1.737052 pass
       1.000647        1.608148 pass
       4.286430        9.799318 pass
       5.073931        0.901912 pass
       3.962061        9.571118 pass
       0.762371        4.600907 pass
      -0.762917        6.232104 pass
       1.127725        1.480246 pass
      -2.694615       -1.241397 pass
       0.488529       -5.657408 pass
      -0.540392       -1.983464 pass
       1.465242        8.129813 pass
      -3.632881       -4.031153 pass
       3.251328        5.312276 pass
       7.483229        5.675556 pass
       0.872500      -12.314712 pass
      -2.395069        1.824597 pass
       2.858548       -3.172789 pass
      -0.701461        5.658172 pass
       1.444465        1.499155 pass
       0.174834       -0.030541 pass
       1.274048        5.597762 pass
       0.578666       -9.451644 pass
      -2.791994       -0.531786 pass
       0.986918        9.401248 pass
      -0.290448        0.915211 pass
       2.602931      -10.238713 pass
       0.851058        0.377689 pass
       1.724407       -7.835565 pass
       4.786411       -0.555965 pass
       9.151863       -1.583404 pass
      -1.900856        3.051252 pass
       5.049471        5.186254 pass
       0.725730       -1.206793 pass
       3.201448       14.587388 pass
       2.951323        0.553543 pass
       7.143635        5.662995 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_8.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_8.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.166319 10.819193 52.431835
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 646.9460364189496 123.58824806720995  0.0008803409666353219    -0.01462544759401453
 724.0252320146072  127.5820452764259      359.9985251448545      -0.014310524077353
 924.8606761687124 154.24326052907645      359.9924329361845   -0.012996383566727537
   992.45691902968 159.27374467532363     359.99037339685844   -0.012673064323221303
482.87053476521277 183.28959656865936   0.006068231603246421   -0.013222390879844007
 747.0589422960411 194.39222695244513      359.9979919488258   -0.012223096373398978
412.11218706689084 203.90829274053294   0.008291045403339596   -0.012771385160995604
467.56583952342805 217.90372011464456    0.00662635936109802    -0.01220484372594049
 524.7770858845939 231.89311550157834  0.0049079203445831455   -0.011633826109081785
 851.5364944961776  256.5001400819646     359.99495137802734   -0.010069281024660396
  588.705062769309 263.51085726272504  0.0030296502371099806   -0.010506455620478956
 895.4584259369747 284.53409875070355     359.99367964554193     -0.0091047589609821
 982.4255461949168  285.9202146860721     359.99101719217686   -0.008849400351720169
 417.7174017858739 295.82945696890056   0.008353917643836436   -0.009945222372284788
 429.4042633190108  302.3938491302124   0.008012662027330593   -0.009714355847956803
 503.2698996261898 313.66457227896325      0.005778574588179   -0.009182449351832687
 745.2283576279594  325.5350018038381     359.99839492246144   -0.008217355359381432
509.53867989539395 328.42412505899017   0.005624735426441953   -0.008713537241315246
 887.5443812545439  345.2641690333635      359.9940862878344      -0.007265244786619
 756.1049685736115 358.67865141799314      359.9981503199985    -0.00717342350491229
394.23291927272953 379.85017585787546   0.009287587812766219    -0.00742439167826378
 679.5634066559268  407.0596025804446  0.0006242027742464089   -0.005873736972104611
 735.4844061261805  431.0996831560591     359.99897662127745  -0.0049976416161509035
 573.1313058171473 469.80286113326713   0.004047329109084021   -0.004205179593319682
 470.5890419719976  537.6340474457602   0.007357930444448098    -0.00237327401915634
  704.327058625501  563.4788329832742 0.00028666582563447254  -0.0009992064146646443
 435.6105785039881  574.3863481872331   0.008520331771738035  -0.0013305748801799543
  743.874891664683  573.9747828254133      359.9991067931344  -0.0005809777008637135
 709.3557006099318  587.9666594324468  0.0001991739613351785 -0.00023358941671565873
27.531278375167513  635.8512293053622   0.021115014317358988  -0.0005216216890524824
 896.4408422838092  674.4980277163539     359.99472377077933   0.0028676799548390266
 930.3046944886573   684.334662079809      359.9937171097069   0.0032476367453057745
1011.3109434871345  701.0321927252717     359.99128955084143    0.003944579315404069
  809.095857702636  707.1484044619239     359.99747998772455   0.0036660735530476296
 854.7864857555858  741.5832025222157     359.99618146318284   0.0048288846011218705
  496.042646678495   815.501330316961    0.00730043085322982    0.006226567438309456
  702.974834779573  847.7555655541388  0.0010946992939119733    0.007721763324996789
 995.9743233516383  853.1699976082482      359.9921875269867    0.008566666045003165
 801.4327560408036  858.5945248989527      359.9981289789841    0.008286199706369223
 514.6244381546285  907.3352544164048   0.006973482959273866    0.009079930104721341
 859.8694947178157  967.5204508513665     359.99664969864597    0.011745747050078564
 814.6347535333018  973.4206873951758     359.99804066679786    0.011820395007652196
 860.6853482064994  982.8172971910304      359.9966667541225     0.01221360129934576

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.203028      -11.543093 pass
       4.893700        4.162587 pass
       7.721476        1.713322 pass
       1.151995       -5.124618 pass
       3.349600      -11.786469 pass
      -0.044192       -6.935209 pass
       4.794378       -5.669569 pass
      -4.682542        2.747970 pass
       2.515126        6.289380 pass
       5.338653        3.348377 pass
       4.636204       -0.881232 pass
       3.313240        4.226007 pass
       5.923951       -6.332260 pass
       2.400472        8.622028 pass
       0.833772        5.792833 pass
      -0.744716       -7.119723 pass
       5.836599       -2.309818 pass
      -1.483874       -5.010042 pass
      -1.616971       -5.114465 pass
       8.560898        9.788311 pass
       7.015773       10.453056 pass
       1.551072        5.642778 pass
      -1.702848        2.397762 pass
       1.184793       -7.846536 pass
      -1.531483       -5.217667 pass
      -2.171310        3.368436 pass
       1.667458      -11.215436 pass
      -7.275657        0.718943 pass
       0.163452        5.813420 pass
      -1.216702       -1.281053 pass
      -3.205055       -4.907717 pass
      -2.973739       -5.721900 pass
      -4.425194      -11.952163 pass
       3.370264        2.219160 pass
       8.427480        1.988662 pass
      -4.552465       -1.934069 pass
       3.303518       -4.400540 pass
       2.714841        2.164678 pass
       9.540854        5.559766 pass
      -2.908163       -5.041266 pass
      -0.279139        2.320706 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_10.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_10.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.167205 10.820021 52.420555
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
 646.9454800415763 123.59122321380107  0.0008803656879164385  -0.014625358834867506
 724.0256726768248 127.58013796160934      359.9985251264132   -0.01431058074881553
 924.8597080043684  154.2432706124099     359.99243296590157  -0.012996385708730001
 992.4534255006282  159.2718625921307      359.9903734990552  -0.012673130090554478
 482.8696673425391  183.2899835191299   0.006068259202637669  -0.013222381265036554
 747.0578849106864 194.39226082259032      359.9979919813537  -0.012223097981552028
 412.1139269048188 203.90945048821695    0.00829099500464183  -0.012771345469780142
467.56675428766414  217.9036290726527  0.0066263310760417415   -0.01220484420928609
 524.7779965210373 231.88761492892587   0.004907878219448835  -0.011633991987964873
 851.5351015628255 256.50133330428804      359.9949514239217  -0.010069248022576957
 588.7056787681511 263.50878787844727   0.003029625957239504   -0.01050651745401577
 895.4613105651895 284.53301855679746      359.9936795541991  -0.009104784903560181
 982.4265095675484  285.9188137972235     359.99101715886314  -0.008849440744045681
417.71543674308754  295.8303503510455   0.008353980132200288   -0.00994519994298999
 429.4043006594748   302.391294319142   0.008012654340806747  -0.009714434124611955
 503.2701695686526   313.660954522638   0.005778556956879143  -0.009182559722200206
  745.227175719965 325.53650613651814     359.99839496270187  -0.008217312112789378
 509.5395129140925  328.4264116852812   0.005624715832518511  -0.008713464923489102
 887.5432061951202  345.2660055868902      359.9940863288323  -0.007265191349839529
 756.1041842849181  358.6800425484636      359.9981503477614  -0.007173382702703706
394.23237537998807 379.85139546326104   0.009287607567243169  -0.007424355561664159
 679.5646720105382  407.0614691793956  0.0006241690117001846 -0.0058736764496161555
 735.4846227401789  431.0987984975643     359.99897661226294  -0.004997668302282632
 573.1327307968371  469.8028377674046   0.004047285469453377  -0.004205176771126612
 470.5899109886719   537.634139560142   0.007357904143361665 -0.0023732689841836083
 704.3299938731695  563.4795835368527 0.00028657817169840187 -0.0009991762174390486
 435.6099546323682  574.3867880651862   0.008520351938341926 -0.0013305629301788556
  743.876859351675  573.9722780891316     359.99910672620973  -0.000581050034878793
  709.353752512589  587.9671313943018 0.00019923473444689437 -0.0002335795982129045
27.528381239185606   635.852642005663   0.021115105964276147 -0.0005215862798103629
 896.4397012609306  674.5007838620852      359.9947238133093   0.002867761902645875
 930.3064781430503   684.334060840617      359.9937170535473   0.003247622400811566
1011.3112434924527  701.0314437239015     359.99128953955324   0.003944557036107322
 809.0957248208425  707.1478396927572     359.99747999022435   0.003666055911212994
 854.7882520124947  741.5815247429309     359.99618140466794   0.004828837272518164
 496.0419398685006  815.5016620469418   0.007300453193028751  0.0062265758102119555
 702.9741875563504  847.7562918805631  0.0010947209288824965   0.007721783980913229
 995.9721439659877  853.1689695028363     359.99218759056447   0.008566629720873442
 801.4316652320226  858.5921814993368      359.9981290057719   0.008286125536795407
 514.6267263594901  907.3369596675094    0.00697341792737487   0.009079987884410582
 859.8707171877863  967.5196606903338     359.99664965931487   0.011745725802043364
 814.6354876594828  973.4205911145488     359.99804064422983   0.011820393789056067
 860.6851506594377  982.8162979189045     359.99666675739485   0.012213570408960222

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.518582      -11.434383 pass
       4.791874        4.160847 pass
       7.655088        1.509304 pass
       1.251941       -4.977730 pass
       3.254916      -11.768343 pass
      -0.035192       -6.998720 pass
       4.866978       -5.626549 pass
      -4.604656        2.822331 pass
       2.373534        6.212887 pass
       5.104539        3.556384 pass
       4.783796       -0.688859 pass
       3.161590        3.628843 pass
       5.595117       -6.425653 pass
       2.319227        8.617641 pass
       0.933129        5.827446 pass
      -0.985645       -7.380126 pass
       5.804147       -2.405888 pass
      -1.412758       -4.880022 pass
      -1.657608       -5.194670 pass
       8.726118        9.907119 pass
       7.132873       10.447266 pass
       1.631495        5.672917 pass
      -1.473968        2.266995 pass
       1.027690       -7.836376 pass
      -1.594955       -5.615000 pass
      -1.803401        3.131674 pass
       1.456805      -11.385819 pass
      -7.179221        0.451932 pass
      -0.017983        5.956309 pass
      -1.244373       -1.562849 pass
      -3.407230       -4.959357 pass
      -2.754956       -5.686554 pass
      -4.272087      -11.657150 pass
       3.477246        2.211449 pass
       8.516476        2.308194 pass
      -4.623003       -1.673725 pass
       3.528476       -4.319795 pass
       2.726621        2.053472 pass
       9.453446        5.337166 pass
      -3.028093       -5.186679 pass
      -0.134273        2.476394 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_12.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_12.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.14942 10.819677 52.3238
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 695.2882988999536 103.10651467532003  0.0008800008772832899   -0.014624813910079982
 772.3744183009295  107.0815682195305      359.9985245931245   -0.014309869787115948
  973.228381685913 133.63302595063803     359.99243224223216   -0.012997673379714877
 531.2457880501139 162.90678044840305   0.006067753827247839   -0.013222863142923662
 795.4098654036351 173.99541287004112      359.9979911433319   -0.012223925183360086
  460.547711377863  183.5249036196875   0.008289441834595316   -0.012772358696295038
 515.9706963233565 197.55498823067623   0.006625409028767752   -0.012205661433268716
 573.1045796641623 211.60813499707166   0.004909149394200925    -0.01163371221201762
 899.8933788590772 236.19645940742822      359.9949503013732   -0.010070332329877986
 637.0838241772371 243.32047754138887    0.00302930239325246   -0.010504872055279972
 943.8044405646633 264.45023347848417      359.9936793323863   -0.009100426256506654
466.16761385963326  275.6415362787146   0.008353364238678336    -0.00994304344948607
 477.7998425311254 282.12836328156897   0.008013547610210205   -0.009714975271219643
 551.6424228064568  293.5141692246144   0.005779824893848046   -0.009180675245526442
 793.5362941129501  305.3737976889193     359.99839615145964   -0.008218045255784857
 557.9115612743607  308.2309333789397   0.005626000043587533   -0.008713509112374706
   935.89818015132  325.1387934464577      359.9940855059957    -0.00726544155060442
 804.4990143921109  338.5651047740593      359.9981491833879  -0.0071737216779422215
 442.6930855595648  359.6109073627168   0.009288286507927042   -0.007424822264389844
 727.9952424701189 386.98027318926063  0.0006232392478226067   -0.005873735036980789
 783.9187945939353 411.06018073336685      359.9989753985937    -0.00499750078331377
 621.5759401883365  449.7014536319138    0.00404829003612404   -0.004205284148308415
 519.1902540839886  517.5298630654247   0.007357057943188697   -0.002371136402893473
 752.7897384965033   543.479054423098 0.00028734675743388586  -0.0009989984751563358
484.25480678313863   554.161793091394   0.008519257795758167   -0.001330984310451842
 792.3715451848047  553.9949623101498      359.9991060833142  -0.0005807988134908488
 757.8281459003109  567.9717563455148 0.00019999925135859084  -0.0002333580126112227
396.18338983138534  604.5780857775677    0.01133613097965103 -3.5146940737205506e-06
 76.35854360332827  615.2713546165651   0.021113604528003087  -0.0005212509629759039
 944.8620518533836  654.6300422676247      359.9947249668796   0.0028684712215900337
 978.7199582266016  664.4764120134141      359.9937180442408     0.00324823477261302
 857.5978321036471  687.1863850362278      359.9974808060295   0.0036657619234262495
 903.3383272720531  721.6639082807033     359.99618069821037    0.004829340458761752
  544.822969770774  795.1767613387013   0.007300501536278909     0.00622535560971207
 751.6593136994991  827.6341518190358  0.0010951813293202872   0.0077212194450194584
 850.0297444326784  838.5511439029677     359.99813041047923    0.008285502452127409
 563.5070365304637  886.9914021805405   0.006972577193303109    0.009079660723682728
 908.5174896745665  947.4667033713542     359.99665071218845     0.01174530799753924
 863.3821582485261    953.31539644542     359.99803984272904    0.011819834480523251
 909.4201911354062  962.7615722742491      359.9966654557789    0.012213561507437893
 899.4889080888873 1007.7029930107033      359.9970911156624    0.013559580759199472
 845.5160643327326 1019.3354165427019      359.9987631926184      0.0137889507124076
 887.0452334515168 1018.3645917674779      359.9974986040853    0.013855459901527773

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.425293       -1.944355 pass
       1.248327      -10.794511 pass
       1.472504        1.218840 pass
       5.735248        4.068766 pass
      -2.939804       -6.198041 pass
       0.208595       -4.091050 pass
       2.901706       -8.057076 pass
       0.928065       -7.143518 pass
      -2.947214        0.790002 pass
       6.163878        4.708791 pass
       2.077896        2.378605 pass
       1.821585       -1.589582 pass
       7.737819        4.636037 pass
       4.796591        9.265477 pass
      -0.566175        6.604130 pass
      -0.886222        4.092685 pass
      -3.300069       -6.475729 pass
       1.434937       -1.802820 pass
       1.031429       -6.560152 pass
      -3.183615        2.090733 pass
       4.684943        6.003612 pass
       4.115995        7.469340 pass
       1.805531        1.280195 pass
       4.644130       -8.222934 pass
       2.969618        1.169116 pass
      -1.086443       -9.574348 pass
      -2.122275       -1.791172 pass
      -5.609395        2.308693 pass
       1.971397       -3.510976 pass
       0.159267       -2.754819 pass
      -0.002695       -4.888845 pass
      -0.119234       -9.103602 pass
       0.872036       -2.424167 pass
       7.203158        4.269924 pass
       0.000157       -1.832805 pass
       1.311259        3.443582 pass
      -1.959196        2.021427 pass
       8.288616       11.260601 pass
       4.145255       -0.162921 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_14.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_14.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.148314 10.819933 52.31703
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
   695.28794170584 103.10641319490699  0.0008800115795231863   -0.01462481787900968
 772.3731936505352 107.08007937646431      359.9985246268782  -0.014309917872403828
 973.2281832908834  133.6348268676595       359.992432252969  -0.012997619538201288
 531.2461240972619 162.90616024026545   0.006067741924447004  -0.013222881168460607
 795.4082883628598  173.9964145346605     359.99799119432987   -0.01222389869223297
 460.5482539991836 183.52565213354322   0.008289427105149128  -0.012772334529918135
  515.971022928771 197.55386309448286   0.006625396116303293  -0.012205694933804823
 573.1055169320389  211.6075876893692  0.0049091192277255415  -0.011633726576394846
 899.8952017510751 236.19527724644132     359.99495024232874  -0.010070363843153046
  637.082904882704 243.32193769850684   0.003029334402767267   -0.01050482968984714
 943.7992653146599  264.4489310792786     359.99367948756526  -0.009100478721790392
 466.1660535560782   275.640950154766   0.008353410553245011  -0.009943065336091812
477.79796528347913  282.1275102677306   0.008013602946853783  -0.009715006139339866
 551.6441749526855  293.5150245290313   0.005779773415525509  -0.009180644632308558
 793.5314353855134 305.37140487562107      359.9983962940064   -0.00821813048577351
 557.9109575174925 308.23135130802393   0.005626019634737101  -0.008713497795483575
 935.8973036748098 325.14009061951293      359.9940855363827  -0.007265403985229679
 804.4988427398484 338.56293884484654      359.9981491828204  -0.007173788531946998
 442.6927137354523  359.6114345294081   0.009288299245937747  -0.007424807000506554
 727.9943724390052  386.9821714885887  0.0006232709857077299  -0.005873678813221203
 783.9162233378428  411.0579407438311      359.9989754712712  -0.004997575863914036
 621.5767698477409 449.70199238928535   0.004048266080364153  -0.004205265514444473
 519.1911503353462  517.5358092205225  0.0073570460586275645 -0.0023709510343529468
 752.7880780342024  543.4801203561428  0.0002874004121121975  -0.000998969663921725
484.25376556038856  554.1619772165304    0.00851929006313443 -0.0013309812693040395
 792.3751873690417  553.9946415511126      359.9991059710994 -0.0005808000012685225
 757.8304438957533  567.9695819856329 0.00019992310895048133 -0.0002334194004333699
396.18468311561935  604.5807611777432   0.011336098337038783 -3.429058731243893e-06
 76.35814999540862  615.2723711714851    0.02111361895637598 -0.0005212208222102637
 944.8635640932658  654.6310144514106     359.99472492340107  0.0028685045368420587
 978.7205619653042  664.4790452486839     359.99371803321566   0.003248316935449173
 857.5958244646582  687.1827860653182      359.9974808573291  0.0036656467929251264
 903.3399724466342  721.6604165017714     359.99618063825375   0.004829237186174471
 544.8233340592824  795.1777717322748   0.007300493096006179   0.006225387462063048
 751.6584803677636  827.6363909001989  0.0010952127669043958   0.007721285965960717
 850.0294380306964    838.55150947549      359.9981304208188   0.008285512920257644
 563.5067284206251  886.9918823123108   0.006972587803690846    0.00907967462159978
 908.5206742421236  947.4677816020749      359.9966506182584    0.01174534815537037
 863.3827492499984  953.3136639288376     359.99803982000446   0.011819783039594491
 909.4171471081825  962.7581389765916     359.99666553892456   0.012213449914027643
 899.4888297651883 1007.7051953534469     359.99709112408334   0.013559647619545423
 845.5162351428138 1019.3362542119728     359.99876318970763   0.013788976596931363
  887.044887942196 1018.3648827073387       359.997498615383    0.01385546795957044

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.384621       -1.915346 pass
       1.441484      -10.690790 pass
       1.426019        1.098238 pass
       5.856762        3.895659 pass
      -2.941847       -6.438715 pass
       0.165811       -3.423724 pass
       3.086385       -8.471545 pass
       1.044227       -7.132569 pass
      -2.834039        1.029477 pass
       5.825730        4.853359 pass
       2.116093        2.428638 pass
       1.930978       -1.454347 pass
       7.629220        4.584325 pass
       5.355235        9.076602 pass
      -0.647984        6.418943 pass
      -0.929072        4.027794 pass
      -3.704042       -6.480005 pass
       1.696576       -2.073110 pass
       1.077285       -6.505202 pass
      -3.153300        2.331430 pass
       4.472383        5.890165 pass
       4.299587        7.564708 pass
       1.775146        1.394863 pass
       4.557889       -8.155852 pass
       2.784296        1.279324 pass
      -1.302286       -9.946130 pass
      -2.085052       -1.753487 pass
      -5.662421        2.395692 pass
       2.170609       -3.622102 pass
       0.119576       -2.459032 pass
      -0.276808       -5.109842 pass
      -0.275756       -8.983667 pass
       0.910688       -2.230338 pass
       7.241686        4.255636 pass
       0.070685       -1.792064 pass
       1.477992        3.364790 pass
      -1.659872        1.619690 pass
       8.403850       11.413117 pass
       4.658423       -0.469749 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_16_16.png" src="../../../_images/exec_jwst_tweakreg_miri_test_16_16.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.1037660880047775 0.9281835036028911 3.549202125823858
Dec difference mean, median and std (units in mas) -0.06135758681286737 1.0161649008182116 5.550928948928192
</pre></div>
</div>
</div>
</div>
<section id="run-the-images-through-calwebb-image3-with-tweakreg-on">
<h3>Run the images through calwebb_image3 with tweakreg on<a class="headerlink" href="#run-the-images-through-calwebb-image3-with-tweakreg-on" title="Permalink to this headline">#</a></h3>
<p>Alter any parameters needed to get better results from tweakreg. Look at individual i2d images afterwards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># use asn_from_list to create association table</span>

<span class="c1">#calfiles = glob.glob(&#39;starfield*_cal.fits&#39;)</span>
<span class="n">asn</span> <span class="o">=</span> <span class="n">asn_from_list</span><span class="o">.</span><span class="n">asn_from_list</span><span class="p">(</span><span class="n">imagelist</span><span class="p">,</span> <span class="n">rule</span><span class="o">=</span><span class="n">DMS_Level3_Base</span><span class="p">,</span> <span class="n">product_name</span><span class="o">=</span><span class="s1">&#39;starfield_50star4ptdither_combined.fits&#39;</span><span class="p">)</span>

<span class="c1"># use this if you need to add non&#39;science&#39; exposure types</span>
<span class="c1">#asn[&#39;products&#39;][0][&#39;members&#39;][1][&#39;exptype&#39;] = &#39;background&#39;</span>
<span class="c1">#asn[&#39;products&#39;][0][&#39;members&#39;][2][&#39;exptype&#39;] = &#39;sourcecat&#39;</span>

<span class="c1"># dump association table to a .json file for use in image3</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_asnfile.json&#39;</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fp</span><span class="p">:</span>
    <span class="n">fp</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">asn</span><span class="o">.</span><span class="n">dump</span><span class="p">()[</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">asn</span><span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>jwnoprogram-a3001_none_010_asn with 1 products
Rule=DMS_Level3_Base
No constraints
Products:
	starfield_50star4ptdither_combined.fits with 8 members
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image3 on the association table with tweakreg on</span>
    
<span class="c1"># set any specific parameters</span>
<span class="c1"># tweakreg parameters to allow data to run</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mf">3.318</span> <span class="c1">#3.27  # Gaussian kernel FWHM of objects expected, default=2.5</span>
<span class="n">minobj</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># minimum number of objects needed to match positions for a good fit, default=15</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1"># signal to noise threshold, default=5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># clipping limit, in sigma units, used when performing fit, default=3</span>
<span class="n">fit_geom</span> <span class="o">=</span><span class="s1">&#39;rshift&#39;</span> <span class="c1"># ftype of affine transformation to be considered when fitting catalogs, default=&#39;general&#39;</span>
<span class="n">use2dhist</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># boolean indicating whether to use 2D histogram to find initial offset, default=True</span>
   
<span class="n">pipe3</span><span class="o">=</span><span class="n">Image3Pipeline</span><span class="p">()</span>    
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">kernel_fwhm</span> <span class="o">=</span> <span class="n">fwhm</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">snr_threshold</span> <span class="o">=</span> <span class="n">snr</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">minobj</span> <span class="o">=</span> <span class="n">minobj</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">fitgeometry</span> <span class="o">=</span> <span class="n">fit_geom</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">use2dhist</span> <span class="o">=</span> <span class="n">use2dhist</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">save_catalogs</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe3.tweakreg.skip = True        # test to see if this affects the final output</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">outlier_detection</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># this is set in later step so mis-alignments aren&#39;t &#39;hidden&#39;</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">outlier_detection</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe3.output_dir = datadir</span>

<span class="c1"># run Image3</span>

<span class="c1">#im = pipe3.run(rtdata.input)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipe3</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_asnfile.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image 3 pipeline finished.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,219 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,221 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,223 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,225 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,227 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,229 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,231 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,408 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;starfield_50star4ptdither_asnfile.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,415 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;steps&#39;: {&#39;assign_mtwcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;assign_mtwcs&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;}, &#39;tweakreg&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: True, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 3.318, &#39;snr_threshold&#39;: 40, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: False, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}, &#39;skymatch&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}, &#39;outlier_detection&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: None, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}, &#39;source_catalog&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,559 - stpipe.Image3Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39; reftypes = [&#39;abvegaoffset&#39;, &#39;apcorr&#39;, &#39;drizpars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,574 - stpipe.Image3Pipeline - INFO - Prefetch for ABVEGAOFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,576 - stpipe.Image3Pipeline - INFO - Prefetch for APCORR reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,578 - stpipe.Image3Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:04,580 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:05,784 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:05,787 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: True, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 3.318, &#39;snr_threshold&#39;: 40, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: False, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,045 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 48 sources in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,051 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,319 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 48 sources in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,323 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,599 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 49 sources in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,604 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,890 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 48 sources in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:06,895 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,158 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 42 sources in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,162 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,429 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 42 sources in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,434 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,699 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 43 sources in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,704 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,946 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 42 sources in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,950 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,974 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,975 - stpipe.Image3Pipeline.tweakreg - INFO - Number of image groups to be aligned: 8.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:07,977 - stpipe.Image3Pipeline.tweakreg - INFO - Image groups:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,002 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,003 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,039 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,040 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,093 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,094 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,147 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,149 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,204 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,205 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,260 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,261 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,315 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,316 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,362 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,363 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,364 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,365 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,366 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() started on 2022-07-07 08:25:08.365356
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,367 - stpipe.Image3Pipeline.tweakreg - INFO -       Version 0.7.4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,367 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,540 - stpipe.Image3Pipeline.tweakreg - INFO - Selected image &#39;GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; as reference image
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,545 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,666 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,668 - stpipe.Image3Pipeline.tweakreg - INFO - Found 48 matches for &#39;GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,669 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,672 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,673 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -4.99872e-05  YSH: -1.34437e-05    ROT: 5.32927e-05    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,674 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,675 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.000287318   FIT MAE: 0.000256544
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,676 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 48 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,716 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,836 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,838 - stpipe.Image3Pipeline.tweakreg - INFO - Found 47 matches for &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,839 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,842 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,843 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000321171  YSH: -4.24579e-05    ROT: -0.000894824    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,844 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,844 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00527931   FIT MAE: 0.00461642
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,845 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 46 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:08,886 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,004 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,006 - stpipe.Image3Pipeline.tweakreg - INFO - Found 47 matches for &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,007 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,010 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,011 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000338653  YSH: -0.000284604    ROT: -0.000801054    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,012 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,013 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00545887   FIT MAE: 0.00479425
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,014 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 46 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,054 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,182 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,184 - stpipe.Image3Pipeline.tweakreg - INFO - Found 41 matches for &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,186 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,188 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,189 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000303586  YSH: 0.00105847    ROT: -0.000552349    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,190 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,191 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00771548   FIT MAE: 0.00684298
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,192 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 40 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,232 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,576 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,578 - stpipe.Image3Pipeline.tweakreg - INFO - Found 41 matches for &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,579 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,582 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,583 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000286148  YSH: 0.00108692    ROT: -0.000523678    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,584 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,585 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00770516   FIT MAE: 0.00682456
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,585 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 40 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,624 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,739 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,741 - stpipe.Image3Pipeline.tweakreg - INFO - Found 40 matches for &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,743 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,746 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,747 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000237614  YSH: 0.00262767    ROT: 0.000387146    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,748 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,748 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.0110158   FIT MAE: 0.0068922
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,749 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 39 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,789 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,906 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,908 - stpipe.Image3Pipeline.tweakreg - INFO - Found 40 matches for &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,909 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,913 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,914 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000265638  YSH: 0.00262238    ROT: 0.000458858    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,914 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,915 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.0110242   FIT MAE: 0.00691673
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,916 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 39 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,956 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,957 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() ended on 2022-07-07 08:25:09.956634
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,958 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() TOTAL RUN TIME: 0:00:01.591278
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:09,960 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,417 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,646 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,649 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,897 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,899 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() started on 2022-07-07 08:25:10.897544
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,900 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,901 - stpipe.Image3Pipeline.skymatch - INFO - Sky computation method: &#39;match&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,902 - stpipe.Image3Pipeline.skymatch - INFO - Sky matching direction: DOWN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,903 - stpipe.Image3Pipeline.skymatch - INFO - Sky subtraction from image data: OFF
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,904 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:10,905 - stpipe.Image3Pipeline.skymatch - INFO - ----  Computing differences in sky values in overlapping regions.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,771 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00238358
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,772 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0124171
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,773 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00851901
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,773 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00484789
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,774 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,775 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00727946
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,775 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00377957
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,776 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0117165
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,777 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,777 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() ended on 2022-07-07 08:25:23.777044
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,778 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() TOTAL RUN TIME: 0:00:12.879500
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,778 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:23,814 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,148 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,151 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;crf&#39;, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,153 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,164 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,361 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,364 - stpipe.Image3Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,386 - stpipe.Image3Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:24,601 - stpipe.Image3Pipeline.resample - INFO - Blending metadata for starfield_50star4ptdither_combined.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:25,330 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:25,987 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:27,151 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:28,301 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:29,444 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:30,581 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:31,733 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:32,868 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:34,009 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:34,394 - stpipe.Image3Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:35,015 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:36,135 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:37,252 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:38,367 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:39,477 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:40,577 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:41,693 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:42,869 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:43,229 - stpipe.Image3Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:43,864 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:45,053 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:46,195 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:47,323 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:48,436 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:49,556 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:50,679 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:51,816 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:52,173 - stpipe.Image3Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:52,790 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:53,929 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:55,050 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:56,181 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:57,300 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:58,425 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:25:59,540 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:00,653 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,037 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021880412 -0.020262681 0.024953861 0.014759994 359.990667213 0.017768852 359.987593764 -0.017253822
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,482 - stpipe.Image3Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_combined_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,483 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,714 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1142, 1118) from starfield_50star4ptdither_combined_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,716 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,738 - stpipe.Image3Pipeline.source_catalog - INFO - Using APCORR reference file: /grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,757 - stpipe.Image3Pipeline.source_catalog - INFO - Using ABVEGAOFFSET reference file: /grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,759 - stpipe.Image3Pipeline.source_catalog - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,759 - stpipe.Image3Pipeline.source_catalog - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,760 - stpipe.Image3Pipeline.source_catalog - INFO - Filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,761 - stpipe.Image3Pipeline.source_catalog - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:01,816 - stpipe.Image3Pipeline.source_catalog - INFO - AB to Vega magnitude offset 5.49349
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:02,381 - stpipe.Image3Pipeline.source_catalog - INFO - Detected 640 sources
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:03,027 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote source catalog: starfield_50star4ptdither_combined_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:03,147 - stpipe.Image3Pipeline.source_catalog - INFO - Saved model in starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:03,150 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote segmentation map: starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:03,155 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:03,158 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image 3 pipeline finished.
</pre></div>
</div>
</div>
</div>
</section>
<section id="go-through-list-of-individual-images-and-see-which-sources-were-found-for-each-image">
<h3>Go through list of individual images and see which sources were found for each image.<a class="headerlink" href="#go-through-list-of-individual-images-and-see-which-sources-were-found-for-each-image" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get list of catalogs</span>

<span class="n">cataloglist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ele</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;cal_cat.ecsv&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">imagelist</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imagelist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cataloglist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits&#39;]

[&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop through each image and overplot the sources found in the individual catalogs</span>

<span class="n">index</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">cal_image</span> <span class="ow">in</span> <span class="n">imagelist</span><span class="p">:</span>
    <span class="n">indimage</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">cal_image</span><span class="p">)</span>
    <span class="n">ind_data</span> <span class="o">=</span> <span class="n">indimage</span><span class="o">.</span><span class="n">data</span>
    
    <span class="n">indcat</span> <span class="o">=</span> <span class="n">cataloglist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">catdata</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">indcat</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cal_image</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indcat</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">catdata</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]),</span> <span class="s1">&#39;sources found&#39;</span><span class="p">)</span>
    
    <span class="c1"># mark sources on image frame to see if the correct sources were found</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
    <span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ind_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catdata</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">catdata</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
48 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
48 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_3.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
49 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_5.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
48 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_7.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
42 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_9.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
42 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_11.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
43 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_13.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_13.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
42 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_22_15.png" src="../../../_images/exec_jwst_tweakreg_miri_test_22_15.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-position-differences-as-found-earlier-for-the-individual-i2d-files">
<h3>Get position differences as found earlier for the individual i2d files<a class="headerlink" href="#get-position-differences-as-found-earlier-for-the-individual-i2d-files" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find stars and get RA, Dec from *_i2d.fits files</span>

<span class="c1">#datadir = &#39;/ifs/jwst/wit/miri/pipelinetests/cracraft/build7_8/&#39;</span>
<span class="c1">#filelist = &#39;starfield_50star4ptdither_i2dfiles.txt&#39;</span>
<span class="n">filelist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s1">&#39;*exp*i2d.fits&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">filelist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Run DAOStarFinder to find sources in image</span>
<span class="n">allRAdiff_i2d</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">allDecdiff_i2d</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">i2dimage</span> <span class="ow">in</span> <span class="n">filelist</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">i2dimage</span><span class="p">)</span>
    
    <span class="c1"># pull out data portion of input file</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># print stats on input image</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i2dimage</span><span class="p">)</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

    <span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>    

    <span class="c1">#sources.pprint_all()</span>
    <span class="c1">#print(sources[&#39;xcentroid&#39;,&#39;ycentroid&#39;,&#39;peak&#39;])   </span>

    <span class="c1"># Create apertures for x,y positions</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
    <span class="c1">#print(positions)</span>

    <span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
    <span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>
    
    <span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
    <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

    <span class="c1"># add RA, Dec to sources table</span>

    <span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
    <span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
    <span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
    <span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

    <span class="c1"># print RA, Dec for each x, y position found</span>
    <span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

    <span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
    <span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
    
    <span class="c1"># read in text file with RA and Dec input coordinates</span>
    <span class="n">RA_in</span><span class="p">,</span> <span class="n">Dec_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span> <span class="n">coords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># put RA and Dec into floats</span>
    <span class="n">RA_sim</span> <span class="o">=</span> <span class="n">RA_in</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Dec_sim</span> <span class="o">=</span> <span class="n">Dec_in</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="c1"># Put ra, dec coords into a table</span>
    <span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    <span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    
    <span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
    <span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
    <span class="c1"># Find where the catalogs match</span>
    
    <span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
    <span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
    <span class="c1">#print(cat1_matched)</span>
    
    <span class="c1"># Get differences in RA, Dec</span>
    <span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
    <span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
    <span class="c1">#print(ra_diff)</span>
    
    <span class="c1"># put differences in milliarcseconds</span>
    <span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    <span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    
    
    <span class="c1"># Compare input RA, Dec to found RA, Dec</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
    <span class="c1"># Find if the differences are within the allowed 30 mas range</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
        <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
        <span class="n">allRAdiff_i2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">allDecdiff_i2d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
            <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
    <span class="c1"># Plot ra and dec differences</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">,</span><span class="n">dec_diff</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Plot should show no differences greater than 30 milliarcseconds  </span>

    
<span class="n">meanRAdiff_i2d</span><span class="p">,</span> <span class="n">medianRAdiff_i2d</span><span class="p">,</span> <span class="n">stdRAdiff_i2d</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">allRAdiff_i2d</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_i2d</span><span class="p">,</span> <span class="n">medianDecdiff_i2d</span><span class="p">,</span> <span class="n">stdDecdiff_i2d</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">allDecdiff_i2d</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_i2d</span><span class="p">,</span> <span class="n">medianRAdiff_i2d</span><span class="p">,</span> <span class="n">stdRAdiff_i2d</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_i2d</span><span class="p">,</span> <span class="n">medianDecdiff_i2d</span><span class="p">,</span> <span class="n">stdDecdiff_i2d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_i2d.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_i2d.fits&#39;]

starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_i2d.fits
Image mean, median and std 10.02644 10.793919 50.358776
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 608.4171595332177  3.716633578310318  0.0008807940950981058   -0.014608973449832483
 685.5361272711033  6.676640351753473        359.99852368791   -0.014310647118461398
 886.3825749125941 31.883659717761674     359.99243199998006   -0.012997066622649376
 953.8903146043283  36.42791334678277      359.9903739131892   -0.012676021379698792
 444.4505953299588  63.26281624153407   0.006069550882680229   -0.013224101639142779
 708.6693728443302  72.57734938734053      359.9979915988795   -0.012227356402900732
 373.8564886555948  84.28010346603426    0.00829108344617142    -0.01276953576949686
 429.3583833774347  97.69471821492087   0.006625062606361736   -0.012208766981824246
 486.5283152389315 111.50434252052655   0.004908949745428747   -0.011631394923187975
 813.1990761452593 133.74330225862144     359.99495051349237   -0.010070209126648882
  550.560206525289  142.4900496516069   0.003028621154339518   -0.010508801949263116
 857.0993626579731 161.47538732887776     359.99367882141615   -0.009101577618128952
 943.8979658761588 162.18695741616136      359.9910188106023   -0.008846155268524853
  379.853880633125 175.91920551251647    0.00835378349163196   -0.009943021548657385
391.46788537214064 182.43306111795343   0.008015137667673148   -0.009711999035426041
 465.3617909962983 193.25259534560993  0.0057780894073679225   -0.009181317574993927
   706.95363812055 203.49612576024757     359.99839655675027   -0.008216977565235515
 471.5775059091905 208.05957539040784   0.005627316667749925    -0.00871049116806536
 849.1480038093451 222.16628647523967      359.9940860090523   -0.007261718094653967
 717.8202164480415 236.61792839519646      359.9981524425044   -0.007171958247674846
 641.5113721085359  285.6773322838586  0.0006247031132913374  -0.0058727811770394895
 697.3897726111657  309.2679632390132     359.99897452223934   -0.004998922584256948
  535.443002025132  349.4059940498741   0.004049103401682427   -0.004203821003247007
 433.5661973728897  418.1114069706806  0.0073583512920473194  -0.0023709538722984356
 666.2755764388997  442.5114412125905  0.0002873239622878511  -0.0009963697161873477
 705.6543173819134 452.69750070379854      359.9991070765135  -0.0005780057444356121
398.93463342892437  455.0978262955942   0.008519967744309173  -0.0013298636285377656
 671.2509649809951 467.02458931804176 0.00020071144100200746 -0.00023121412870725464
 857.2567242898431  551.8516161794745     359.99472460987295   0.0028708426951154237
 890.9108199445686  561.2116737488557     359.99371770196626   0.0032484682889914423
 971.4952013430039   576.780271582522      359.9912882524381     0.00394279925782484
 770.3728611969963  585.4328665977425      359.9974795273128   0.0036668778333240836
 815.6668455726337  619.3401604161099     359.99618171276603    0.004828640497583126
459.85030238015776  695.9641566142914   0.007300055964826691    0.006220928837316453
 664.8859084599621  726.8065201293155  0.0010950617167304944     0.00771860724582842
 955.4772151373222  728.9603050274046       359.992189049617    0.008566723577011097
  762.441258417926  736.7707407905575      359.9981300661011     0.00828673779995989
 478.5132674928525  787.4644114532485   0.006973956516324805    0.009077271693545658
 820.1903957861896  844.5181079046816      359.9966490036929    0.011746536546991121
 775.4428945593953  850.8957992447757     359.99803847723797    0.011821698254224034
 820.9755796386793  859.7297975444191      359.9966658628185      0.0122151593981784
 811.0122250027383  904.5533603774919     359.99709205048174    0.013562987104894864
 978.1760397243914   904.077649161292      359.9919642166398    0.013998283612230026
 798.7049954433428  915.1772559795984      359.9974980786183    0.013855676782125816
 757.5404958584097  917.0509754773296     359.99876554775574    0.013802354276160929
  896.257796763571  933.1882370529074      359.9945548173462    0.014670577147402455
 629.6540377743157  973.5037115713425  0.0028394801518162316    0.015189458786452854
460.05893601323965  987.1782562666764   0.008077398343445064    0.015152398484173948

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.628079       -2.324606 pass
      -3.316974       -1.163584 pass
       1.166264       -1.330978 pass
       0.225383       -9.961135 pass
       2.476476        1.270374 pass
       8.793016        0.150308 pass
       4.864651       -3.433940 pass
      -1.701674       -4.039800 pass
       3.483880       -3.109063 pass
      -3.377820       -8.613915 pass
       0.013294        9.131569 pass
       7.043459       -6.221903 pass
       3.632588       11.814859 pass
       7.019084       12.978277 pass
       5.034036       -2.165457 pass
       2.957098        5.120575 pass
       1.728547        8.851631 pass
      -5.481943       13.313715 pass
       5.583178       -0.365901 pass
       0.275449        3.579320 pass
      -1.719938       -6.921303 pass
       0.181734       14.353578 pass
      -6.291223      -11.522672 pass
       5.448572        6.447144 pass
       5.755966       -4.883050 pass
       0.201473      -14.656186 pass
       3.778621        2.604877 pass
       7.572246       -2.955612 pass
      -3.278133       -1.143270 pass
      -2.820097       11.821004 pass
      -0.312519       -7.276967 pass
       2.942446       16.477731 pass
       2.565958      -12.094209 pass
      -3.362036        2.656080 pass
       0.300406       12.471230 pass
       7.695604        7.203472 pass
      -1.072921       -1.914160 pass
       2.561188        2.829137 pass
      -1.404457       -0.566298 pass
      -0.000072       -0.239842 pass
       4.740004        9.031795 pass
       2.820570        3.522425 pass
      -0.493854        7.773833 pass
       5.836156       -2.887017 pass
       2.918168        6.641033 pass
       5.604301        3.680765 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_i2d.fits
Image mean, median and std 10.026232 10.794579 50.35233
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
 608.4217743899426 3.7168035171784375  0.0008806530247472626  -0.014608955818276448
 685.5330346399653  6.676769811417238      359.9985237831027  -0.014310651471371037
 886.3812659336174 31.878285004130735     359.99243202565873  -0.012997234976352953
 953.8848824256042  36.42439047022927     359.99037407030136  -0.012676144038266371
 444.5429955030846  63.26053560781197   0.006066711030794951  -0.013223922905926165
 708.6665132281873  72.58146280793976     359.99799169764816  -0.012227237949203608
 373.8569607796454   84.2814010265435   0.008291072459253023   -0.01276949470549662
429.38032016588716  97.69024389124867   0.006624377810676887  -0.012208845161481111
 486.5254564267202 111.50351093191216   0.004909035180990693  -0.011631428120089693
 813.1988372731453 133.74245370750117      359.9949505185343  -0.010070235792761693
 550.5627500167956 142.49319855160695  0.0030285516255335655  -0.010508698534028759
 857.0955514957163 161.48508330601663     359.99367896439094  -0.009101290520359491
 943.8969171526306  162.1861450038552     359.99101884057796  -0.008846183005863992
  379.852751241222  175.9195670233036   0.008353819100575213  -0.009943013501418603
 391.4989538220022 182.37914770496698   0.008014039768855404  -0.009713568829402337
465.36137074669915 193.25500842787548   0.005778108789814773  -0.009181244701991036
 706.9502242826378  203.4953100609854     359.99839665925003  -0.008217011768597054
471.58160874115606 208.06046289111973   0.005627193231260651      -0.00871045290844
 849.1458447323203 222.16717877975387       359.994086077668 -0.0072616965402826405
 717.8083851194737  236.6037739891648      359.9981527672522  -0.007172424174276077
 641.5103760169046  285.6867059295537  0.0006247588884462673  -0.005872496388309009
 697.3873275137199  309.2651781992406     359.99897458972987  -0.004999014575865282
 535.4416811440921  349.4071138108372   0.004049146923848327  -0.004203790217491797
 433.5639668483946  418.1094097664823   0.007358414322377179  -0.002371021125229948
 666.2771924688882 442.51375195724034 0.00028728062101321107  -0.000996294501430504
 705.6542702940375  452.6957447993154      359.9991070732319 -0.0005780597209702206
398.92158651285973  455.0933100918088    0.00852035571068484 -0.0013300372437614976
 671.2499843675429 467.02531491237886  0.0002007434670766298 -0.0002311945154074712
 857.2755423576701  551.8574467697807     359.99472404845517  0.0028710721515616284
 890.9091234037817   561.216582999801      359.9937177672077   0.003248614279251101
  971.480597592246  576.7736001884953     359.99128868234897  0.0039425553576893395
 770.3721786579907  585.4352506828749      359.9974795546611   0.003666949111170367
 815.6660415029064  619.3407587144932      359.9961817390353   0.004828656682130996
459.85269270170664  695.9641647381263   0.007299982680683778   0.006220935519500548
 664.8856753290405  726.8063589890403  0.0010950684326788943    0.00771860167658069
 955.4774969495099  728.9598884501125      359.9921890398534   0.008566711559921898
  762.443655084473  736.7700021720302     359.99812999061265   0.008286721598229803
 478.5048488276876  787.4573469420083   0.006974195686003448   0.009077032383176701
 820.1899900248424  844.5184996737431     359.99664901719103      0.011746547469679
 775.4352648471837  850.8903602925767       359.998038696587    0.01182151091956381
 820.9557640119565  859.7285745378778     359.99666646722955   0.012215068561687591
  811.011210487701  904.5546715850965      359.9970920851236   0.013563024586452534
 978.1687371326375  904.0718076295194      359.9919644248733   0.013998084811701426
 798.6840735251883  915.1908939976976     359.99749875695227   0.013856038723839975
 757.5406866873069  917.0556436594716     359.99876555446684   0.013802497952813127
 896.2572251237401  933.1866766251252     359.99455483067766   0.014670527754008346
 629.6555530413742   973.497256837165    0.00283941631030037    0.01518926491170905
 460.0582066145697   987.177933807293   0.008077419844700827   0.015152386632029433

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.603919       -1.807370 pass
      -0.874972        0.139406 pass
       1.010236       -1.060205 pass
      -2.239882      -10.242581 pass
       2.819170        1.254703 pass
       9.962108       -1.527027 pass
       5.091561       -3.676051 pass
      -1.603220       -3.783200 pass
       4.880558       -3.734078 pass
      -3.353642       -8.633964 pass
       0.061888        9.170891 pass
       7.904470       -7.083421 pass
       3.879605       11.892455 pass
       7.326652       12.858768 pass
       5.111441       -2.208125 pass
       3.471807        6.154127 pass
       1.498717        8.153682 pass
      -4.692287       12.639310 pass
      -4.640289        0.277539 pass
       0.263635        3.385005 pass
      -1.476972       -7.252473 pass
       0.306445       14.488511 pass
      -4.743544      -12.400712 pass
       5.466723        6.351146 pass
       6.111533       -4.456617 pass
      -0.062350      -14.632130 pass
       3.743472        2.561616 pass
       7.728926       -2.844783 pass
      -3.208357       -0.880927 pass
      -2.070456       11.105322 pass
       0.253085       -7.718538 pass
       2.990440       16.299914 pass
       2.660527      -12.035944 pass
      -3.633794        2.597754 pass
       0.260853       12.619060 pass
       3.743168        1.552214 pass
      -0.838052       -1.388595 pass
       2.676481        2.899745 pass
      -3.425561        0.259746 pass
       0.092371       -0.845915 pass
       4.295633        9.169530 pass
       2.948762        3.551395 pass
       1.682026        7.446822 pass
       5.585852       -2.514723 pass
       3.026081        6.541179 pass
       5.973300        3.557633 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_3.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_i2d.fits
Image mean, median and std 10.049191 10.796259 50.623425
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 632.8233935642098  44.06086119823765  0.0008800340619298028   -0.014627811614874833
 709.9169975346623  47.64999066773835     359.99852539886984   -0.014310259699632618
 910.7899542358584  72.84607194197352      359.9924328685195   -0.012996943279397016
 978.3389290949946  77.39928083241529     359.99037354123783   -0.012675512414446295
468.95656607733815 104.18453484206745    0.00606728636165211   -0.013224960980699519
 733.1052006228166 113.54443086625955     359.99799160754395   -0.012227013307714954
398.29011251642737 125.19101426263659   0.008291008574920999   -0.012770921269802298
453.79141318518134  138.8639700301856   0.006625701212399733   -0.012202231309132982
 510.9998820290149 152.40207105577946   0.004907675748978302    -0.01163308255979089
 837.6228524377786 174.61055545936605      359.9949506230867   -0.010072959960308601
 574.9890299544863  183.6036098343721  0.0030292388620193275   -0.010503985515334132
  881.582279862062 202.44337595773203      359.9936773883987   -0.009101079940205167
 968.3647660313326  203.1863494582124      359.9910179563797   -0.008844737885370503
404.29952350689246 216.82760765605545   0.008353333268551739    -0.00994445160894154
 415.9365608964508 223.29093775296866   0.008013845102118035   -0.009714916613925165
 489.7380054120564  234.3968651720086   0.005780403179861607   -0.009175700922937778
 731.3939657682184  244.4065459807775     359.99839627493384   -0.008218360010043531
496.04417845935603  248.9543837013352   0.005626184911082449   -0.008712281509907568
 873.5365192420863  263.1118491194553     359.99408741078673   -0.007262162227566334
 742.3414968826648  277.5285911479917      359.9981496786961   -0.007173115381505384
  381.222145183017 300.94283522119815   0.009287444912076477  -0.0074269268603464975
 665.9300292817572  326.7237402971317  0.0006254518732282096  -0.0058700514825384305
 721.7904161040007 350.31710759225996     359.99897583080553   -0.004996157447142012
 559.9274579592678  390.3251469157109   0.004047491781529029   -0.004204816863261122
458.02107062465245 458.92900126725203   0.007357373591440892  -0.0023751439265476616
  690.686733748584  483.5332865035347 0.00028823663096247783    -0.00099441348075256
 730.0842703796334 493.53857428664685      359.9991069262531  -0.0005815428027050131
 423.3864293228769 496.01468031011706   0.008519351557359443  -0.0013310178812831407
 695.7068735338236 507.85689943029575 0.00019974159367921768 -0.00023495009010324007
 881.6662240428515  592.7378655221067      359.9947252084767    0.002868636025956692
 915.3603700559266  602.0673167591616      359.9937169899485    0.003245430774439359
 995.8723252674553  617.8257145905122     359.99129027239974    0.003945387574942998
  794.779799365377   626.382318443093      359.9974803745614   0.0036666025531536454
 840.1364897357082  660.4206842267243      359.9961809897193   0.0048325536651422415
484.30824617669765   737.062428117951  0.0072997394729233415    0.006225354804655213
 689.3510161728213   767.897333628727  0.0010945054698635538    0.007722823755799904
 979.9047337520608  769.9007001328239      359.9921892413867    0.008566225895471536
 786.8913288471491   777.708154633028      359.9981295581892    0.008286209394994169
 503.0060525929942  828.4899881198223   0.006972375872585689    0.009079562018922809
 844.5829612909755  885.4043541379378      359.9966501216472    0.011744284144864205
 799.8040084109176  891.8083209538688      359.9980406304513    0.011820167021211919
 845.4281390502101  900.6384428093902      359.9966652011728    0.012213755381672596
 835.4665675091164  945.4326266381604     359.99709125508616    0.013560686881936176
1002.5489678577397  944.9587710124847      359.9919659230913     0.01399582116763517
 823.1588870478552  956.2407437496984     359.99749779284144     0.01385902501919776
 781.9787081642465  958.1324192979212      359.9987657911437     0.01380621099314049
 920.6841771920997  974.0483107014173      359.9945548278615    0.014667613053373885
 654.0974882711237 1014.4609176465972   0.002839228509316584     0.01518951949203934

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -0.751883       11.559575 pass
      -4.345771       10.890069 pass
       4.451871        5.711469 pass
       2.524365       13.567287 pass
       8.635932        2.665081 pass
      -1.156694       -4.015373 pass
       1.344929      -18.518136 pass
       1.348421       -5.030809 pass
       1.265606       -7.264373 pass
      -5.380308        6.565521 pass
       4.037930        1.022922 pass
       1.353141        2.023268 pass
       8.678832       10.215981 pass
       2.432696        6.902785 pass
      -2.201765        6.912215 pass
       0.822634        9.070171 pass
       2.269625        7.801276 pass
      -2.569098       -3.459531 pass
      -0.265489       -9.154090 pass
       2.990900        3.033190 pass
      -1.998317      -14.136697 pass
      -2.681690        6.072775 pass
       0.980639       -2.204730 pass
       5.843112       -3.455857 pass
       5.787158       -3.647908 pass
      -0.937897        1.277297 pass
       4.468992        0.813224 pass
       1.770414       -6.540708 pass
       5.051448       19.076677 pass
       3.323129        2.956203 pass
      -1.651544       -5.444692 pass
       2.980301        5.806992 pass
      -0.037011        1.993195 pass
      -5.190519        0.753822 pass
       0.030870        7.483429 pass
       3.042368       -3.299810 pass
      -3.636185      -12.849212 pass
      -0.930263      -10.620324 pass
       0.750516       -8.510307 pass
       3.126670        0.204194 pass
       7.322623       -6.521814 pass
       0.665680        2.586564 pass
       1.199767       -1.625792 pass
      -2.875778        2.719374 pass
       8.059903       14.452145 pass
      -0.157033       11.743613 pass
       4.589762       -1.296036 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_5.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_i2d.fits
Image mean, median and std 10.050589 10.797003 50.61101
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 632.8208535562436  44.06661298416791   0.000880127438197349   -0.014627642055924117
 709.9164865144267  47.65030581209815     359.99852541538985   -0.014310251410126587
 910.7918430183055  72.84180030755901      359.9924327990984   -0.012997069197936644
  978.335357305015   77.5497093396856      359.9903740556232   -0.012670908709630084
 468.9478851732465  104.1929445114733  0.0060675752190952675   -0.013224726437080246
 733.1105124238405 113.54050890639823     359.99799143408734   -0.012227119290189927
398.28962699638663  125.1911537846086   0.008291023840269633   -0.012770918297648384
 453.7904577905888 138.86252596936555   0.006625726625909363   -0.012202278166600317
511.00033899269226 152.40231005644782   0.004907662378106805   -0.011633074000340056
 837.6226592683877  174.6046915140293     359.99495061322926    -0.01007314031472753
 574.9884478538547 183.60076138549033  0.0030292490477919036   -0.010504074437735794
 881.5819375465893 202.44619622798464      359.9936774064869   -0.009100994369881666
 968.3521797218546 203.18147775655726      359.9910183292635    -0.00884492116333594
 404.3051925516315 216.82030488972345    0.00835313975733602   -0.009944660312011773
 415.9373105227306  223.2897439401302   0.008013818899800837    -0.00971495120812003
 489.7436128831328 234.39617510236067   0.005780229353640175   -0.009175706994584443
 731.3979416062841 244.52699906223447     359.99839647717727   -0.008214655273744395
 496.0441151367621 248.95524703309133  0.0056261891765234376    -0.00871225520381933
 873.5372555614316 263.11100145745525     359.99408738592416   -0.007262186241878522
 742.3387928945151 277.52749420413807     359.99814975866934   -0.007173156299629747
  381.223450389697  300.9574562178237   0.009287444233499203   -0.007426474953229195
 665.9301447887054 326.73349170102193  0.0006254745746964241   -0.005869752117160425
 721.7896024108961 350.31595947772337     359.99897585266984   -0.004996194847231716
 559.9276147295749 390.32057099126223   0.004047474658596238     -0.0042049567750809
 458.0168047238532 458.92813301972586   0.007357502080718109   -0.002375182034592143
   690.68718710654 483.52790155555095 0.00028820823502868827  -0.0009945774053766834
 730.0835974884753 493.53932319887645      359.9991069489048  -0.0005815216461252712
423.38609317164133 496.01240800195524   0.008519355750956782  -0.0013310884727530882
 695.7056886695483  507.8566279077027 0.00019977720016538884 -0.00023496160592538707
 881.6647777549194  592.7353061200878      359.9947252459432     0.00286855364224012
 915.3601150126186  602.0646085886315      359.9937169904817   0.0032453470342930055
 995.8730791098423  617.8237923678146     359.99129024410774    0.003945330653334774
  794.777720976471  626.3805005865127      359.9974804334088    0.003666541209869741
 840.1236416819435  660.4183779151107     359.99618137753447    0.004832448357736118
 484.3095470932323  737.0614756453083   0.007299697013243495   0.0062253290955218985
 689.3507278144872  767.8967346961085  0.0010945127012977076    0.007722804611763402
  979.918790329076  769.9037230393938     359.99218881843734    0.008566356431761216
 786.8890216014591  777.7094165766694      359.9981296323437    0.008286241886624815
 503.0050355084057  828.4888123422205   0.006972403900024286    0.009079523223111478
 844.5896779292073  885.4644466706754      359.9966500773886    0.011746145129545053
 799.7836068354346  891.7977068053426      359.9980412275579    0.011819786601702872
 845.4269314600002  900.6399826520483      359.9966652423511    0.012213799355361718
 835.4668819360697  945.4317695465718     359.99709124313665    0.013560661442995562
1002.5481080778505  944.9592501642296     359.99196595074847    0.013995833548262749
 823.1591093611298  956.2421157776859      359.9974977897161     0.01385906769462918
 781.9784460170058  958.1363464973927      359.9987658097524    0.013806330726352747
 920.6832259215818  974.0511399111502     359.99455486464916    0.014667697258975746
 654.1144577214808 1014.4408743221641   0.002838654150532828    0.015188950476190186

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -0.684891       11.990615 pass
      -4.357022       11.043701 pass
       4.349646        5.121341 pass
       2.615853       13.398600 pass
       8.695404        2.694924 pass
      -0.868790       -4.162679 pass
       1.807491      -18.655325 pass
       1.560272       -5.251644 pass
       1.280703       -7.518502 pass
      -5.354275        6.496602 pass
       3.878599        7.722466 pass
       1.454040        1.883603 pass
       8.589327       10.129529 pass
       2.384561        6.933599 pass
      -2.136647        7.220268 pass
      -1.245058        7.021714 pass
       4.419208        6.431766 pass
      -1.529211       -2.615173 pass
      -0.183943       -9.077926 pass
       3.069612        2.898550 pass
      -2.000759      -12.509832 pass
      -2.724708        5.981195 pass
       0.878788       -2.409648 pass
       5.807625       -4.105133 pass
       5.162714       -4.029445 pass
      -1.090752        1.184744 pass
       2.946374        1.283154 pass
       1.708771       -7.044390 pass
       4.425673       19.054819 pass
       3.422694        3.000774 pass
       0.200244       11.128645 pass
       3.112737        6.110132 pass
       1.359124        1.614088 pass
      -4.923563        0.870792 pass
       0.085825        7.494128 pass
       2.948039       -3.424349 pass
      -3.634266      -13.150677 pass
      -0.802079      -10.661781 pass
       0.885395       -8.806888 pass
       2.876754       -0.249113 pass
       7.658778       -5.911401 pass
       0.681035        2.681266 pass
       0.503126       -2.377123 pass
      -2.727536        2.877679 pass
       8.096572       14.132024 pass
       1.185349       11.083812 pass
       5.317838       12.041015 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_7.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_i2d.fits
Image mean, median and std 9.754711 10.78795 47.292503
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 647.2789161605924 122.80321355691154  0.0008797775183292475   -0.014624823462449654
 724.3614374123302  126.2418480774671      359.9985250771654   -0.014311916721041814
 925.2829331844007  151.5145563525393     359.99243126441695   -0.012996119655296002
 992.7487736915098 156.01857184487108      359.9903743542836    -0.01267642117741895
 483.4108876491559 182.81936408337538   0.006066777323068356   -0.013225273542513292
 747.4900629430496 192.29100875074428     359.99799352935986   -0.012224085691362683
412.67624918559994 203.82526964340732   0.008292589094440828      -0.012771434930238
468.22622322261236  217.4335124430099    0.00662561484915368   -0.012204598572113935
 525.4793412791782  231.0363837689684   0.004906394393201483   -0.011633343283519646
 852.0829299508489 253.35682602604138      359.9949502373857   -0.010069839311986458
 589.4578945068167  262.1256606102094  0.0030279802827910458   -0.010507717566989611
 895.9845859520525 281.09023367307356      359.9936785068771   -0.009101163537758082
 982.7794364109685  281.6707193761684      359.9910182583641    -0.00884977135300889
 418.7259691104078  295.4299661573132   0.008353591751627925   -0.009945834954251083
430.41163791449515  301.9839544392282   0.008012856149227103   -0.009713388784161293
504.20613810871896  312.8196411331334   0.005778899885488405   -0.009182479474852715
 745.8579793340274  322.9790224215006      359.9983953008199   -0.008220558642726585
 510.5276942998455 327.59339153692366   0.005624791790135613   -0.008712387291094213
 888.0481203541209  341.5916620875642       359.994084727875   -0.007267074567089318
 756.7271091351589  356.2456765374387      359.9981514981706   -0.007171090161371694
395.62123128046375  379.6527786108187   0.009288831993683239   -0.007425084415659855
 680.3588050877938  405.3080503748126  0.0006255902909735072   -0.005871982021902389
 736.2394038113671 428.82506556460595     359.99897514388334   -0.005000375139883637
 574.3847744345752 468.94787558102325   0.004046858324959263   -0.004205492369867198
472.48831919879484  537.6353910923275   0.007356660698894385   -0.002373226992418696
 705.1420009826525  561.9974603806708  0.0002872393123577047  -0.0009999570322496833
 744.4780510834672  572.1962436751081      359.9991083353496  -0.0005813177428171154
 437.8212074142105  574.7341320894033   0.008519669616725286  -0.0013287877525247726
  710.148262996555  586.5352687429476 0.00019974634113914885 -0.00023396208025100568
 896.1025820796689  671.4272514303462      359.9947253972147   0.0028699483331364175
 929.7789151166561  680.8283618112089     359.99371791783597     0.00324889276986248
1010.3412782399024    696.54034857963     359.99128952950116    0.003947561898381374
 809.2170407580668  704.8857011465235     359.99748003561234   0.0036622129146844725
 854.5311037191843  738.9369304829478      359.9961819926958    0.004828443789853686
498.71323298095945  815.6886781812367   0.007300720326362872     0.00622464641367677
 703.7400304952233  846.5055532670028  0.0010959276837761284    0.007721519401199448
 994.4334958772071   848.515421247478      359.9921863954179    0.008565497010275609
 801.3193855404203  856.4152849994789      359.9981300492819    0.008288043483050374
 517.4591162711088  907.0342036694266   0.006971661533162236    0.009076467154850108
 859.0532651546279  963.9759753376343       359.996648952453    0.011742076094250521
  814.280212980596  970.3956428869056     359.99803932253513    0.011818456358268467
 859.8474743909094  979.3659415828224      359.9966660145876    0.012216190578930464

RA_Diff (mas)  Dec_diff (mas) pass/fail
       0.861524      -14.245316 pass
       2.213457        5.045140 pass
       7.477796       -3.300196 pass
       5.393414        3.275419 pass
      -1.221484      -11.617173 pass
       0.128204      -20.833507 pass
       2.410620        0.764091 pass
      -0.260338        1.869844 pass
      -0.171169       -6.926061 pass
      -1.218481       -9.118243 pass
      -0.979650       -7.468442 pass
      -2.180184        5.964179 pass
       1.824758        6.611264 pass
      -2.438874        1.642890 pass
      -4.401637       -4.584753 pass
       4.807259       -8.343874 pass
       0.517980      -12.150504 pass
       2.995177       -7.503896 pass
      -1.693796        5.622834 pass
       4.454588        7.778477 pass
      12.705695        6.891511 pass
       2.593175       -1.272911 pass
      -5.776496       -1.810763 pass
      -0.510030       -8.972532 pass
      -0.360412       -5.326109 pass
       1.275421       -8.716239 pass
       3.573705      -12.802357 pass
      -3.422585        7.356539 pass
       5.720740        5.634251 pass
      -0.517863        2.200377 pass
      -0.295791       -0.386028 pass
      -0.913172       -7.063489 pass
       1.429973       -3.786001 pass
      -2.648099        3.169241 pass
       6.399066        4.235535 pass
      -4.349556        2.205752 pass
       2.130306       -6.605835 pass
       0.052515       11.486084 pass
       3.529018        1.016759 pass
       0.930111       -6.376871 pass
       1.082952       -9.211114 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_9.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_i2d.fits
Image mean, median and std 9.754807 10.787943 47.304714
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
 647.2790687385187 122.80495889954449  0.0008797775363115812  -0.014624769525925826
 724.3704541549183 126.23059313821031     359.99852477035114  -0.014312237619081231
 925.2610325886693 151.52399227829787     359.99243196145574   -0.01299588921663906
 992.7460186280499 156.01775330910218      359.9903744365725  -0.012676453694798551
483.40766270574716 182.81635228445626  0.0060668681195144855  -0.013225374587148798
 747.4910350871386 192.29159650116355     359.99799350112806   -0.01222406505001428
 412.6680607696125 203.81917347786944   0.008292823808974977   -0.01277164392386538
468.22315775877274 217.43233581714384   0.006625705693681134  -0.012204642906720062
 525.4949872929363 231.01844098493436   0.004905866274512778  -0.011633851442081804
 852.0811015309897  253.3593985391962     359.99495030038275  -0.010069765339366783
 589.4607513874881 262.12642521685035  0.0030278947261973598  -0.010507686429465554
 895.9862032899913  281.0924646191287     359.99367846328096  -0.009101090766727483
 982.7870000972611 281.66591838707086      359.9910180134813  -0.008849898232925235
418.71806858932365 295.43866852743594   0.008353857464155783  -0.009945589333914161
 430.4106509939537  301.9827250909581   0.008012883107416826  -0.009713429141688108
504.20572091664025 312.81693444599364   0.005778905395398022  -0.009182563605888176
 745.8573467882374 322.97957761708665     359.99839532171285   -0.00822054331844383
510.52608684969493  327.5988187028525   0.005624855693226856  -0.008712225177731533
 888.0475412692783  341.5924736887918     359.99408474781853  -0.007267051235513673
 756.7282305535889  356.2444306344122      359.9981514604261  -0.007171125352472284
395.61985338225156 379.64583256939136   0.009288855557069695  -0.007425301144102016
 680.3510834058361 405.31140847723395   0.000625836135935205  -0.005871899817401908
  736.238067825347  428.8249552627603     359.99897518455833  -0.005000382118123049
 574.3838619967881 468.95107895832587     0.0040468949286726  -0.004205396584821227
 472.4892049188596  537.6356871866936   0.007356634332630527 -0.0023732155281224595
 705.1400605533618  561.9987628943671 0.00028730232659156355 -0.0009999223092209953
 744.4787775908818  572.1925532742338     359.99910830313723 -0.0005814289642115224
  437.820961748692  574.7350190607578   0.008519679537857858 -0.0013287612121782979
 710.1442795095687   586.535662682624 0.00019986956630777596 -0.0002339607196820527
 896.1028664755489  671.4287056042008     359.99472539240656   0.002869993694898269
 929.7813247285987  680.8317009438545     359.99371785292493   0.003249001658819474
1010.3425255214507  696.5403039116634      359.9912894911295   0.003947563885299666
  809.213226749417   704.910430570953     359.99748021913376  0.0036629610481974987
 854.5369276259974  738.9265454395132        359.99618178614   0.004828140976778901
498.70911480963457  815.6907739276936   0.007300852262050196   0.006224699602513367
 703.7512156042604  846.4410534371408  0.0010954110730483583   0.007719571432912597
 994.4294626935291  848.5110438068966       359.992186507326   0.008565351909178839
  801.319079820867  856.4138424399302      359.9981300547753   0.008287998420076777
 517.4627200944778   907.030841838445    0.00697154196401925   0.009076373753661424
 859.0551102484224  963.9775839713432      359.9966489001972   0.011742130393258558
  814.278246250194  970.3942103101416     359.99803937899503   0.011818407131188749
 859.8470975734401  979.3692793539512      359.9966660351267   0.012216291927048683

RA_Diff (mas)  Dec_diff (mas) pass/fail
       1.088376      -14.120313 pass
       2.540497        4.885536 pass
       6.373264       -4.455429 pass
       5.257534        3.148731 pass
      -1.316403      -11.575901 pass
       0.788882      -18.140226 pass
       2.446336        0.859636 pass
      -2.120137       -5.142842 pass
      -0.359290       -6.730584 pass
      -1.648930       -9.454487 pass
      -0.907853       -7.384448 pass
      -4.081412        4.134809 pass
       1.667811        6.873240 pass
      -2.235618        1.465672 pass
      -4.074770       -4.948514 pass
       4.691294       -8.744271 pass
       0.664410      -12.175625 pass
       3.080005       -8.284119 pass
      -1.831934        5.629987 pass
       4.681378        8.044778 pass
      12.604061        6.965820 pass
       3.068143       -1.081431 pass
      -5.373626       -2.333127 pass
      -0.378257       -8.627705 pass
      -0.340577       -5.628981 pass
       1.571661       -8.833301 pass
       2.830104      -13.892484 pass
      -3.402809        7.194312 pass
       6.565712        4.881874 pass
      -0.420813        2.055090 pass
      -0.529470        0.005972 pass
      -0.469561       -7.058591 pass
       1.412664       -3.622698 pass
      -0.138759        3.998820 pass
       6.399131        4.429707 pass
      -4.119504        2.789360 pass
       3.086871       -5.721602 pass
       0.126456       11.850937 pass
       3.221014        1.128854 pass
       0.048533       -6.833639 pass
       1.158166       -9.155946 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_11.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_i2d.fits
Image mean, median and std 9.740273 10.788436 47.192795
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 695.5006034054337  102.3933057031372   0.000881875383722068   -0.014622124736287807
 772.6324036323349 105.70259857314427     359.99852531567484   -0.014313051986448201
 973.4763142518625 130.96661093289694      359.9924338589653    -0.01299773038193665
  531.627529372202 162.48279595617868  0.0060692272792496295   -0.013220339264587256
 795.8027898172277 171.79252025563895      359.9979925968647   -0.012223858526128168
460.99927575034184 183.24074380981432   0.008291109129948258   -0.012773818682882378
 516.4753899126669 196.90113053736118   0.006626540343964035   -0.012205581952809972
 573.6395028777987  210.4815046615099   0.004909988940216402   -0.011635256135337755
 900.4056260554462  232.8557447454482      359.9949489922101   -0.010069664831622764
 637.6910339557903 241.65741660070805   0.003029569924408076   -0.010506777097387659
 944.2619329209743  260.6431660763402     359.99367879784336   -0.009099454623691997
467.03013292629635  274.9970245263968   0.008353098228030188   -0.009943620716866854
478.66676378150004   281.473569682298   0.008013658092317591    -0.00971368153434196
 552.5197027209285  292.2686391599453   0.005777800328036064   -0.009183860583146415
  794.161456237595  302.4967429250756     359.99839469562096   -0.008219859303491448
 558.7591839226658 307.06319870636383   0.005626265299835722   -0.008713351115663941
 936.3421390928258  321.1475245967598      359.9940845154335   -0.007265230939918525
 805.0495355955087 335.75631390980953      359.9981502927691  -0.0071705570525570726
443.95181078729763 359.11638565320845   0.009287249945862278   -0.007425971720816701
 728.6018900738496  384.5504323045862  0.0006260961511239862  -0.0058798892730547265
 784.4818931625323 408.52068710629084     359.99897688781965  -0.0049943841119754005
 622.6413233258268  448.4138352029966   0.004047552974229688   -0.004206506752695917
 520.7278245284492  517.0597125822031   0.007357765976418451    -0.00237556420223112
 753.4706005125323  541.5383705614963 0.00028592605493772477  -0.0009984789359967377
 792.8000761314943  551.7139087503351      359.9991071611654  -0.0005805702182880926
 486.0894160320041   554.161223217026   0.008519902083423112  -0.0013309627747549045
 758.4745024358987   566.053889182804 0.00019844547525511752 -0.00023317391570589296
 398.7035493671905  605.2078211123543     0.0113372192095782  -6.541418924222696e-07
 944.4417007850916  651.0004839422722     359.99472384838947    0.002872445981120222
  978.068852945086  660.2831399462634      359.9937175584979    0.003247625314871782
 857.5561501031984  684.4477447319545      359.9974784569368     0.00366436739904103
 902.8304103849621  718.4437874878812      359.9961814861699     0.00482879869499827
 547.0075876472102   795.239301531326   0.007300483419708993    0.006226330240079774
 752.0789762313976  825.9846654673187  0.0010941308142813756    0.007721130124784033
 849.5484818553715  835.9586102506569     359.99813179408756    0.008289327834993478
  565.760247965449  886.5470686298206   0.006971115174289697    0.009077011260399271
 907.3358526806088  943.5343422078865      359.9966490972895     0.01174396569193863
 862.4934945986083  949.8305723260058      359.9980412606198    0.011816373882064047
 908.1048719880649  958.8211658967488      359.9966666543585     0.01221484922380446
 898.1395893198218 1003.5569811653191     359.99709266499826    0.013559980671477602
 885.8335051488962 1014.3366418380592      359.9974990772085     0.01385745040337885
 844.6994409607346 1016.0583670560342      359.9987652038641    0.013799548486110614

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -2.866089      -12.425450 pass
       0.277951        5.221452 pass
      -3.866202       -8.924170 pass
       5.545238        1.504970 pass
       8.336430       -7.387151 pass
       1.053969        5.194611 pass
       2.757515      -20.031128 pass
      -5.555028      -13.077363 pass
       3.247500       -7.065989 pass
      -6.729069        0.468449 pass
       0.350242       -0.123509 pass
      -3.185373       -7.159463 pass
      -1.744439       -0.831384 pass
      10.760185       -0.922087 pass
       2.872236       12.763355 pass
       4.538231       -5.854025 pass
       4.418205       13.178647 pass
       0.580196       -5.652786 pass
       6.796151        9.417197 pass
      -2.700195      -10.698195 pass
       2.393994        3.530417 pass
      -0.028044        8.406606 pass
       9.348713        7.709306 pass
       1.740311        4.788864 pass
       1.990707      -12.624310 pass
      -4.318819      -10.298099 pass
       1.750212      -11.524698 pass
       2.858715       11.980206 pass
       0.392868       -2.947258 pass
       2.369132        1.146476 pass
      -1.589408       -4.948866 pass
      -5.596289       -4.226097 pass
      -4.145798        5.205532 pass
       6.692275       -2.629375 pass
      13.951381       13.950949 pass
       0.955079       -1.264016 pass
       0.353621        1.365419 pass
       2.355691        6.657206 pass
       9.251728        4.402449 pass
      -1.095765       -6.693493 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_13.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_13.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_i2d.fits
Image mean, median and std 9.73896 10.788699 47.16118
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 695.5000595981281  102.3955168227148  0.0008818980118768585   -0.014622058389564409
 772.6300829574792 105.70143936470159     359.99852538372517   -0.014313093782482394
 973.4757507928692 130.96871079850118      359.9924338818967   -0.012997667500016314
  531.624385675305  162.4714207126525   0.006069293075609228   -0.013220696579359082
 795.8040154519499 171.79681074372252     359.99799257082407   -0.012223723647572888
460.99912170739447 183.24334537989796    0.00829112085568476   -0.012773739312911188
 516.4762334783253 196.90075184259487   0.006626513454448065   -0.012205591296281152
 573.6407434150301  210.4811316708813   0.004909949891787606   -0.011635264235520873
 900.4052144008393 232.82936884563873      359.9949489338495    -0.01007047483142459
 637.6896794472583 241.65784423078722  0.0030296126151367823   -0.010506767628271787
  944.261088265291 260.64525493193344     359.99367882936883    -0.00909939283620801
467.02755079607937  274.9896102109773   0.008353157462343984   -0.009943855047168415
478.65520094434015  281.4594375497971   0.008013974665975577   -0.009714146055259361
 552.5170595971351  292.2675375064664   0.005777878422079199   -0.009183901481881907
 794.1578040343234 302.49725134924233      359.9983948089945   -0.008219853540348095
 558.7641101884963  307.0679871946808  0.0056261271090761915   -0.008713191005078322
  936.362581873911 321.16166001870494     359.99408392654004   -0.007264742419612418
  805.044824127867  335.7482022875675     359.99815041542894     -0.0071708184984298
443.95248545850313 359.11418027658254   0.009287223319849379   -0.007426037539226708
  728.599454631446 384.55661300123455  0.0006261874749185815   -0.005879706278894323
 784.4729487590471  408.5207250432802      359.9989771622273   -0.004994407020492186
 622.6415593369981  448.4147266253674   0.004047548135366099    -0.00420647877951203
 520.7282354834225  517.0623120603873   0.007357760369257103  -0.0023754833758352837
  753.469972009388  541.5395654747184   0.000285948545628897  -0.0009984439820677777
 792.8013128762526  551.7136669718561     359.99910712258645  -0.0005805743046794633
486.08604710923026   554.163228153586   0.008520010796871976   -0.001330910354419916
 758.4905502883589  566.0455290247049 0.00019793082266409247 -0.00023338711435324068
 398.7046402584967  605.2087463758446   0.011337188244436204  -6.228301599201359e-07
 944.4385359057434  651.0027195755773     359.99472395146626    0.002872506025574089
 978.0698313287754  660.2843554501384      359.9937175317642   0.0032476652248704108
 857.5512767950164  684.4458084287019      359.9974786011795   0.0036642949013153212
 902.8320624080717  718.4420171064412     359.99618143074133    0.004828748847288334
 547.0129992544846  795.2448531922399   0.007300332398497156     0.00622651506173229
 752.0731226968022  825.9905172869825  0.0010943260784896625    0.007721293833926782
  849.547973432374  835.9589621544075      359.9981318106269    0.008289337258810522
 565.7599530403534  886.5468117639466    0.00697112352770554    0.009077002589178955
 907.3260826030389  943.5338206212036       359.996649395513    0.011743923401935733
 862.4950862281373  949.8297116020337      359.9980412094915     0.01181635176905245
 908.1029369331438  958.8182028652813     359.99666670572805    0.012214753146242643
 898.1417825664516 1003.5596827038565     359.99709260500674    0.013560069424494938
 885.8336831694866 1014.3419223268896      359.9974990859603    0.013857612823672216
 844.7017753803382 1016.0615947475493     359.99876514095916    0.013799653755025565

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -3.092547      -12.046482 pass
       0.309457        5.806165 pass
      -3.785236       -8.798335 pass
       5.448436        1.471333 pass
       8.581411       -7.537617 pass
       1.495544        4.253406 pass
       2.737329      -19.740153 pass
      -5.035754      -13.338355 pass
       3.638869       -6.877276 pass
      -6.026117        1.057802 pass
       1.423847       -0.275753 pass
      -3.155300       -7.190679 pass
      -3.864456        0.927289 pass
      10.619610       -0.951248 pass
       2.985728       12.985790 pass
       4.354169       -5.933631 pass
       4.655072       11.892314 pass
       0.441311       -5.667497 pass
       7.784018        9.334726 pass
      -2.796049      -10.935141 pass
       2.178024        3.849928 pass
      -0.238142        5.490607 pass
       9.254967        8.194869 pass
       1.196635        5.454222 pass
       1.973287      -12.523606 pass
      -4.037681      -10.445335 pass
       1.550669      -11.704150 pass
       2.918257       12.014132 pass
       0.435080       -2.661526 pass
       3.508798       -0.525799 pass
      -1.685649       -4.805190 pass
      -7.449038       -4.993612 pass
      -3.774722        5.421692 pass
       6.774828       -2.403000 pass
      14.032843       14.189798 pass
       0.457593       -0.687618 pass
       0.566864        0.521830 pass
       2.540621        6.311326 pass
       9.405414        4.436538 pass
      -0.687620       -6.672745 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_24_15.png" src="../../../_images/exec_jwst_tweakreg_miri_test_24_15.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.436019300064677 1.190991620497392 3.8372740253085325
Dec difference mean, median and std (units in mas) -0.09997223853214 0.1772512706485485 7.883142220258062
</pre></div>
</div>
</div>
</div>
</section>
<section id="look-at-positions-of-ra-dec-and-get-stats-on-differences-for-the-combined-image-run-with-tweakreg-on">
<h3>Look at positions of RA, Dec and get stats on differences for the combined image run with tweakreg on<a class="headerlink" href="#look-at-positions-of-ra-dec-and-get-stats-on-differences-for-the-combined-image-run-with-tweakreg-on" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_combined_i2d.fits&#39;</span><span class="p">)</span>
<span class="n">pixarea</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel area in steradians&#39;</span><span class="p">,</span> <span class="n">pixarea</span><span class="p">)</span>

<span class="c1"># pull out data portion of input file</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># print stats on input image</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pixel area in steradians 2.84403609523084e-13
Image mean, median and std 10.235801 10.815084 46.58098
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run DAOStarFinder to find sources in image</span>

<span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>    

<span class="c1"># Create apertures for x,y positions</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
<span class="c1">#print(positions)</span>

<span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
<span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>

<span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
<span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

<span class="c1"># add RA, Dec to sources table</span>

<span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
<span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

<span class="c1"># print RA, Dec for each x, y position found</span>
<span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

<span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="c1">#print(&#39;       RA found       Dec found    RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;)</span>

<span class="n">deltara_twon</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">deltadec_twon</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Put ra, dec coords into a table</span>
<span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
<span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    
<span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
<span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>    
<span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
<span class="c1"># Find where the catalogs match</span>
    
<span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
<span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
<span class="c1">#print(cat1_matched)</span>
    
<span class="c1"># Get differences in RA, Dec</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
<span class="c1">#print(ra_diff)</span>
    
<span class="c1"># put differences in milliarcseconds</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    
    
<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
<span class="c1"># Find if the differences are within the allowed 30 mas range</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
    <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
    <span class="n">deltara_twon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">deltadec_twon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
<span class="c1"># Plot ra and dec differences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">deltara_twon</span><span class="p">,</span><span class="n">deltadec_twon</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot should show no differences greater than 30 milliarcseconds  </span>
     
<span class="n">meanRAdiff_twon</span><span class="p">,</span> <span class="n">medianRAdiff_twon</span><span class="p">,</span> <span class="n">stdRAdiff_twon</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltara_twon</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_twon</span><span class="p">,</span> <span class="n">medianDecdiff_twon</span><span class="p">,</span> <span class="n">stdDecdiff_twon</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltadec_twon</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twon</span><span class="p">,</span> <span class="n">medianRAdiff_twon</span><span class="p">,</span> <span class="n">stdRAdiff_twon</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twon</span><span class="p">,</span> <span class="n">medianDecdiff_twon</span><span class="p">,</span> <span class="n">stdDecdiff_twon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 695.5013549809806  122.7766822025338  0.0008813127670242714   -0.014625592281021131
  772.622356013871 126.26211163727903     359.99852555828016    -0.01431114688172253
 973.4755225481315 151.46687258877478      359.9924336582239   -0.012997617518265737
1041.0315300819998 156.07277971926715     359.99037425709884   -0.012674551580170952
 531.6380615452591 182.87454083332935    0.00606838721592468    -0.01322352383349858
 795.8149629449284 192.30948790749403     359.99799204349625   -0.012223198411829454
 460.9912107378149 203.83898378611806   0.008291395127706937   -0.012770720536852177
 516.4547468081652 217.46520508035724   0.006627120144335814   -0.012203565451173319
 573.6924942105585 231.02101005657985   0.004908244414513841   -0.011633794957402266
 900.3787936543063 253.34340105424758     359.99494955615097   -0.010070008629973263
 637.7014894554683 262.20435394782845  0.0030291498844759535   -0.010505202489261112
 944.2497452920023 281.07580367144914     359.99367876457666   -0.009101446320670697
1031.0586062660468 281.71110780399835     359.99101823394034   -0.008848335266650333
  467.012292304282  295.5453429038038   0.008353549668900853    -0.00994207989247428
478.64964316203566 301.97251251162356   0.008013954570084102   -0.009713653016738797
 552.5291342724279  312.8363653733049   0.005777467631573245   -0.009181651179353162
 794.1217000644799  323.0499118110758      359.9983958322238   -0.008218228747614537
  558.757549507393  327.6053307478234   0.005626203091300995   -0.008711956414902385
 936.3166965512806  341.6399257674642      359.9940850494987   -0.007265425490282521
 805.0144706974362 356.24546178811937     359.99815111319646  -0.0071708772602491365
443.93218109939704 379.67209332867526   0.009287776136331671   -0.007424209111747269
 728.6572481366939  405.3443108999513  0.0006249636219200923   -0.005870620688815857
 784.5693602930243   428.896958921466      359.9989736466663   -0.004997836216261598
 622.6243607571035  468.9626900779852   0.004047978934809098   -0.004204947149079405
  520.740194425333  537.6463945201664   0.007357394174435206  -0.0023727655801580056
 753.4537983577877  562.0338407457554  0.0002862034037268925  -0.0009985560952321712
 792.8057822571271  572.2176767161972      359.9991067705577  -0.0005803323252330227
 486.0896899958221  574.6782309189558   0.008519713722700472  -0.0013303334648981347
 758.4517447473968  586.5352022030213 0.00019886736335263518 -0.00023370127031405578
 398.7049092070945  625.7081520413215   0.011336952660279858   -5.33350227070635e-07
 944.4241631677747   671.446648970207      359.9947240155387   0.0028708547827174485
 978.0647269123282   680.808172453052      359.9937175265844    0.003248488910629768
1058.5842198729129  696.4879267667103     359.99129036623236    0.003946054165939044
 857.5414671362729   704.978848014034     359.99747876515573    0.003665388759325438
 902.8340678491106  738.9553373457603      359.9961811792855    0.004829269765188146
 547.0073183010053  815.6280886654143  0.0072999666405201375    0.006223025862476465
 752.0521164085615  846.5236152430849  0.0010948336029342931    0.007722359376845842
1042.6359364889554  848.4611648033385      359.9921884692551    0.008563824050683623
 849.5551466754431  856.3807510193449      359.9981311543521       0.008287065045986
 565.7254013887438  907.1326336930654   0.006972188387454396    0.009079648602720928
 907.3444146439022  964.0451069521731     359.99664863785216    0.011744425965680799
  862.506712044473  970.4781140411695      359.9980410265317    0.011821041334613914
 908.1161872566082  979.3231794605475      359.9966660869291    0.012215048534687495
 898.1535542316711  1024.086471810929     359.99709209025787    0.013561029795291467
1065.3165288063421 1023.6180111589915     359.99196430178023    0.013996546366075233
 885.8561202107227  1034.852511146054      359.9974982005317    0.013858105073014042
 844.6926928337476 1036.6281479861989     359.99876537280085    0.013801777476721577
 983.4449525754154 1052.7150782306055      359.9945534348902    0.014668550839701361
 716.8225684444542  1093.099711547835   0.002838854903116837    0.015189503339235659
 547.2145120087068 1106.8176402343722   0.008077287098746213    0.015153738695364238

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -2.257917       -4.401084 pass
      -2.878086        7.578263 pass
      -2.867747       -9.201943 pass
       7.632520        8.764376 pass
       9.209809       -0.528774 pass
       4.007507        4.041863 pass
       1.419028       -9.956089 pass
      -4.445439       -9.400466 pass
       2.569402       -4.800474 pass
      -4.199029        4.893757 pass
      -1.303732        1.533476 pass
       0.678195        2.334970 pass
       0.178195       -1.531765 pass
       4.479892        4.338153 pass
       4.633555        2.659303 pass
       2.752476        5.593246 pass
      -0.522349        9.012021 pass
       3.695514       10.948805 pass
       1.393977        1.714199 pass
      -0.825992       -4.796371 pass
      -4.872001       -3.010379 pass
      -0.805909       -4.352802 pass
       0.324928        7.307263 pass
       1.318437        0.194997 pass
       2.002143        7.168932 pass
       7.356586       10.085717 pass
      -0.120094       -7.106895 pass
       1.689318       -7.833418 pass
       3.524165       -7.009737 pass
      -5.516526       -2.344246 pass
      -2.513591        5.566918 pass
       0.925556       -1.985689 pass
      -2.034395        9.183023 pass
       0.645428       -9.828845 pass
       0.555668        3.834166 pass
       1.422460        8.206067 pass
       3.436452        1.249140 pass
      -1.704296       -1.839922 pass
      -4.077492       -6.124573 pass
      -3.544061       -0.522782 pass
       5.969606       -2.223066 pass
      11.925961        1.467788 pass
       0.731129        3.756906 pass
       1.978808        6.912387 pass
       0.312945        7.374725 pass
       7.739584       10.071039 pass
       0.842185       -1.206960 pass
       2.996006       -0.823491 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_27_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_27_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.1220578902474647 0.7866569553698077 3.7478316539340475
Dec difference mean, median and std (units in mas) 0.9367027401338995 1.3584640321296497 5.969149439746364
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mark sources on image frame to see if the correct sources were found</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
<span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
<span class="n">apertures</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span> <span class="c1">#, alpha=0.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_28_0.png" src="../../../_images/exec_jwst_tweakreg_miri_test_28_0.png" />
</div>
</div>
</section>
<section id="run-calwebb-image3-with-tweakreg-turned-off">
<h3>Run calwebb_image3 with tweakreg turned off<a class="headerlink" href="#run-calwebb-image3-with-tweakreg-turned-off" title="Permalink to this headline">#</a></h3>
<p>Re-run the pipeline with tweakreg turned off to see if the differences found in the previous step are due to tweakreg alone, or differences in the distortion model that would show up in any run of the calwebb_image3 pipeline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image3 on the association table with tweakreg off</span>
    
<span class="c1"># set any specific parameters</span>
<span class="c1"># tweakreg parameters to allow data to run</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mf">3.318</span> <span class="c1">#3.27  # Gaussian kernel FWHM of objects expected, default=2.5</span>
<span class="n">minobj</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># minimum number of objects needed to match positions for a good fit, default=15</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mi">10</span> <span class="c1"># signal to noise threshold, default=5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># clipping limit, in sigma units, used when performing fit, default=3</span>
<span class="n">fit_geom</span> <span class="o">=</span><span class="s1">&#39;rshift&#39;</span> <span class="c1"># ftype of affine transformation to be considered when fitting catalogs, default=&#39;general&#39;</span>
<span class="n">use2dhist</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># boolean indicating whether to use 2D histogram to find initial offset, default=True</span>
   
<span class="n">pipe3</span><span class="o">=</span><span class="n">Image3Pipeline</span><span class="p">()</span>    
<span class="c1">#pipe3.tweakreg.kernel_fwhm = fwhm</span>
<span class="c1">#pipe3.tweakreg.snr_threshold = snr</span>
<span class="c1">#pipe3.tweakreg.minobj = minobj</span>
<span class="c1">#pipe3.tweakreg.sigma = sigma</span>
<span class="c1">#pipe3.tweakreg.fitgeometry = fit_geom</span>
<span class="c1">#pipe3.tweakreg.use2dhist = use2dhist</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>        <span class="c1"># test to see if this affects the final output</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">outlier_detection</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># this is set in later step so mis-alignments aren&#39;t &#39;hidden&#39;</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe3.output_dir = datadir</span>

<span class="c1"># run Image3</span>

<span class="c1">#im = pipe3.run(rtdata.input)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipe3</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_asnfile.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image 3 pipeline finished.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,809 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,811 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,814 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,816 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,818 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,820 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,822 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,984 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;starfield_50star4ptdither_asnfile.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:11,991 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;steps&#39;: {&#39;assign_mtwcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;assign_mtwcs&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;}, &#39;tweakreg&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: False, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 2.5, &#39;snr_threshold&#39;: 10.0, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 15, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: True, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3.0, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}, &#39;skymatch&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}, &#39;outlier_detection&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: None, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}, &#39;source_catalog&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:12,123 - stpipe.Image3Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39; reftypes = [&#39;abvegaoffset&#39;, &#39;apcorr&#39;, &#39;drizpars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:12,130 - stpipe.Image3Pipeline - INFO - Prefetch for ABVEGAOFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:12,132 - stpipe.Image3Pipeline - INFO - Prefetch for APCORR reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:12,134 - stpipe.Image3Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:12,136 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,396 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,399 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: False, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 2.5, &#39;snr_threshold&#39;: 10.0, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 15, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: True, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3.0, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,400 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,412 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,582 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,584 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,821 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,823 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() started on 2022-07-07 08:26:13.821831
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,824 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,825 - stpipe.Image3Pipeline.skymatch - INFO - Sky computation method: &#39;match&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,826 - stpipe.Image3Pipeline.skymatch - INFO - Sky matching direction: DOWN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,827 - stpipe.Image3Pipeline.skymatch - INFO - Sky subtraction from image data: OFF
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,828 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:13,829 - stpipe.Image3Pipeline.skymatch - INFO - ----  Computing differences in sky values in overlapping regions.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,701 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00238358
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,706 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0124171
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,707 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00851901
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,708 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00484789
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,709 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,709 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00727946
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,711 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00377957
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,712 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0117165
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,712 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,713 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() ended on 2022-07-07 08:26:27.712916
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,715 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() TOTAL RUN TIME: 0:00:13.891085
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,715 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,755 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:27,997 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,000 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;crf&#39;, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,001 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,014 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,186 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,190 - stpipe.Image3Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,212 - stpipe.Image3Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:28,400 - stpipe.Image3Pipeline.resample - INFO - Blending metadata for starfield_50star4ptdither_combined.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:29,117 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:29,752 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:30,862 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:31,949 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:33,105 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:34,163 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:35,225 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:36,283 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:37,221 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:37,595 - stpipe.Image3Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:38,195 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:39,231 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:40,162 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:41,104 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:42,046 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:42,983 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:43,926 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:44,868 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:45,225 - stpipe.Image3Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:45,808 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:46,747 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:47,693 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:48,635 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:49,587 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:50,564 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:51,500 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:52,462 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:52,829 - stpipe.Image3Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:53,442 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:54,399 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:55,374 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:56,333 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:57,265 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:58,226 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:26:59,169 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:00,091 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:00,537 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021880629 -0.020262886 0.024954079 0.014759789 359.990667431 0.017768647 359.987593981 -0.017254027
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:00,983 - stpipe.Image3Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_combined_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:00,984 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,225 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1142, 1118) from starfield_50star4ptdither_combined_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,228 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,248 - stpipe.Image3Pipeline.source_catalog - INFO - Using APCORR reference file: /grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,260 - stpipe.Image3Pipeline.source_catalog - INFO - Using ABVEGAOFFSET reference file: /grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,261 - stpipe.Image3Pipeline.source_catalog - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,262 - stpipe.Image3Pipeline.source_catalog - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,262 - stpipe.Image3Pipeline.source_catalog - INFO - Filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,263 - stpipe.Image3Pipeline.source_catalog - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,318 - stpipe.Image3Pipeline.source_catalog - INFO - AB to Vega magnitude offset 5.49349
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:01,882 - stpipe.Image3Pipeline.source_catalog - INFO - Detected 642 sources
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:02,602 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote source catalog: starfield_50star4ptdither_combined_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:02,719 - stpipe.Image3Pipeline.source_catalog - INFO - Saved model in starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:02,722 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote segmentation map: starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:02,724 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:02,726 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image 3 pipeline finished.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_combined_i2d.fits&#39;</span><span class="p">)</span>
<span class="n">pixarea</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel area in steradians&#39;</span><span class="p">,</span> <span class="n">pixarea</span><span class="p">)</span>

<span class="c1"># pull out data portion of input file</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># print stats on input image</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pixel area in steradians 2.84403609523084e-13
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image mean, median and std 10.2361145 10.815056 46.592316
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run DAOStarFinder to find sources in image</span>

<span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>    

<span class="c1">#sources.pprint_all()</span>
<span class="c1">#print(sources[&#39;xcentroid&#39;,&#39;ycentroid&#39;,&#39;peak&#39;])   </span>

<span class="c1"># Create apertures for x,y positions</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
<span class="c1">#print(positions)</span>

<span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
<span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>


<span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
<span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

<span class="c1"># add RA, Dec to sources table</span>

<span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
<span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

<span class="c1"># print RA, Dec for each x, y position found</span>
<span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

<span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="c1">#print(&#39;       RA found       Dec found    RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;)</span>

<span class="n">deltara_twoff</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">deltadec_twoff</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Put ra, dec coords into a table</span>
<span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
<span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    
<span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
<span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>    
<span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
<span class="c1"># Find where the catalogs match</span>
    
<span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
<span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
<span class="c1">#print(cat1_matched)</span>
    
<span class="c1"># Get differences in RA, Dec</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
<span class="c1">#print(ra_diff)</span>
    
<span class="c1"># put differences in milliarcseconds</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    
    
<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
<span class="c1"># Find if the differences are within the allowed 30 mas range</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
    <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
    <span class="n">deltara_twoff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">deltadec_twoff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
<span class="c1"># Plot ra and dec differences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">deltara_twoff</span><span class="p">,</span><span class="n">deltadec_twoff</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot should show no differences greater than 30 milliarcseconds      </span>
    
<span class="n">meanRAdiff_twoff</span><span class="p">,</span> <span class="n">medianRAdiff_twoff</span><span class="p">,</span> <span class="n">stdRAdiff_twoff</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltara_twoff</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_twoff</span><span class="p">,</span> <span class="n">medianDecdiff_twoff</span><span class="p">,</span> <span class="n">stdDecdiff_twoff</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltadec_twoff</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twoff</span><span class="p">,</span> <span class="n">medianRAdiff_twoff</span><span class="p">,</span> <span class="n">stdRAdiff_twoff</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twoff</span><span class="p">,</span> <span class="n">medianDecdiff_twoff</span><span class="p">,</span> <span class="n">stdDecdiff_twoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
  695.509656871691  122.7731352114558  0.0008812659609691389   -0.014625883703879764
 772.6300595966864 126.25881302467741      359.9985255304914   -0.014311432297556579
 973.4845950402436 151.46570797371396      359.9924335941968   -0.012997833804871057
1041.0402466411213 156.08608009673736      359.9903742429169   -0.012674325214607936
 531.6452188195361 182.86753119415394   0.006068366193812612    -0.01322392452879569
 795.8214655360165 192.30749063274445      359.9979920560416   -0.012223447150665144
460.99769105256127 203.83678397784786   0.008291407811122661   -0.012770975546914774
 516.4628063689622  217.4606335961348   0.006627078012817703   -0.012203888945226294
 573.6994021947937  231.0193109064272   0.004908245329639044   -0.011634033462371511
 900.3859136776463 253.34330822322437      359.9949495548864    -0.01007019730194129
  637.708245818547  262.2008563231789  0.0030291506092848127   -0.010505496557613469
 944.2562842384623 281.07490610055163      359.9936787789667   -0.009101661236103028
1031.0661141117635  281.7179049139111      359.9910182393249    -0.00884831159525946
 467.0184085721607 295.54106545726313   0.008353567925331973   -0.009942399598990641
 478.6565803963265 301.97006924047713   0.008013952585532553   -0.009713914263575974
 552.5367568466523  312.8336146130442   0.005777443801580524   -0.009181920011768086
  794.127692732562  323.0485730289401     359.99839586217956   -0.008218458664262691
 558.7639406087513  327.6027950065812   0.005626217606603594   -0.008712221967393293
 936.3231577947308 341.63997840859406       359.994085068829  -0.0072656114739013365
 805.0204475654554  356.2443721575341     359.99815114430726   -0.007171099578474511
 443.9372092079042  379.6654935753477   0.009287821514258648     -0.0074246029669193
 728.6632139445306 405.34358623509627  0.0006249960541624848    -0.00587083184410659
 784.5768956004719 428.89514515592185     359.99897362803426   -0.004998076547932882
 622.6304211871228 468.96109177550403   0.004048006114011227  -0.0042051848422714425
 520.7455125398136  537.6445986045956   0.007357443587025448   -0.002373011331521497
 753.4598047070443  562.0323274965849   0.000286232470353947   -0.000998791325577401
 792.8109640403267  572.2169857720495      359.9991068271251  -0.0005805445564021976
486.09457642816034  574.6754424148912   0.008519773702712972  -0.0013306108185809514
 758.4577179306596  586.5338303934009 0.00019889782779442284 -0.00023393225227569172
 398.7106717571099  625.6783622783004   0.011336913103498644  -1.636416408001521e-06
 944.4295010692393  671.4457380739567     359.99472406672623    0.002870636226253774
 978.0690865462941  680.8076797081463     359.99371760889875   0.0032482805451646926
 1058.588937709454    696.49510324771      359.9912904582015    0.003946081963119714
  857.547023269631   704.977199467162      359.9974788076654   0.0036651481680367993
 902.8384189068905  738.9556566097834      359.9961812640481     0.00482908627920487
 547.0109525240118   815.625633581739  0.0073000659204109355   0.0062227553640388025
 752.0558612969892  846.5212520297385  0.0010949297362069456    0.007722091993690046
1042.6396940274271  848.4676496804013      359.9921885888132    0.008563828053424911
 849.5592405160942  856.3793293322623      359.9981312423177    0.008286827476538302
 565.7294483429421  907.1298340331786   0.006972274082415248    0.009079368647656664
 907.3482738443788  964.0436048130729      359.9966487327971    0.011744185297462165
 862.5108061003773    970.47576319128     359.99804111199006    0.011820775270320575
 908.1191721884411  979.3224928021699      359.9966662108807     0.01221483052260458
 898.1581545365151  1024.085757670425      359.9970921645955    0.013560815287809962
1065.3205160817738 1023.6310691618894       359.991964431983    0.013996752570673766
 885.8616902767498 1034.8512069965896       359.997498243541    0.013857875081145419
 844.6965349489227 1036.6338392636655      359.9987654876293    0.013801757369077816
 983.4483590478977 1052.7253182209324     359.99455357532077     0.01466866905882884
 716.8251819676394 1093.1051897055665  0.0028390068363006614      0.0151894733891785
 547.2224685172362 1106.8229293866273   0.008077274665415983    0.015153717328400719

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.844534       -4.473471 pass
      -2.723253        6.750292 pass
      -2.763107      -10.048772 pass
       7.480846        7.599797 pass
       9.109769       -1.556271 pass
       4.119506        3.241517 pass
       1.596913      -10.840793 pass
      -4.292405      -10.266595 pass
       2.785330       -5.798947 pass
      -3.852950        3.931177 pass
      -0.961930        0.667071 pass
       0.986697        1.327132 pass
       0.247784       -2.201306 pass
       4.483187        3.479535 pass
       4.588795        2.582382 pass
       2.804280        4.819550 pass
       0.024611        8.904201 pass
       4.003164        9.990973 pass
       1.318298        0.271696 pass
      -0.622350       -5.560403 pass
      -4.939077       -3.875573 pass
      -0.642549       -5.770681 pass
       0.592544        6.535036 pass
       1.649525        0.295067 pass
       1.997591        6.489713 pass
       7.401750        9.190258 pass
       0.237313       -8.080689 pass
       2.119727       -7.819008 pass
       3.622010       -7.865432 pass
      -5.602314       -3.312042 pass
      -2.044861        6.309254 pass
       0.874501       -1.170773 pass
      -1.528845        9.608612 pass
       0.950573      -10.489395 pass
       0.872344        2.978916 pass
       1.468120        7.288031 pass
       3.429308        0.308651 pass
      -1.407965       -2.590037 pass
      -3.967820       -6.956108 pass
      -3.359786       -1.309585 pass
       5.739109       -3.001698 pass
      11.757459        0.418666 pass
       0.783384        2.800917 pass
       2.044531        5.761444 pass
       0.759170        6.589881 pass
       7.742193        9.012393 pass
       0.861570       -1.121743 pass
       3.103846       -1.651191 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_32_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_32_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.2708751343637914 0.912537143449299 3.6629026624266148
Dec difference mean, median and std (units in mas) 0.23732602327684807 0.3018591787326205 5.992955377971589
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mark sources on image frame to see if the correct sources were found</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
<span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
<span class="n">apertures</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span> <span class="c1">#, alpha=0.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_33_0.png" src="../../../_images/exec_jwst_tweakreg_miri_test_33_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare stats across tests:</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All units are milliarcseconds for statistics&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in individual calibrated files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_cal</span><span class="p">,</span> <span class="n">medianRAdiff_cal</span><span class="p">,</span> <span class="n">stdRAdiff_cal</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_cal</span><span class="p">,</span> <span class="n">medianDecdiff_cal</span><span class="p">,</span> <span class="n">stdDecdiff_cal</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in individual i2d files when run with tweakreg on&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_i2d</span><span class="p">,</span> <span class="n">medianRAdiff_i2d</span><span class="p">,</span> <span class="n">stdRAdiff_i2d</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_i2d</span><span class="p">,</span> <span class="n">medianDecdiff_i2d</span><span class="p">,</span> <span class="n">stdDecdiff_i2d</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in combined i2d file when run with tweakreg on&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twon</span><span class="p">,</span> <span class="n">medianRAdiff_twon</span><span class="p">,</span> <span class="n">stdRAdiff_twon</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twon</span><span class="p">,</span> <span class="n">medianDecdiff_twon</span><span class="p">,</span> <span class="n">stdDecdiff_twon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in combined i2d file when run with tweakreg off&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twoff</span><span class="p">,</span> <span class="n">medianRAdiff_twoff</span><span class="p">,</span> <span class="n">stdRAdiff_twoff</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twoff</span><span class="p">,</span> <span class="n">medianDecdiff_twoff</span><span class="p">,</span> <span class="n">stdDecdiff_twoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All units are milliarcseconds for statistics
Statistics on differences between RA and Dec in individual calibrated files
RA difference mean, median and std 1.1037660880047775 0.9281835036028911 3.549202125823858
Dec difference mean, median and std -0.06135758681286737 1.0161649008182116 5.550928948928192

Statistics on differences between RA and Dec in individual i2d files when run with tweakreg on
RA difference mean, median and std 1.436019300064677 1.190991620497392 3.8372740253085325
Dec difference mean, median and std -0.09997223853214 0.1772512706485485 7.883142220258062

Statistics on differences between RA and Dec in combined i2d file when run with tweakreg on
RA difference mean, median and std 1.1220578902474647 0.7866569553698077 3.7478316539340475
Dec difference mean, median and std 0.9367027401338995 1.3584640321296497 5.969149439746364

Statistics on differences between RA and Dec in combined i2d file when run with tweakreg off
RA difference mean, median and std 1.2708751343637914 0.912537143449299 3.6629026624266148
Dec difference mean, median and std 0.23732602327684807 0.3018591787326205 5.992955377971589
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="test-2-see-what-happens-with-tweakreg-when-there-are-shifts-between-images-not-tracked-in-the-wcs">
<h2>Test # 2: See what happens with tweakreg when there are shifts between images not tracked in the wcs.<a class="headerlink" href="#test-2-see-what-happens-with-tweakreg-when-there-are-shifts-between-images-not-tracked-in-the-wcs" title="Permalink to this headline">#</a></h2>
<p>This test uses MIRISim data using only the simulated dithers, and one shifted image. Two exposures each of four different dithers.</p>
<p>First look at the cal images out of calwebb_image2.</p>
<ul class="simple">
<li><p>Apply specified shift (~0.5 arcseconds) to x and y positions of one image</p></li>
<li><p>Use DAOStarFinder to get the x,y positions of the stars in each image</p></li>
<li><p>Use wcs info from image to convert x,y positions to RA, Dec</p></li>
<li><p>Compare the RA, Dec calculated values to the RA, Dec positions put into the simulated images</p></li>
<li><p>Get statistics on the differences of the calculated and input positions in units of mas</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply shifts to files in input list</span>

<span class="c1"># Read in a single rate.fits file, modify header values RA_REF and DEC_REF by adding in a shift of less than one </span>
<span class="c1"># arcsecond, which is the default search radius for tweakreg</span>
<span class="c1"># 0.72 arcseconds ~ 0.0002 degrees</span>
<span class="c1"># 0.5 arcseconds ~ 0.00014 degrees</span>

<span class="n">origfile</span> <span class="o">=</span> <span class="s1">&#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&#39;</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">origfile</span><span class="p">)</span>

<span class="c1"># modify header vaules</span>

<span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcsinfo</span><span class="o">.</span><span class="n">ra_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcsinfo</span><span class="o">.</span><span class="n">ra_ref</span> <span class="o">+</span> <span class="mf">0.00014</span>
<span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcsinfo</span><span class="o">.</span><span class="n">dec_ref</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcsinfo</span><span class="o">.</span><span class="n">dec_ref</span> <span class="o">+</span> <span class="mf">0.00014</span>

<span class="c1"># Run file through calwebb_image2 to get cal.fits version and then retest steps in Test # 1.</span>

<span class="c1"># create an object for the pipeline    </span>
<span class="n">pipe2</span> <span class="o">=</span> <span class="n">Image2Pipeline</span><span class="p">()</span>
<span class="n">pipe2</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe2.output_file = rampfile+&#39;_cal.fits&#39;</span>
<span class="c1">#pipe2.output_dir = datadir</span>
<span class="n">pipe2</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:03,877 - stpipe.Image2Pipeline - INFO - Image2Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:03,879 - stpipe.Image2Pipeline.bkg_subtract - INFO - BackgroundStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:03,882 - stpipe.Image2Pipeline.assign_wcs - INFO - AssignWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:03,883 - stpipe.Image2Pipeline.flat_field - INFO - FlatFieldStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:03,886 - stpipe.Image2Pipeline.photom - INFO - PhotomStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:03,888 - stpipe.Image2Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,112 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,118 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_bsub&#39;: False, &#39;steps&#39;: {&#39;bkg_subtract&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_combined_background&#39;: False, &#39;sigma&#39;: 3.0, &#39;maxiters&#39;: None, &#39;wfss_mmag_extract&#39;: None}, &#39;assign_wcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}, &#39;flat_field&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}, &#39;photom&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,126 - stpipe.Image2Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&#39; reftypes = [&#39;area&#39;, &#39;camera&#39;, &#39;collimator&#39;, &#39;dflat&#39;, &#39;disperser&#39;, &#39;distortion&#39;, &#39;drizpars&#39;, &#39;fflat&#39;, &#39;filteroffset&#39;, &#39;flat&#39;, &#39;fore&#39;, &#39;fpa&#39;, &#39;ifufore&#39;, &#39;ifupost&#39;, &#39;ifuslicer&#39;, &#39;msa&#39;, &#39;ote&#39;, &#39;photom&#39;, &#39;regions&#39;, &#39;sflat&#39;, &#39;specwcs&#39;, &#39;wavelengthrange&#39;, &#39;wfssbkg&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,138 - stpipe.Image2Pipeline - INFO - Prefetch for AREA reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_area_0004.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,141 - stpipe.Image2Pipeline - INFO - Prefetch for CAMERA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,142 - stpipe.Image2Pipeline - INFO - Prefetch for COLLIMATOR reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,143 - stpipe.Image2Pipeline - INFO - Prefetch for DFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,144 - stpipe.Image2Pipeline - INFO - Prefetch for DISPERSER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,145 - stpipe.Image2Pipeline - INFO - Prefetch for DISTORTION reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,147 - stpipe.Image2Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,149 - stpipe.Image2Pipeline - INFO - Prefetch for FFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,150 - stpipe.Image2Pipeline - INFO - Prefetch for FILTEROFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,152 - stpipe.Image2Pipeline - INFO - Prefetch for FLAT reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_flat_0626.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,154 - stpipe.Image2Pipeline - INFO - Prefetch for FORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,155 - stpipe.Image2Pipeline - INFO - Prefetch for FPA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,156 - stpipe.Image2Pipeline - INFO - Prefetch for IFUFORE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,157 - stpipe.Image2Pipeline - INFO - Prefetch for IFUPOST reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,158 - stpipe.Image2Pipeline - INFO - Prefetch for IFUSLICER reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,159 - stpipe.Image2Pipeline - INFO - Prefetch for MSA reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,159 - stpipe.Image2Pipeline - INFO - Prefetch for OTE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,160 - stpipe.Image2Pipeline - INFO - Prefetch for PHOTOM reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,163 - stpipe.Image2Pipeline - INFO - Prefetch for REGIONS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,163 - stpipe.Image2Pipeline - INFO - Prefetch for SFLAT reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,164 - stpipe.Image2Pipeline - INFO - Prefetch for SPECWCS reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,165 - stpipe.Image2Pipeline - INFO - Prefetch for WAVELENGTHRANGE reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,165 - stpipe.Image2Pipeline - INFO - Prefetch for WFSSBKG reference file is &#39;N/A&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,166 - stpipe.Image2Pipeline - INFO - Starting calwebb_image2 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,218 - stpipe.Image2Pipeline - INFO - Processing product starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,219 - stpipe.Image2Pipeline - INFO - Working on input &lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt; ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,388 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,390 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;sip_approx&#39;: True, &#39;sip_max_pix_error&#39;: 0.25, &#39;sip_degree&#39;: None, &#39;sip_max_inv_pix_error&#39;: 0.25, &#39;sip_inv_degree&#39;: None, &#39;sip_npoints&#39;: 32, &#39;slit_y_low&#39;: -0.55, &#39;slit_y_high&#39;: 0.55}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,577 - stpipe.Image2Pipeline.assign_wcs - INFO - Created a MIRI mir_image pipeline with references {&#39;distortion&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_distortion_0028.asdf&#39;, &#39;filteroffset&#39;: &#39;/grp/crds/cache/references/jwst/jwst_miri_filteroffset_0005.asdf&#39;, &#39;specwcs&#39;: None, &#39;regions&#39;: None, &#39;wavelengthrange&#39;: None, &#39;camera&#39;: None, &#39;collimator&#39;: None, &#39;disperser&#39;: None, &#39;fore&#39;: None, &#39;fpa&#39;: None, &#39;msa&#39;: None, &#39;ote&#39;: None, &#39;ifupost&#39;: None, &#39;ifufore&#39;: None, &#39;ifuslicer&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,651 - stpipe.Image2Pipeline.assign_wcs - INFO - Update S_REGION to POLYGON ICRS  0.020312025 -0.017329545 0.022778707 0.013855672 359.991476319 0.016448478 359.988668642 -0.014750638
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,652 - stpipe.Image2Pipeline.assign_wcs - INFO - assign_wcs updated S_REGION to POLYGON ICRS  0.020312025 -0.017329545 0.022778707 0.013855672 359.991476319 0.016448478 359.988668642 -0.014750638
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,653 - stpipe.Image2Pipeline.assign_wcs - INFO - COMPLETED assign_wcs
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,689 - stpipe.Image2Pipeline.assign_wcs - WARNING - /internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/miniconda3/envs/jwst_validation_notebooks/lib/python3.10/site-packages/astropy/modeling/fitting.py:789: AstropyUserWarning: The fit may be poorly conditioned

  warnings.warn(&quot;The fit may be poorly conditioned\n&quot;,
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,747 - stpipe.Image2Pipeline.assign_wcs - INFO - Step assign_wcs done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,918 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:04,920 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_interpolated_flat&#39;: False, &#39;user_supplied_flat&#39;: None, &#39;inverse&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,029 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_PARTIAL_DATA does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,030 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_LOW_QUAL does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,032 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword CDP_UNRELIABLE_ERROR does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,039 - stpipe.Image2Pipeline.flat_field - WARNING - Keyword DIFF_PATTERN does not correspond to an existing DQ mnemonic, so will be ignored
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,174 - stpipe.Image2Pipeline.flat_field - INFO - Step flat_field done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,349 - stpipe.Image2Pipeline.photom - INFO - Step photom running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,351 - stpipe.Image2Pipeline.photom - INFO - Step photom parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;inverse&#39;: False, &#39;source_type&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,377 - stpipe.Image2Pipeline.photom - INFO - Using photom reference file: /grp/crds/cache/references/jwst/jwst_miri_photom_0073.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,378 - stpipe.Image2Pipeline.photom - INFO - Using area reference file: /grp/crds/cache/references/jwst/jwst_miri_area_0004.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,461 - stpipe.Image2Pipeline.photom - INFO - Using instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,462 - stpipe.Image2Pipeline.photom - INFO -  detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,463 - stpipe.Image2Pipeline.photom - INFO -  exp_type: MIR_IMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,464 - stpipe.Image2Pipeline.photom - INFO -  filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,512 - stpipe.Image2Pipeline.photom - INFO - Pixel area map copied to output.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,515 - stpipe.Image2Pipeline.photom - INFO -  subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,516 - stpipe.Image2Pipeline.photom - WARNING - Expected to find one matching row in table, found 0.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,517 - stpipe.Image2Pipeline.photom - INFO - PHOTMJSR value: 2.54947
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,535 - stpipe.Image2Pipeline.photom - INFO - Step photom done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,708 - stpipe.Image2Pipeline.resample - INFO - Step resample running with args (&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,711 - stpipe.Image2Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,747 - stpipe.Image2Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:05,873 - stpipe.Image2Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:06,454 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:06,804 - stpipe.Image2Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:07,373 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:07,730 - stpipe.Image2Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:08,301 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:08,655 - stpipe.Image2Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,227 - stpipe.Image2Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1022, 1031)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,600 - stpipe.Image2Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.020308782 -0.017542172 0.023059277 0.013800362 359.991440731 0.016575079 359.988690236 -0.014767455
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,722 - stpipe.Image2Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,723 - stpipe.Image2Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,725 - stpipe.Image2Pipeline - INFO - Finished processing product starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_rate
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,726 - stpipe.Image2Pipeline - INFO - ... ending calwebb_image2
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,727 - stpipe.Image2Pipeline - INFO - Results used CRDS context: jwst_0916.pmap
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,924 - stpipe.Image2Pipeline - INFO - Saved model in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:09,925 - stpipe.Image2Pipeline - INFO - Step Image2Pipeline done
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;ImageModel(1024, 1032) from starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits&gt;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># find stars and get RA, Dec from *_cal.fits files</span>

<span class="c1"># Run DAOStarFinder to find sources in image</span>
<span class="n">allRAdiff_cal</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">allDecdiff_cal</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">calimage</span> <span class="ow">in</span> <span class="n">imagelist</span><span class="p">:</span>
    <span class="n">image</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">calimage</span><span class="p">)</span>
    
    <span class="c1"># pull out data portion of input file</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>
    
    <span class="c1"># print stats on input image</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">calimage</span><span class="p">)</span>
    <span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>

    <span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

    <span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
    <span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>      

    <span class="c1"># Create apertures for x,y positions</span>
    <span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
    <span class="c1">#print(positions)</span>

    <span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
    <span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>
    
    <span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
    <span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

    <span class="c1"># add RA, Dec to sources table</span>

    <span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
    <span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
    <span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
    <span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

    <span class="c1"># print RA, Dec for each x, y position found</span>
    <span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

    <span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
    <span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">()</span>
    
    <span class="c1"># read in text file with RA and Dec input coordinates</span>
    <span class="n">RA_in</span><span class="p">,</span> <span class="n">Dec_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="n">coords</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># put RA and Dec into floats</span>
    <span class="n">RA_sim</span> <span class="o">=</span> <span class="n">RA_in</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">Dec_sim</span> <span class="o">=</span> <span class="n">Dec_in</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    
    <span class="c1"># Put ra, dec coords into a table</span>
    <span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    <span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    

    <span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
    <span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
    <span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
    <span class="c1"># Find where the catalogs match</span>
    
    <span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
    <span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
    <span class="c1">#print(cat1_matched)</span>
    
    <span class="c1"># Get differences in RA, Dec</span>
    <span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
    <span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
    <span class="c1">#print(ra_diff)</span>
    
    <span class="c1"># put differences in milliarcseconds</span>
    <span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    <span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
    
    
    <span class="c1"># Compare input RA, Dec to found RA, Dec</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
    <span class="c1"># Find if the differences are within the allowed 30 mas range</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
        <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
        <span class="n">allRAdiff_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">allDecdiff_cal</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
            <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
    <span class="c1"># Plot ra and dec differences</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">,</span><span class="n">dec_diff</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="c1"># Plot should show no differences greater than 30 milliarcseconds  </span>
    
<span class="n">meanRAdiff_cal</span><span class="p">,</span> <span class="n">medianRAdiff_cal</span><span class="p">,</span> <span class="n">stdRAdiff_cal</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">allRAdiff_cal</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_cal</span><span class="p">,</span> <span class="n">medianDecdiff_cal</span><span class="p">,</span> <span class="n">stdDecdiff_cal</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">allDecdiff_cal</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_cal</span><span class="p">,</span> <span class="n">medianRAdiff_cal</span><span class="p">,</span> <span class="n">stdRAdiff_cal</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_cal</span><span class="p">,</span> <span class="n">medianDecdiff_cal</span><span class="p">,</span> <span class="n">stdDecdiff_cal</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.393542 10.826687 55.011623
    xcentroid          ycentroid                RA                   Dec          
------------------ ------------------ --------------------- ----------------------
 608.5415674187961 2.5119766176307223 0.0008812919624467749  -0.014594789515541495
 685.5194495798157 5.5188105009736175     359.9985262521632  -0.014309517462321978
 886.3394041097413 32.119070281158955    359.99243205390275  -0.012997454423196865
    953.8640393199  37.04011242844017     359.9903742953238  -0.012674257323148128
444.47609551197064 61.922582668650286  0.006066875156909462  -0.013223542150700983
  708.539078792773  73.05874981354657     359.9979903713137   -0.01222441448341229
373.69156711571156  82.73445867221936   0.00829150779169885  -0.012772340592118013
 429.1719580852977   96.9350873606011 0.0066252609207797806   -0.01220541183653611
486.33656250883286 111.09479540127342 0.0049071267763785495  -0.011634212317900124
  812.818016502769 135.61499300669485     359.9949510782622  -0.010070810306428344
 550.2541709849713 143.00728324989907  0.003027257861743836  -0.010506369320026828
  856.669674639311   163.941532747077    359.99367943542825  -0.009101781916248714
 943.4770993700253 165.11663853495494    359.99102011241314  -0.008847567308604684
 379.3675519242359 175.61124295871804  0.008352878219398573  -0.009943295128109814
 390.9846006266449 182.23371017799838  0.008013454071705377  -0.009712529245328462
464.78741113955334  193.6264598801728  0.005779073595006636  -0.009180116965875892
 706.4675734066059  205.4374537771488    359.99839582116016  -0.008215197294039717
 471.0120867553802 208.50201007466694  0.005626274700481911  -0.008710684120420042
 848.6281552463014 225.05905956689554    359.99408676890266  -0.007263193491265538
 717.2680096211556 238.78542812577177     359.9981519861035  -0.007170315851777638
 640.8254738397458  287.3850110723211  0.000623866158697791  -0.005872632451303791
  696.647862932052  311.4570263322215     359.9989761969678  -0.004996253375845009
 534.5080406150863  350.3689320851547  0.004046584544183354  -0.004204164820881179
432.09694109427744  418.3411466005772  0.007357153703276762  -0.002371455183037188
 665.3824794715022  444.0669679431664 0.0002867232340403056 -0.0009972307220539013
 704.8442236777602  454.5198152664274      359.999107133171  -0.000579048618063702
 397.1594591938331  455.0466542459958  0.008519471619160033 -0.0013305641705300796
  670.371981463498  468.5413077513855 0.0001994299693774992 -0.0002316467303177302
  857.038262255815  554.7270783588783     359.9947248543858  0.0028686960910657405
 890.8576431575337  564.4910139563399    359.99371776586474  0.0032483115672433368
 971.7410107427238  581.0301273603288    359.99129032918023    0.00394460501697729
 769.8182651492822  587.3991534539016    359.99748044484795   0.003666592325947924
 815.4649708309157    621.70236297117     359.9961801265635   0.004829526225418064
 457.3069563867852  695.4839439228793  0.007299417401295441   0.006221092374688667
 663.7522305772287  727.5606487303378 0.0010956440902465164   0.007718343531580888
 956.3618123173031  732.7240339832271    359.99218701382824   0.008563603509703683
  762.012822991855  738.3493833972611     359.9981307363725   0.008284707812831934
 475.7809197718267  787.1175421157932  0.006972911155176817   0.009078806556077986
 820.4534971417371  846.8578899992237     359.9966476213018   0.011744457761829495
 775.2535830946825   852.768447668375    359.99803938143555   0.011819236104458666
 821.2496942034151  862.1639462053263     359.9966653732796   0.012214125952000665
 811.2868482580394  907.0113339507423     359.9970911975458   0.013560409281168691
 979.8333015194123  908.5670123070836    359.99196470996947   0.013994547909521428
 798.8612490361676   917.691370731965     359.9974981525205   0.013857233119648482
 757.3289724429274   919.148267240695    359.99876455354797    0.01380396414649375
 897.3875798865843  936.7583695764755    359.99455365921426   0.014667036969114682
 628.0267683752969  974.7373812387208 0.0028386713057134997   0.015187773153686161
 456.3574329732993  987.6670781265088  0.008076589320650552   0.015153509703638865

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -5.207227        3.470927 pass
      -3.050926        4.439231 pass
      -0.996357       -4.430599 pass
       0.939315        2.117388 pass
      11.707788        5.337136 pass
       7.149973        6.062934 pass
       0.553332       -5.238659 pass
       1.601453       -5.067627 pass
       1.697829       -5.631014 pass
      -1.281275       -9.563286 pass
      -4.963313        1.647943 pass
       3.280159       -0.696398 pass
       6.368050        6.503431 pass
       0.456395        2.835656 pass
       2.121554        1.834933 pass
       5.167542        4.385102 pass
      -1.183299        2.783353 pass
      -2.226832        4.449976 pass
      -4.049435        1.648257 pass
       0.479416       -0.175025 pass
       4.309084        2.687847 pass
      -2.888835        5.073412 pass
       1.185049       -5.021939 pass
       7.481744        4.282897 pass
       1.336729        5.707860 pass
      -2.097355      -14.067451 pass
      -3.550218       -8.627365 pass
      -1.495641       -4.193355 pass
       0.264942        3.178923 pass
      -1.044110       -1.627526 pass
       1.063166       -0.926363 pass
      -1.226829        3.733089 pass
      -3.144371       -8.905588 pass
      -0.949059       -4.651874 pass
       1.828050        2.373868 pass
       1.634658        5.294717 pass
      -0.842887       -2.478358 pass
      -2.052110        1.271771 pass
      -0.524211       -8.294072 pass
       0.194050       -1.635924 pass
       0.988922        8.337166 pass
      -0.438410        2.537539 pass
      -2.256193        4.053427 pass
       0.928302        5.870448 pass
       7.604687        1.557689 pass
       2.956177       10.089741 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.394609 10.827406 55.007805
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 608.5461714111817 2.5131153270429225  0.0008811535076687153   -0.014594743852346248
 685.5165542363047  5.522005289569982      359.9985263490218   -0.014309429398466314
 886.3377102041173  32.12032234845156     359.99243210897583   -0.012997421405947096
  953.858650908105 37.038714754591744     359.99037445698593   -0.012674313169426505
 444.4760693354769 61.921174725845646   0.006066872395400456   -0.013223584608591675
 708.5375051993097  73.05653065791925      359.9979904139565   -0.012224485327696166
 373.6920713251912  82.73362445593573   0.008291490212003361   -0.012772364504572807
 429.1710480615856   96.9361473590585  0.0066252915340002895   -0.012205382067991825
486.33656507950644  111.0929968883717   0.004907122116154008   -0.011634266764592633
 812.8169111357602 135.61175256667016      359.9949511037864   -0.010070911221503798
 550.2506815991629  143.0082980431957   0.003027367540328657   -0.010506347247348124
  856.666574138678 163.94025852158114     359.99367952721065   -0.009101828365468878
 943.4725862005791  165.1160847976937      359.9910202493613   -0.008847595467969826
379.36603019242443 175.61024962497083   0.008352922362656737   -0.009943329177441321
 390.9868475960879 182.23166489994372   0.008013379965691413   -0.009712585890208804
 464.7874252509071 193.62567333213758    0.00577907114864779   -0.009180140912869495
 706.4641169351513 205.44112744056818     359.99839593680207    -0.00821509388991974
 471.0128665836423 208.50627769129127   0.005626261725713367   -0.008710551901505456
 848.6275210111238 225.06047475891756      359.9940867921008   -0.007263151929571056
 717.2689344128596 238.78521514635145     359.99815195717895    -0.00717032006242251
 640.8223349387042  287.3876388648545  0.0006239692904470007   -0.005872559700757004
  696.649043669952  311.4598971472418      359.9989761683857   -0.004996162404240498
 534.5084442349707 350.37099693129943   0.004046577556716191    -0.00420410034973628
432.09618931856727  418.3419770115535    0.00735717883136822  -0.0023714315343018777
 665.3849005558758  444.0678377273824 0.00028665146587420707  -0.0009971980130367556
 704.8443491573435  454.5162471160152     359.99910711974667  -0.0005791581225037081
397.16046445276737 455.04418207058586   0.008519434584673621  -0.0013306377093679634
  670.369979887094 468.54191939872646 0.00019949283603036086 -0.00023163279961321113
 857.0397112859981  554.7274188893667     359.99472481101884    0.002868709976703097
 890.8578568837343  564.4940272892437      359.9937177677001   0.0032484046780216053
 971.7393022215407  581.0309188009905      359.9912903836618     0.00394462536976469
 769.8173270515161  587.4004878427158      359.9974804771503   0.0036666311271152862
  815.465578086775   621.703407654051     359.99618011089166    0.004829559764486471
457.30976496488194  695.4853021868445   0.007299335355773578    0.006221141229410244
 663.7519356998866  727.5614345432715   0.001095655178011445   0.0077183669280205805
 956.3618069104094  732.7218311115429       359.992187007799    0.008563535989006233
 762.0142852652106  738.3497994697638      359.9981306929402    0.008284724036588096
475.77984981811954  787.1204617950921   0.006972951205655511    0.009078893288449403
 820.4530900979327  846.8571043631532     359.99664763153703    0.011744432795549499
 775.2564955710666  852.7653273770777      359.9980392843252    0.011819147585457136
 821.2501449789805  862.1642779577346        359.99666536047     0.01221413713982896
 811.2847022881816  907.0118295127575     359.99709126416207    0.013560419393838364
 979.8325668501478   908.565764385858     359.99196472886814     0.01399450816804262
 798.8585276961667  917.6911602746128      359.9974982346854    0.013857220326868504
 757.3271158499823  919.1512240355106      359.9987646179659    0.013804049958067223
 897.3858508178394  936.7555527010198      359.9945537040557    0.014666947106948183
   628.02654407017  974.7375500319221  0.0028386785543619677    0.015187777746555775
 456.3583448650907  987.6657631916269   0.008076558329031239    0.015153471999927788

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -4.975323        3.779849 pass
      -2.755133        4.393177 pass
      -1.254723       -4.312847 pass
       1.049522        2.224555 pass
      12.056479        5.654166 pass
       7.045844        6.047775 pass
       0.643793       -5.153523 pass
       1.717741       -4.927942 pass
       1.564505       -5.895754 pass
      -1.241359       -9.479059 pass
      -4.926467        1.558064 pass
       3.424340       -0.384162 pass
       6.451563        6.653054 pass
       0.439618        2.639647 pass
       2.009985        1.699200 pass
       5.497958        4.217884 pass
      -1.157204        2.799888 pass
      -2.576429        4.131308 pass
      -4.059377        1.495409 pass
       0.431088       -0.569241 pass
       4.206189        3.015345 pass
      -2.649017        5.109818 pass
       1.381183       -4.948669 pass
       7.573631        3.919603 pass
       1.490243        5.452820 pass
      -2.392719      -13.891574 pass
      -3.571924       -8.870440 pass
      -1.520796       -3.961259 pass
       0.256135        3.092714 pass
      -0.976075       -1.770595 pass
       1.645149       -1.127410 pass
      -1.065399        3.409585 pass
      -3.200790       -8.784848 pass
      -1.105415       -4.593468 pass
       1.764763        2.287784 pass
       1.367876        5.090795 pass
      -0.836280       -2.143159 pass
      -1.825790        1.321921 pass
      -0.680332       -8.244084 pass
       0.392313       -1.517061 pass
       0.942213        8.813155 pass
      -0.279494        2.414961 pass
      -2.302308        4.093703 pass
       1.323145        5.949910 pass
       8.097701        1.456315 pass
       3.372487       10.461996 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_3.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.459499 10.829639 55.680965
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
  632.757520509536  43.52799873198921  0.0008804967979520648  -0.014626457969967293
 709.8257801184594 47.507856164720145     359.99852516247785  -0.014311550857858348
 910.5959218383333  74.15073580836673     359.99243330115337  -0.012997209251142885
 978.1734916601412  79.09634950402457     359.99037406382115  -0.012674008968996101
 468.7130887677887 103.70932107395348   0.006068286014852335   -0.01322360404683915
  732.790984782116 114.80235210425441     359.99799208670777  -0.012224549793193257
  397.984710427444 124.51324600589399   0.008291256163280063  -0.012770390494991906
453.48648150451567  138.5482319055374   0.006624203827780067  -0.012205946184055615
 510.5826324979371 152.64448533976542   0.004908405341258196  -0.011634774691144639
 837.2149603482594  177.1785834572367      359.9949499615408  -0.010070545641559236
 574.5481104859573 184.43873533137992   0.003027600457347842  -0.010506876620650508
 881.0720770864376  205.4811392291359     359.99367911021494   -0.00910047240755286
 967.9227669585642 206.66121780659034     359.99101887212703   -0.00884787365368245
 403.5962440387207   216.998785601212   0.008354373151629148   -0.00994252422160558
 415.2777583527195 223.52829021424284   0.008012874091052141  -0.009713721429904707
 489.0920184154513 234.93882953827853   0.005778885460870573  -0.009179436773304156
 730.7977037082132 246.70779432945926     359.99839704252184  -0.008216395799283889
495.33441450714344 249.70017562299645   0.005625489983602337  -0.008712222746655486
 873.0776664428001 266.42458939825514      359.9940861819049   -0.00726229994756828
 741.6867097679047  279.9382786626609     359.99815100970363  -0.007172803098400693
380.14033396361117  301.2436539679342   0.009287748779498183  -0.007423548358097951
 665.2235848015512  328.5104074590912  0.0006236098759626848  -0.005872363696826033
 721.1009889243013 352.48437128381073     359.99897510732956  -0.004998591785375306
 558.8356054855649  391.3900339558093   0.004047855226464509  -0.004203748397144104
456.46867164126957  459.2609164373239  0.0073561127832601925  -0.002371745888469407
 689.8327353648502 485.06169266959915 0.00028755014973561054 -0.0009973537094344351
 729.3781725739266  495.5207376473076      359.9991061775121 -0.0005793868444065472
 421.5313298328499  495.9474141851409    0.00851819173856682 -0.0013308055493282981
 694.8390061976295  509.5305205319393 0.00020019156541582563 -0.0002319329312739653
14.081606885276077  557.2166447486212   0.021107528702098505 -0.0005205285248208323
 881.6543299915564  595.8568645041335      359.9947254230886  0.0028688929381400895
 915.4735869466531  605.5705900525442      359.9937187373024  0.0032461369049492667
 996.4781613563033  622.2440029897667      359.9912890038844   0.003944930128583014
 794.4678033778682  628.5049053250357     359.99747921198633   0.003667173736498765
  840.081104132367  662.8420150991536      359.9961810901739  0.0048294298273538795
 481.7458734746978  736.5408482211899   0.007300242502125687   0.006221561579575905
 688.4363469452317  768.8245040889547  0.0010937407243143905    0.00772151655478467
 981.1057496757138  774.1328899034736     359.99218742384153    0.00856640104398379
 786.7033611257062  779.6094428435799     359.99813025456774   0.008285777187910513
 500.3213435066071  828.2875623678548   0.006972292739396447   0.009079392487024846
 845.1395260116918  888.2486429009447      359.9966490980914   0.011744618340666048
 799.9582256550444  894.1529473093893      359.9980397938047   0.011819651703137203
  845.956261130645  903.5178548940592     359.99666619433395   0.012212638460852125
 835.9945894894588  948.4929444611175     359.99709237310265   0.013561331318791536
1004.5948488048369  950.0992666738197      359.9919654017713   0.013995388320326398
 823.5753939434358  959.1642392517674      359.9974990166614   0.013857674611357278
 782.0375957577447  960.5590014045085     359.99876499345754   0.013802953255150834
 922.1356667374224  978.2850292332223      359.9945543794388   0.014667538039234738
 652.6937363556877 1016.2119840128314  0.0028391970295941005   0.015188260679953809

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -3.623553       -0.168281 pass
       0.059981        6.028601 pass
       1.980539       -4.873354 pass
      -2.866220        0.193737 pass
       7.784920       -1.983088 pass
       3.634933       -2.891154 pass
      -3.193980       -6.285198 pass
      -2.836849       -2.974549 pass
      -2.909741       -6.499978 pass
      -8.133392        1.859597 pass
       0.353129        2.226026 pass
       1.053862        1.412953 pass
       4.254858        9.720189 pass
       5.059229        0.811112 pass
       3.996774        9.099333 pass
       0.709307        4.538448 pass
      -0.742303        5.946131 pass
       1.029653        1.425431 pass
      -2.960956       -1.392640 pass
       0.386387       -5.730427 pass
      -0.904394       -1.974089 pass
       1.343169        8.392748 pass
      -3.586016       -3.851537 pass
       3.461547        5.235690 pass
       7.512148        5.220745 pass
       0.873008      -12.378314 pass
      -2.074170        1.443758 pass
       3.078815       -2.694230 pass
      -0.412341        5.627616 pass
       1.446377        1.397953 pass
       0.229756       -0.032288 pass
       1.365980        5.536941 pass
       0.324626       -9.252622 pass
      -2.683556       -0.802124 pass
       0.922188        9.394218 pass
      -0.453272        1.002852 pass
       2.654289      -10.307142 pass
       0.689635        0.241447 pass
       1.523119       -7.585423 pass
       4.684152       -0.753304 pass
       8.988473       -1.648692 pass
      -1.836059        2.798112 pass
       4.943346        5.312802 pass
       0.699602       -1.301541 pass
       2.161646        4.044166 pass
       3.139657        0.454847 pass
       7.353079        5.775123 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_5.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.461396 10.8295555 55.684906
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
 632.7561014527342  43.52872182023289  0.0010205421837794608  -0.014486439834403033
 709.8260670657803   47.5058809583951      359.9986651486738  -0.014171609453174118
 910.5951520227544  74.15262735916836     359.99257332956284  -0.012857154436161493
 978.1739871993807   79.0963228230719      359.9905140485703  -0.012534008485688053
468.71224848996206 103.70989382247947   0.006208313253700151  -0.013083588821216326
 732.7915923131342 114.80647731539594      359.9981320786759  -0.012084423456772018
397.98413357499743 124.51335799099897   0.008431274139434002  -0.012630388543481575
  453.486222463101  138.5458169269537   0.006764205617381574   -0.01206602013451995
510.58256909558963  152.6453203832899   0.005048409422882343  -0.011494749469333973
 837.2169099602804 177.17912292467238      359.9950899031489  -0.009930524368498101
 574.5467924282938 184.53495588155457   0.003167889289769068  -0.010363947947852328
  881.072757297264 205.48539115095912     359.99381910057497   -0.00896034135706193
  967.924538456573 206.66197471295982     359.99115881981544  -0.008707846239862494
403.59519404561934 216.99772079775687   0.008494402627499458  -0.009802559375285612
415.27622730365823 223.52761937893004   0.008152919316814486  -0.009573745776052278
 489.0946428106659 234.93889167070938   0.005918805147617917  -0.009039428286146166
 730.7995005378147 246.70662956366752     359.99853698434373  -0.008076426945945311
495.33518932760904  249.7024097932946   0.005765471982520055  -0.008572152430679165
 873.0774447239464 266.42532686273233       359.994226190677  -0.007122277968077975
 741.6859285461186 279.93870052952946     359.99829103477674  -0.007032792110813749
 380.1370486212538  301.2438407112605   0.009427849888286459  -0.007283550963973088
 665.2269225901222 328.50792691218294  0.0007635010274181508  -0.005732431596715987
 721.1001264694142  352.4851006313926     359.99911513570277  -0.004858571502264583
 558.8372234547588 391.38558179923365   0.004187794040580324  -0.004063881330548656
456.46151568364206 459.25963414936314   0.007496328276344708  -0.002231803493918642
 689.8318563457915 485.05914533128765 0.00042757019837570275 -0.0008574342669445246
 729.3758901700103 495.52228213954953      359.9992462514958 -0.0004393448326454394
 421.5314421564851  495.9455044748265   0.008658183418549214  -0.001190864071148042
  694.837657200127  509.5318564734783 0.00034023640497564313  -9.18950864308775e-05
14.081803113089986  557.2159960609778    0.02124752117466758  -0.000380547908810225
 881.6523091352415  595.8547570266802      359.9948654790013   0.003008823453461035
 915.4741065868286  605.5711695752242      359.9938587230354  0.0033861559121944463
 996.4784351276294  622.2423567819199     359.99142899086496   0.004084880233595695
  794.469839790824  628.5055976724658     359.99761915170114  0.0038071998360018613
 840.0786466311152  662.8404021273825      359.9963211607397   0.004969374543000565
481.74592656195796  736.5414197031473  0.0074402423629929765   0.006361579245680676
 688.4356820369527  768.8238940960294  0.0012337593295742879    0.00786149626021711
 981.1089672696557  774.1361073647035     359.99232733469995   0.008706506831144933
 786.7045617896734   779.611802202087      359.9982702244455    0.00842585228151213
500.32197626807886  828.2892825101978   0.007112277959974392   0.009219446706782949
 845.1369459333854   888.244390359914     359.99678916491627   0.011884482514216926
 799.9586443996288  894.1555172153749     359.99817978807744   0.011959731139923258
 845.9561015097216  903.5187293444774      359.9968062015897   0.012352664779542435
 835.9932678302781  948.4906491194473     359.99723240700996   0.013701258281230323
1004.5949500781727  950.1001812322297     359.99210540123534    0.01413541643042263
 823.5785927457607  959.1670105496879      359.9976389269887   0.013997766512779123
 782.0375591951885  960.5596213741295      359.9989049962459    0.01394297205959524
 922.1365503429363  978.2855175769723     359.99469435389864   0.014807554933294118
 652.6933028870272 1016.2125890007942  0.0029792117714372685   0.015328278029687408

RA_Diff (mas)  Dec_diff (mas) pass/fail
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_7.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.166319 10.819193 52.431835
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 646.9460364189496 123.58824806720995  0.0008803409666353219    -0.01462544759401453
 724.0252320146072  127.5820452764259      359.9985251448545      -0.014310524077353
 924.8606761687124 154.24326052907645      359.9924329361845   -0.012996383566727537
   992.45691902968 159.27374467532363     359.99037339685844   -0.012673064323221303
482.87053476521277 183.28959656865936   0.006068231603246421   -0.013222390879844007
 747.0589422960411 194.39222695244513      359.9979919488258   -0.012223096373398978
412.11218706689084 203.90829274053294   0.008291045403339596   -0.012771385160995604
467.56583952342805 217.90372011464456    0.00662635936109802    -0.01220484372594049
 524.7770858845939 231.89311550157834  0.0049079203445831455   -0.011633826109081785
 851.5364944961776  256.5001400819646     359.99495137802734   -0.010069281024660396
  588.705062769309 263.51085726272504  0.0030296502371099806   -0.010506455620478956
 895.4584259369747 284.53409875070355     359.99367964554193     -0.0091047589609821
 982.4255461949168  285.9202146860721     359.99101719217686   -0.008849400351720169
 417.7174017858739 295.82945696890056   0.008353917643836436   -0.009945222372284788
 429.4042633190108  302.3938491302124   0.008012662027330593   -0.009714355847956803
 503.2698996261898 313.66457227896325      0.005778574588179   -0.009182449351832687
 745.2283576279594  325.5350018038381     359.99839492246144   -0.008217355359381432
509.53867989539395 328.42412505899017   0.005624735426441953   -0.008713537241315246
 887.5443812545439  345.2641690333635      359.9940862878344      -0.007265244786619
 756.1049685736115 358.67865141799314      359.9981503199985    -0.00717342350491229
394.23291927272953 379.85017585787546   0.009287587812766219    -0.00742439167826378
 679.5634066559268  407.0596025804446  0.0006242027742464089   -0.005873736972104611
 735.4844061261805  431.0996831560591     359.99897662127745  -0.0049976416161509035
 573.1313058171473 469.80286113326713   0.004047329109084021   -0.004205179593319682
 470.5890419719976  537.6340474457602   0.007357930444448098    -0.00237327401915634
  704.327058625501  563.4788329832742 0.00028666582563447254  -0.0009992064146646443
 435.6105785039881  574.3863481872331   0.008520331771738035  -0.0013305748801799543
  743.874891664683  573.9747828254133      359.9991067931344  -0.0005809777008637135
 709.3557006099318  587.9666594324468  0.0001991739613351785 -0.00023358941671565873
27.531278375167513  635.8512293053622   0.021115014317358988  -0.0005216216890524824
 896.4408422838092  674.4980277163539     359.99472377077933   0.0028676799548390266
 930.3046944886573   684.334662079809      359.9937171097069   0.0032476367453057745
1011.3109434871345  701.0321927252717     359.99128955084143    0.003944579315404069
  809.095857702636  707.1484044619239     359.99747998772455   0.0036660735530476296
 854.7864857555858  741.5832025222157     359.99618146318284   0.0048288846011218705
  496.042646678495   815.501330316961    0.00730043085322982    0.006226567438309456
  702.974834779573  847.7555655541388  0.0010946992939119733    0.007721763324996789
 995.9743233516383  853.1699976082482      359.9921875269867    0.008566666045003165
 801.4327560408036  858.5945248989527      359.9981289789841    0.008286199706369223
 514.6244381546285  907.3352544164048   0.006973482959273866    0.009079930104721341
 859.8694947178157  967.5204508513665     359.99664969864597    0.011745747050078564
 814.6347535333018  973.4206873951758     359.99804066679786    0.011820395007652196
 860.6853482064994  982.8172971910304      359.9966667541225     0.01221360129934576

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.203028      -11.543093 pass
       4.893700        4.162587 pass
       7.721476        1.713322 pass
       1.151995       -5.124618 pass
       3.349600      -11.786469 pass
      -0.044192       -6.935209 pass
       4.794378       -5.669569 pass
      -4.682542        2.747970 pass
       2.515126        6.289380 pass
       5.338653        3.348377 pass
       4.636204       -0.881232 pass
       3.313240        4.226007 pass
       5.923951       -6.332260 pass
       2.400472        8.622028 pass
       0.833772        5.792833 pass
      -0.744716       -7.119723 pass
       5.836599       -2.309818 pass
      -1.483874       -5.010042 pass
      -1.616971       -5.114465 pass
       8.560898        9.788311 pass
       7.015773       10.453056 pass
       1.551072        5.642778 pass
      -1.702848        2.397762 pass
       1.184793       -7.846536 pass
      -1.531483       -5.217667 pass
      -2.171310        3.368436 pass
       1.667458      -11.215436 pass
      -7.275657        0.718943 pass
       0.163452        5.813420 pass
      -1.216702       -1.281053 pass
      -3.205055       -4.907717 pass
      -2.973739       -5.721900 pass
      -4.425194      -11.952163 pass
       3.370264        2.219160 pass
       8.427480        1.988662 pass
      -4.552465       -1.934069 pass
       3.303518       -4.400540 pass
       2.714841        2.164678 pass
       9.540854        5.559766 pass
      -2.908163       -5.041266 pass
      -0.279139        2.320706 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_9.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.167205 10.820021 52.420555
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
 646.9454800415763 123.59122321380107  0.0008803656879164385  -0.014625358834867506
 724.0256726768248 127.58013796160934      359.9985251264132   -0.01431058074881553
 924.8597080043684  154.2432706124099     359.99243296590157  -0.012996385708730001
 992.4534255006282  159.2718625921307      359.9903734990552  -0.012673130090554478
 482.8696673425391  183.2899835191299   0.006068259202637669  -0.013222381265036554
 747.0578849106864 194.39226082259032      359.9979919813537  -0.012223097981552028
 412.1139269048188 203.90945048821695    0.00829099500464183  -0.012771345469780142
467.56675428766414  217.9036290726527  0.0066263310760417415   -0.01220484420928609
 524.7779965210373 231.88761492892587   0.004907878219448835  -0.011633991987964873
 851.5351015628255 256.50133330428804      359.9949514239217  -0.010069248022576957
 588.7056787681511 263.50878787844727   0.003029625957239504   -0.01050651745401577
 895.4613105651895 284.53301855679746      359.9936795541991  -0.009104784903560181
 982.4265095675484  285.9188137972235     359.99101715886314  -0.008849440744045681
417.71543674308754  295.8303503510455   0.008353980132200288   -0.00994519994298999
 429.4043006594748   302.391294319142   0.008012654340806747  -0.009714434124611955
 503.2701695686526   313.660954522638   0.005778556956879143  -0.009182559722200206
  745.227175719965 325.53650613651814     359.99839496270187  -0.008217312112789378
 509.5395129140925  328.4264116852812   0.005624715832518511  -0.008713464923489102
 887.5432061951202  345.2660055868902      359.9940863288323  -0.007265191349839529
 756.1041842849181  358.6800425484636      359.9981503477614  -0.007173382702703706
394.23237537998807 379.85139546326104   0.009287607567243169  -0.007424355561664159
 679.5646720105382  407.0614691793956  0.0006241690117001846 -0.0058736764496161555
 735.4846227401789  431.0987984975643     359.99897661226294  -0.004997668302282632
 573.1327307968371  469.8028377674046   0.004047285469453377  -0.004205176771126612
 470.5899109886719   537.634139560142   0.007357904143361665 -0.0023732689841836083
 704.3299938731695  563.4795835368527 0.00028657817169840187 -0.0009991762174390486
 435.6099546323682  574.3867880651862   0.008520351938341926 -0.0013305629301788556
  743.876859351675  573.9722780891316     359.99910672620973  -0.000581050034878793
  709.353752512589  587.9671313943018 0.00019923473444689437 -0.0002335795982129045
27.528381239185606   635.852642005663   0.021115105964276147 -0.0005215862798103629
 896.4397012609306  674.5007838620852      359.9947238133093   0.002867761902645875
 930.3064781430503   684.334060840617      359.9937170535473   0.003247622400811566
1011.3112434924527  701.0314437239015     359.99128953955324   0.003944557036107322
 809.0957248208425  707.1478396927572     359.99747999022435   0.003666055911212994
 854.7882520124947  741.5815247429309     359.99618140466794   0.004828837272518164
 496.0419398685006  815.5016620469418   0.007300453193028751  0.0062265758102119555
 702.9741875563504  847.7562918805631  0.0010947209288824965   0.007721783980913229
 995.9721439659877  853.1689695028363     359.99218759056447   0.008566629720873442
 801.4316652320226  858.5921814993368      359.9981290057719   0.008286125536795407
 514.6267263594901  907.3369596675094    0.00697341792737487   0.009079987884410582
 859.8707171877863  967.5196606903338     359.99664965931487   0.011745725802043364
 814.6354876594828  973.4205911145488     359.99804064422983   0.011820393789056067
 860.6851506594377  982.8162979189045     359.99666675739485   0.012213570408960222

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.518582      -11.434383 pass
       4.791874        4.160847 pass
       7.655088        1.509304 pass
       1.251941       -4.977730 pass
       3.254916      -11.768343 pass
      -0.035192       -6.998720 pass
       4.866978       -5.626549 pass
      -4.604656        2.822331 pass
       2.373534        6.212887 pass
       5.104539        3.556384 pass
       4.783796       -0.688859 pass
       3.161590        3.628843 pass
       5.595117       -6.425653 pass
       2.319227        8.617641 pass
       0.933129        5.827446 pass
      -0.985645       -7.380126 pass
       5.804147       -2.405888 pass
      -1.412758       -4.880022 pass
      -1.657608       -5.194670 pass
       8.726118        9.907119 pass
       7.132873       10.447266 pass
       1.631495        5.672917 pass
      -1.473968        2.266995 pass
       1.027690       -7.836376 pass
      -1.594955       -5.615000 pass
      -1.803401        3.131674 pass
       1.456805      -11.385819 pass
      -7.179221        0.451932 pass
      -0.017983        5.956309 pass
      -1.244373       -1.562849 pass
      -3.407230       -4.959357 pass
      -2.754956       -5.686554 pass
      -4.272087      -11.657150 pass
       3.477246        2.211449 pass
       8.516476        2.308194 pass
      -4.623003       -1.673725 pass
       3.528476       -4.319795 pass
       2.726621        2.053472 pass
       9.453446        5.337166 pass
      -3.028093       -5.186679 pass
      -0.134273        2.476394 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_11.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits
Image mean, median and std 11.14942 10.819677 52.3238
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 695.2882988999536 103.10651467532003  0.0008800008772832899   -0.014624813910079982
 772.3744183009295  107.0815682195305      359.9985245931245   -0.014309869787115948
  973.228381685913 133.63302595063803     359.99243224223216   -0.012997673379714877
 531.2457880501139 162.90678044840305   0.006067753827247839   -0.013222863142923662
 795.4098654036351 173.99541287004112      359.9979911433319   -0.012223925183360086
  460.547711377863  183.5249036196875   0.008289441834595316   -0.012772358696295038
 515.9706963233565 197.55498823067623   0.006625409028767752   -0.012205661433268716
 573.1045796641623 211.60813499707166   0.004909149394200925    -0.01163371221201762
 899.8933788590772 236.19645940742822      359.9949503013732   -0.010070332329877986
 637.0838241772371 243.32047754138887    0.00302930239325246   -0.010504872055279972
 943.8044405646633 264.45023347848417      359.9936793323863   -0.009100426256506654
466.16761385963326  275.6415362787146   0.008353364238678336    -0.00994304344948607
 477.7998425311254 282.12836328156897   0.008013547610210205   -0.009714975271219643
 551.6424228064568  293.5141692246144   0.005779824893848046   -0.009180675245526442
 793.5362941129501  305.3737976889193     359.99839615145964   -0.008218045255784857
 557.9115612743607  308.2309333789397   0.005626000043587533   -0.008713509112374706
   935.89818015132  325.1387934464577      359.9940855059957    -0.00726544155060442
 804.4990143921109  338.5651047740593      359.9981491833879  -0.0071737216779422215
 442.6930855595648  359.6109073627168   0.009288286507927042   -0.007424822264389844
 727.9952424701189 386.98027318926063  0.0006232392478226067   -0.005873735036980789
 783.9187945939353 411.06018073336685      359.9989753985937    -0.00499750078331377
 621.5759401883365  449.7014536319138    0.00404829003612404   -0.004205284148308415
 519.1902540839886  517.5298630654247   0.007357057943188697   -0.002371136402893473
 752.7897384965033   543.479054423098 0.00028734675743388586  -0.0009989984751563358
484.25480678313863   554.161793091394   0.008519257795758167   -0.001330984310451842
 792.3715451848047  553.9949623101498      359.9991060833142  -0.0005807988134908488
 757.8281459003109  567.9717563455148 0.00019999925135859084  -0.0002333580126112227
396.18338983138534  604.5780857775677    0.01133613097965103 -3.5146940737205506e-06
 76.35854360332827  615.2713546165651   0.021113604528003087  -0.0005212509629759039
 944.8620518533836  654.6300422676247      359.9947249668796   0.0028684712215900337
 978.7199582266016  664.4764120134141      359.9937180442408     0.00324823477261302
 857.5978321036471  687.1863850362278      359.9974808060295   0.0036657619234262495
 903.3383272720531  721.6639082807033     359.99618069821037    0.004829340458761752
  544.822969770774  795.1767613387013   0.007300501536278909     0.00622535560971207
 751.6593136994991  827.6341518190358  0.0010951813293202872   0.0077212194450194584
 850.0297444326784  838.5511439029677     359.99813041047923    0.008285502452127409
 563.5070365304637  886.9914021805405   0.006972577193303109    0.009079660723682728
 908.5174896745665  947.4667033713542     359.99665071218845     0.01174530799753924
 863.3821582485261    953.31539644542     359.99803984272904    0.011819834480523251
 909.4201911354062  962.7615722742491      359.9966654557789    0.012213561507437893
 899.4889080888873 1007.7029930107033      359.9970911156624    0.013559580759199472
 845.5160643327326 1019.3354165427019      359.9987631926184      0.0137889507124076
 887.0452334515168 1018.3645917674779      359.9974986040853    0.013855459901527773

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.425293       -1.944355 pass
       1.248327      -10.794511 pass
       1.472504        1.218840 pass
       5.735248        4.068766 pass
      -2.939804       -6.198041 pass
       0.208595       -4.091050 pass
       2.901706       -8.057076 pass
       0.928065       -7.143518 pass
      -2.947214        0.790002 pass
       6.163878        4.708791 pass
       2.077896        2.378605 pass
       1.821585       -1.589582 pass
       7.737819        4.636037 pass
       4.796591        9.265477 pass
      -0.566175        6.604130 pass
      -0.886222        4.092685 pass
      -3.300069       -6.475729 pass
       1.434937       -1.802820 pass
       1.031429       -6.560152 pass
      -3.183615        2.090733 pass
       4.684943        6.003612 pass
       4.115995        7.469340 pass
       1.805531        1.280195 pass
       4.644130       -8.222934 pass
       2.969618        1.169116 pass
      -1.086443       -9.574348 pass
      -2.122275       -1.791172 pass
      -5.609395        2.308693 pass
       1.971397       -3.510976 pass
       0.159267       -2.754819 pass
      -0.002695       -4.888845 pass
      -0.119234       -9.103602 pass
       0.872036       -2.424167 pass
       7.203158        4.269924 pass
       0.000157       -1.832805 pass
       1.311259        3.443582 pass
      -1.959196        2.021427 pass
       8.288616       11.260601 pass
       4.145255       -0.162921 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_13.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_13.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits
Image mean, median and std 11.148314 10.819933 52.31703
    xcentroid          ycentroid                RA                    Dec          
------------------ ------------------ ---------------------- ----------------------
   695.28794170584 103.10641319490699  0.0008800115795231863   -0.01462481787900968
 772.3731936505352 107.08007937646431      359.9985246268782  -0.014309917872403828
 973.2281832908834  133.6348268676595       359.992432252969  -0.012997619538201288
 531.2461240972619 162.90616024026545   0.006067741924447004  -0.013222881168460607
 795.4082883628598  173.9964145346605     359.99799119432987   -0.01222389869223297
 460.5482539991836 183.52565213354322   0.008289427105149128  -0.012772334529918135
  515.971022928771 197.55386309448286   0.006625396116303293  -0.012205694933804823
 573.1055169320389  211.6075876893692  0.0049091192277255415  -0.011633726576394846
 899.8952017510751 236.19527724644132     359.99495024232874  -0.010070363843153046
  637.082904882704 243.32193769850684   0.003029334402767267   -0.01050482968984714
 943.7992653146599  264.4489310792786     359.99367948756526  -0.009100478721790392
 466.1660535560782   275.640950154766   0.008353410553245011  -0.009943065336091812
477.79796528347913  282.1275102677306   0.008013602946853783  -0.009715006139339866
 551.6441749526855  293.5150245290313   0.005779773415525509  -0.009180644632308558
 793.5314353855134 305.37140487562107      359.9983962940064   -0.00821813048577351
 557.9109575174925 308.23135130802393   0.005626019634737101  -0.008713497795483575
 935.8973036748098 325.14009061951293      359.9940855363827  -0.007265403985229679
 804.4988427398484 338.56293884484654      359.9981491828204  -0.007173788531946998
 442.6927137354523  359.6114345294081   0.009288299245937747  -0.007424807000506554
 727.9943724390052  386.9821714885887  0.0006232709857077299  -0.005873678813221203
 783.9162233378428  411.0579407438311      359.9989754712712  -0.004997575863914036
 621.5767698477409 449.70199238928535   0.004048266080364153  -0.004205265514444473
 519.1911503353462  517.5358092205225  0.0073570460586275645 -0.0023709510343529468
 752.7880780342024  543.4801203561428  0.0002874004121121975  -0.000998969663921725
484.25376556038856  554.1619772165304    0.00851929006313443 -0.0013309812693040395
 792.3751873690417  553.9946415511126      359.9991059710994 -0.0005808000012685225
 757.8304438957533  567.9695819856329 0.00019992310895048133 -0.0002334194004333699
396.18468311561935  604.5807611777432   0.011336098337038783 -3.429058731243893e-06
 76.35814999540862  615.2723711714851    0.02111361895637598 -0.0005212208222102637
 944.8635640932658  654.6310144514106     359.99472492340107  0.0028685045368420587
 978.7205619653042  664.4790452486839     359.99371803321566   0.003248316935449173
 857.5958244646582  687.1827860653182      359.9974808573291  0.0036656467929251264
 903.3399724466342  721.6604165017714     359.99618063825375   0.004829237186174471
 544.8233340592824  795.1777717322748   0.007300493096006179   0.006225387462063048
 751.6584803677636  827.6363909001989  0.0010952127669043958   0.007721285965960717
 850.0294380306964    838.55150947549      359.9981304208188   0.008285512920257644
 563.5067284206251  886.9918823123108   0.006972587803690846    0.00907967462159978
 908.5206742421236  947.4677816020749      359.9966506182584    0.01174534815537037
 863.3827492499984  953.3136639288376     359.99803982000446   0.011819783039594491
 909.4171471081825  962.7581389765916     359.99666553892456   0.012213449914027643
 899.4888297651883 1007.7051953534469     359.99709112408334   0.013559647619545423
 845.5162351428138 1019.3362542119728     359.99876318970763   0.013788976596931363
  887.044887942196 1018.3648827073387       359.997498615383    0.01385546795957044

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -1.384621       -1.915346 pass
       1.441484      -10.690790 pass
       1.426019        1.098238 pass
       5.856762        3.895659 pass
      -2.941847       -6.438715 pass
       0.165811       -3.423724 pass
       3.086385       -8.471545 pass
       1.044227       -7.132569 pass
      -2.834039        1.029477 pass
       5.825730        4.853359 pass
       2.116093        2.428638 pass
       1.930978       -1.454347 pass
       7.629220        4.584325 pass
       5.355235        9.076602 pass
      -0.647984        6.418943 pass
      -0.929072        4.027794 pass
      -3.704042       -6.480005 pass
       1.696576       -2.073110 pass
       1.077285       -6.505202 pass
      -3.153300        2.331430 pass
       4.472383        5.890165 pass
       4.299587        7.564708 pass
       1.775146        1.394863 pass
       4.557889       -8.155852 pass
       2.784296        1.279324 pass
      -1.302286       -9.946130 pass
      -2.085052       -1.753487 pass
      -5.662421        2.395692 pass
       2.170609       -3.622102 pass
       0.119576       -2.459032 pass
      -0.276808       -5.109842 pass
      -0.275756       -8.983667 pass
       0.910688       -2.230338 pass
       7.241686        4.255636 pass
       0.070685       -1.792064 pass
       1.477992        3.364790 pass
      -1.659872        1.619690 pass
       8.403850       11.413117 pass
       4.658423       -0.469749 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_37_15.png" src="../../../_images/exec_jwst_tweakreg_miri_test_37_15.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.1084997025612093 0.928302277808206 3.5773131993903524
Dec difference mean, median and std (units in mas) -0.17537865973407207 1.1691161048078824 5.539940734870295
</pre></div>
</div>
</div>
</div>
<section id="id1">
<h3>Run the images through calwebb_image3 with tweakreg on<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>Alter any parameters needed to get better results from tweakreg. Look at individual i2d images afterwards.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image3 on the association table with tweakreg on</span>
    
<span class="c1"># set any specific parameters</span>
<span class="c1"># tweakreg parameters to allow data to run</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mf">3.318</span> <span class="c1">#3.27  # Gaussian kernel FWHM of objects expected, default=2.5</span>
<span class="n">minobj</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># minimum number of objects needed to match positions for a good fit, default=15</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1"># signal to noise threshold, default=5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># clipping limit, in sigma units, used when performing fit, default=3</span>
<span class="n">fit_geom</span> <span class="o">=</span><span class="s1">&#39;rshift&#39;</span> <span class="c1"># ftype of affine transformation to be considered when fitting catalogs, default=&#39;general&#39;</span>
<span class="n">use2dhist</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># boolean indicating whether to use 2D histogram to find initial offset, default=True</span>
<span class="n">search_radius</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="c1"># radius in arcseconds to search for a match</span>
<span class="n">tol</span> <span class="o">=</span> <span class="mf">1.0</span>  <span class="c1"># Matching tolerance for xyxymatch in arcsec. (Default=1.0)</span>
<span class="n">use2dhist</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># boolean indicating whether to use 2D histogram to find initial offset, default=True</span>
   
<span class="n">pipe3</span><span class="o">=</span><span class="n">Image3Pipeline</span><span class="p">()</span>    
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">kernel_fwhm</span> <span class="o">=</span> <span class="n">fwhm</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">snr_threshold</span> <span class="o">=</span> <span class="n">snr</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">minobj</span> <span class="o">=</span> <span class="n">minobj</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="n">sigma</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">fitgeometry</span> <span class="o">=</span> <span class="n">fit_geom</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">use2dhist</span> <span class="o">=</span> <span class="n">use2dhist</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">save_catalogs</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe3.tweakreg.skip = True        # test to see if this affects the final output</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">outlier_detection</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe3.output_dir = datadir</span>

<span class="c1"># run Image3</span>

<span class="c1">#im = pipe3.run(rtdata.input)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipe3</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_asnfile.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image 3 pipeline finished.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,660 - stpipe.Image3Pipeline - INFO - Image3Pipeline instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,663 - stpipe.Image3Pipeline.assign_mtwcs - INFO - AssignMTWcsStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,665 - stpipe.Image3Pipeline.tweakreg - INFO - TweakRegStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,667 - stpipe.Image3Pipeline.skymatch - INFO - SkyMatchStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,669 - stpipe.Image3Pipeline.outlier_detection - INFO - OutlierDetectionStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,671 - stpipe.Image3Pipeline.resample - INFO - ResampleStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,673 - stpipe.Image3Pipeline.source_catalog - INFO - SourceCatalogStep instance created.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,863 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;starfield_50star4ptdither_asnfile.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,870 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;steps&#39;: {&#39;assign_mtwcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;assign_mtwcs&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;}, &#39;tweakreg&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: True, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 3.318, &#39;snr_threshold&#39;: 40, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: True, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}, &#39;skymatch&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}, &#39;outlier_detection&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: None, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}, &#39;source_catalog&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:12,999 - stpipe.Image3Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39; reftypes = [&#39;abvegaoffset&#39;, &#39;apcorr&#39;, &#39;drizpars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:13,002 - stpipe.Image3Pipeline - INFO - Prefetch for ABVEGAOFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:13,005 - stpipe.Image3Pipeline - INFO - Prefetch for APCORR reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:13,007 - stpipe.Image3Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:13,008 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:14,265 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:14,268 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: True, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 3.318, &#39;snr_threshold&#39;: 40, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: True, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:14,529 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 48 sources in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:14,534 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:14,807 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 48 sources in starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:14,811 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,085 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 49 sources in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,090 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,391 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 48 sources in starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,395 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,660 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 42 sources in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,665 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,939 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 42 sources in starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:15,944 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,216 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 43 sources in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,220 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,460 - stpipe.Image3Pipeline.tweakreg - INFO - Detected 42 sources in starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,465 - stpipe.Image3Pipeline.tweakreg - INFO - Wrote source catalog: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,488 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,490 - stpipe.Image3Pipeline.tweakreg - INFO - Number of image groups to be aligned: 8.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,491 - stpipe.Image3Pipeline.tweakreg - INFO - Image groups:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,516 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,517 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,544 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,545 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,570 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,572 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,597 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,599 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,627 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,628 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,651 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,652 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,676 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,676 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,700 - stpipe.Image3Pipeline.tweakreg - INFO - * Images in GROUP &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39;:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,701 - stpipe.Image3Pipeline.tweakreg - INFO -      starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,701 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,702 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,703 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() started on 2022-07-07 08:27:16.702540
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,703 - stpipe.Image3Pipeline.tweakreg - INFO -       Version 0.7.4
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,704 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,875 - stpipe.Image3Pipeline.tweakreg - INFO - Selected image &#39;GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; as reference image
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:16,880 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,000 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,002 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,003 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of 3.997e-15, -6.217e-15 with significance of 48 and 56 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,005 - stpipe.Image3Pipeline.tweakreg - INFO - Found 48 matches for &#39;GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,006 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,008 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,009 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -4.99872e-05  YSH: -1.34437e-05    ROT: 5.32927e-05    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,009 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,010 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.000287318   FIT MAE: 0.000256544
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,010 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 48 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,050 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,168 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,170 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,171 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of -8.882e-16, -1.421e-14 with significance of 47 and 55 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,173 - stpipe.Image3Pipeline.tweakreg - INFO - Found 47 matches for &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,174 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,176 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,177 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000321171  YSH: -4.24579e-05    ROT: -0.000894824    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,177 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,178 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00527931   FIT MAE: 0.00461642
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,179 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 46 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,228 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,346 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,348 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,349 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of 0.6648, 0.4196 with significance of 21.66 and 56 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,351 - stpipe.Image3Pipeline.tweakreg - INFO - Found 47 matches for &#39;GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,352 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,354 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,355 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.504339  YSH: -0.504285    ROT: -0.000801053    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,356 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,356 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00545887   FIT MAE: 0.00479425
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,357 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 46 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,396 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,513 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,514 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,516 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of -2.22e-15, -1.11e-14 with significance of 41 and 47 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,517 - stpipe.Image3Pipeline.tweakreg - INFO - Found 41 matches for &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,518 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,521 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,522 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000303586  YSH: 0.00105847    ROT: -0.000552349    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,522 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,523 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00771548   FIT MAE: 0.00684298
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,523 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 40 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,563 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,690 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,691 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,692 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of -2.22e-15, -1.11e-14 with significance of 41 and 47 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,694 - stpipe.Image3Pipeline.tweakreg - INFO - Found 41 matches for &#39;GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,695 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,697 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,698 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000286148  YSH: 0.00108692    ROT: -0.000523678    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,699 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,699 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.00770516   FIT MAE: 0.00682456
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,700 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 40 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:17,968 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,082 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,084 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,085 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of 1.332e-15, -1.066e-14 with significance of 40 and 48 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,087 - stpipe.Image3Pipeline.tweakreg - INFO - Found 40 matches for &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,088 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,090 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,091 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000237614  YSH: 0.00262767    ROT: 0.000387146    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,092 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,092 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.0110158   FIT MAE: 0.0068922
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,093 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 39 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,133 - stpipe.Image3Pipeline.tweakreg - INFO - Aligning image catalog &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39; to the reference catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,249 - stpipe.Image3Pipeline.tweakreg - INFO - Matching sources from &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39; catalog with sources from the reference &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal&#39; catalog.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,251 - stpipe.Image3Pipeline.tweakreg - INFO - Computing initial guess for X and Y shifts...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,252 - stpipe.Image3Pipeline.tweakreg - INFO - Found initial X and Y shifts of 1.332e-15, -1.066e-14 with significance of 40 and 48 matches.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,254 - stpipe.Image3Pipeline.tweakreg - INFO - Found 40 matches for &#39;GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal&#39;...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,255 - stpipe.Image3Pipeline.tweakreg - INFO - Performing &#39;rshift&#39; fit
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,258 - stpipe.Image3Pipeline.tweakreg - INFO - Computed &#39;rshift&#39; fit for GROUP ID: starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal:
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,258 - stpipe.Image3Pipeline.tweakreg - INFO - XSH: -0.000265638  YSH: 0.00262238    ROT: 0.000458858    SCALE: 1
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,259 - stpipe.Image3Pipeline.tweakreg - INFO - 
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,260 - stpipe.Image3Pipeline.tweakreg - INFO - FIT RMSE: 0.0110242   FIT MAE: 0.00691673
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,260 - stpipe.Image3Pipeline.tweakreg - INFO - Final solution based on 39 objects.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,300 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,301 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() ended on 2022-07-07 08:27:18.300129
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,301 - stpipe.Image3Pipeline.tweakreg - INFO - ***** tweakwcs.imalign.align_wcs() TOTAL RUN TIME: 0:00:01.597589
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,302 - stpipe.Image3Pipeline.tweakreg - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:18,766 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,001 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,003 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: None, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,247 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,248 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() started on 2022-07-07 08:27:19.247306
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,249 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,249 - stpipe.Image3Pipeline.skymatch - INFO - Sky computation method: &#39;match&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,250 - stpipe.Image3Pipeline.skymatch - INFO - Sky matching direction: DOWN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,251 - stpipe.Image3Pipeline.skymatch - INFO - Sky subtraction from image data: OFF
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,252 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:19,252 - stpipe.Image3Pipeline.skymatch - INFO - ----  Computing differences in sky values in overlapping regions.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,819 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00238358
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,821 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0124171
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,822 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00851901
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,823 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00484789
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,823 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,824 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00727946
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,825 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00377957
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,826 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0117165
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,826 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,827 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() ended on 2022-07-07 08:27:31.826756
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,827 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() TOTAL RUN TIME: 0:00:12.579450
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,828 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:31,868 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,103 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,106 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;crf&#39;, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,107 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,119 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,297 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,299 - stpipe.Image3Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,318 - stpipe.Image3Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:32,513 - stpipe.Image3Pipeline.resample - INFO - Blending metadata for starfield_50star4ptdither_combined.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:33,221 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:33,865 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:35,001 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:36,123 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:37,243 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:38,364 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:39,486 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:40,607 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:41,725 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:42,077 - stpipe.Image3Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:42,686 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:43,786 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:44,898 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:46,000 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:47,118 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:48,222 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:49,309 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:50,433 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:50,789 - stpipe.Image3Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:51,417 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:52,543 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:53,667 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:54,814 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:55,937 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:57,099 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:58,241 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:59,382 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:27:59,740 - stpipe.Image3Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:00,368 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:01,523 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:02,668 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:03,810 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:04,944 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:06,101 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:07,226 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:08,386 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:08,800 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021880412 -0.020262681 0.024953861 0.014759994 359.990667213 0.017768852 359.987593764 -0.017253822
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,245 - stpipe.Image3Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_combined_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,247 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,492 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1142, 1118) from starfield_50star4ptdither_combined_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,496 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,526 - stpipe.Image3Pipeline.source_catalog - INFO - Using APCORR reference file: /grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,536 - stpipe.Image3Pipeline.source_catalog - INFO - Using ABVEGAOFFSET reference file: /grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,537 - stpipe.Image3Pipeline.source_catalog - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,538 - stpipe.Image3Pipeline.source_catalog - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,538 - stpipe.Image3Pipeline.source_catalog - INFO - Filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,539 - stpipe.Image3Pipeline.source_catalog - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:09,592 - stpipe.Image3Pipeline.source_catalog - INFO - AB to Vega magnitude offset 5.49349
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:10,151 - stpipe.Image3Pipeline.source_catalog - INFO - Detected 640 sources
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:10,794 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote source catalog: starfield_50star4ptdither_combined_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:10,912 - stpipe.Image3Pipeline.source_catalog - INFO - Saved model in starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:10,914 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote segmentation map: starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:10,916 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:10,917 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image 3 pipeline finished.
</pre></div>
</div>
</div>
</div>
</section>
<section id="id2">
<h3>Go through list of individual images and see which sources were found for each image.<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get list of catalogs</span>

<span class="n">cataloglist</span> <span class="o">=</span> <span class="p">[</span><span class="n">ele</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;cal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;cal_cat.ecsv&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">imagelist</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">imagelist</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cataloglist</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits&#39;]

[&#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal_cat.ecsv&#39;, &#39;starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal_cat.ecsv&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Loop through each image and overplot the sources found in the individual catalogs</span>

<span class="n">index</span><span class="o">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="n">cal_image</span> <span class="ow">in</span> <span class="n">imagelist</span><span class="p">:</span>
    <span class="n">indimage</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="n">cal_image</span><span class="p">)</span>
    <span class="n">ind_data</span> <span class="o">=</span> <span class="n">indimage</span><span class="o">.</span><span class="n">data</span>
    
    <span class="n">indcat</span> <span class="o">=</span> <span class="n">cataloglist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">catdata</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">indcat</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">,</span> <span class="n">comment</span><span class="o">=</span><span class="s1">&#39;#&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">cal_image</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">indcat</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">catdata</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">]),</span> <span class="s1">&#39;sources found&#39;</span><span class="p">)</span>
    
    <span class="c1"># mark sources on image frame to see if the correct sources were found</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
    <span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">ind_data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">catdata</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">catdata</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">index</span><span class="o">+</span><span class="mi">1</span>
    <span class="nb">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
48 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
48 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_3.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
49 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_5.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_5.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
48 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_7.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
42 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_9.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_9.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
42 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_11.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_11.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits
starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal_cat.ecsv
43 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_14.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_14.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits
starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal_cat.ecsv
42 sources found
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_42_16.png" src="../../../_images/exec_jwst_tweakreg_miri_test_42_16.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h3>Look at positions of RA, Dec and get stats on differences for the combined image run with tweakreg on<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_combined_i2d.fits&#39;</span><span class="p">)</span>
<span class="n">pixarea</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel area in steradians&#39;</span><span class="p">,</span> <span class="n">pixarea</span><span class="p">)</span>

<span class="c1"># pull out data portion of input file</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># print stats on input image</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pixel area in steradians 2.84403609523084e-13
Image mean, median and std 10.235801 10.815083 46.580975
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run DAOStarFinder to find sources in image</span>

<span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>    

<span class="c1"># Create apertures for x,y positions</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
<span class="c1">#print(positions)</span>

<span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
<span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>

<span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
<span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of sources found with DAOStarFinder: &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">ra</span><span class="p">))</span>

<span class="c1"># add RA, Dec to sources table</span>

<span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
<span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

<span class="c1"># print RA, Dec for each x, y position found</span>
<span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

<span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Put ra, dec coords into a table</span>
<span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
<span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    
<span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
<span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>    
<span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
<span class="c1"># Find where the catalogs match</span>
    
<span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
<span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
<span class="c1">#print(cat1_matched)</span>
    
<span class="c1"># Get differences in RA, Dec</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
<span class="c1">#print(ra_diff)</span>
    
<span class="c1"># put differences in milliarcseconds</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>

<span class="n">deltara_twon</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">deltadec_twon</span> <span class="o">=</span> <span class="p">[]</span>
    
<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
<span class="c1"># Find if the differences are within the allowed 30 mas range</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
    <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
    <span class="n">deltara_twon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">deltadec_twon</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
<span class="c1"># Plot ra and dec differences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">deltara_twon</span><span class="p">,</span><span class="n">deltadec_twon</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot should show no differences greater than 30 milliarcseconds  </span>

<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of sources matched: &#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">deltara_twon</span><span class="p">))</span>
<span class="c1"># Plot ra and dec differences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">deltadec_twon</span><span class="p">,</span><span class="n">deltara_twon</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot should show no differences greater than 30 milliarcseconds      </span>

    
<span class="n">meanRAdiff_twon</span><span class="p">,</span> <span class="n">medianRAdiff_twon</span><span class="p">,</span> <span class="n">stdRAdiff_twon</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltara_twon</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_twon</span><span class="p">,</span> <span class="n">medianDecdiff_twon</span><span class="p">,</span> <span class="n">stdDecdiff_twon</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltadec_twon</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twon</span><span class="p">,</span> <span class="n">medianRAdiff_twon</span><span class="p">,</span> <span class="n">stdRAdiff_twon</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twon</span><span class="p">,</span> <span class="n">medianDecdiff_twon</span><span class="p">,</span> <span class="n">stdDecdiff_twon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of sources found with DAOStarFinder:  50
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
 695.5013548466345  122.7766822148834  0.0008813127711848324   -0.014625592280985556
  772.622355870295 126.26211162239302     359.99852555828454   -0.014311146882553569
 973.4755225173215 151.46687244793293     359.99243365822446   -0.012997617522665683
1041.0315301090152 156.07277990007543      359.9903742570985   -0.012674551574549303
 531.6380617008092 182.87454090622103   0.006068387211350582   -0.013223523830829635
 795.8149629671833 192.30948795497238     359.99799204349574   -0.012223198410312979
460.99121071659505  203.8389836956923   0.008291395128115275   -0.012770720539687534
 516.4547466729491 217.46520522871936   0.006627120148882256   -0.012203565446996089
 573.6924942597375  231.0210100241405   0.004908244412918651   -0.011633794958262018
  900.378793636403 253.34340104152753      359.9949495561515   -0.010070008630413524
 637.7014894481655 262.20435391238334   0.003029149884609637   -0.010505202490352536
  944.249745256695  281.0758036150554      359.9936787645776   -0.009101446322500492
1031.0586062444565 281.71110791085965      359.9910182339413   -0.008848335263431813
 467.0122923701653 295.54534279712846   0.008353549666593126   -0.009942079895567935
478.64964320231053  301.9725125347997   0.008013954568909827    -0.00971365301591269
 552.5291343986906 312.83636550493435   0.005777467628056271    -0.00918165117495608
 794.1217001059757   323.049911813381     359.99839583222257   -0.008218228747440503
 558.7575494438215 327.60533071378177   0.005626203093158925   -0.008711956416118237
 936.3166965228578   341.639925769424     359.99408504949963  -0.0072654254903042875
 805.0144707064991 356.24546182026927     359.99815111319623   -0.007170877259243554
443.93218115179155 379.67209333337263   0.009287776134737535   -0.007424209111462298
 728.6572480977529  405.3443108581321  0.0006249636230007285   -0.005870620690204058
 784.5693601909767  428.8969589374621     359.99897364666947     -0.0049978362160516
 622.6243608537537 468.96269002723784   0.004047978931706245   -0.004204947150378807
 520.7401944013179  537.6463943486103   0.007357394174708574  -0.0023727655854824544
 753.4537984267902  562.0338406187477  0.0002862034012571584  -0.0009985560989411908
 792.8057822419727  572.2176767479797      359.9991067705582  -0.0005803323242990133
486.08968997344084  574.6782309506119    0.00851971372348013  -0.0013303334639881254
 758.4517447748846  586.5352020888255 0.00019886736220156245 -0.00023370127374210204
 398.7049092070945  625.7081520413215   0.011336952660279858   -5.33350227070635e-07
 944.4241633306826   671.446648990372     359.99472401553373   0.0028708547837702383
 978.0647270137692  680.8081724897208      359.9937175265814    0.003248488912027896
1058.5842198371327  696.4879267373101      359.9912903662334   0.0039460541649459415
 857.5414671330773  704.9788479430549      359.9974787651557   0.0036653887571342796
 902.8340678635095  738.9553374442862      359.9961811792853    0.004829269768244018
 547.0073182614829  815.6280884544537   0.007299966641166674      0.0062230258559148
 752.0521164151188  846.5236152306722  0.0010948336027019729    0.007722359376478992
1042.6359364801756  848.4611646734135     359.99218846925504    0.008563824046673878
 849.5551465909484  856.3807508790155      359.9981311543543    0.008287065041455509
 565.7254013558644   907.132633744602   0.006972188388601411    0.009079648604212632
 907.3444147431707  964.0451068178483     359.99664863784875    0.011744425961837628
  862.506712042935  970.4781140805266      359.9980410265319    0.011821041335819195
 908.1161872251349  979.3231794869931     359.99666608693013    0.012215048535409698
 898.1535541902788  1024.086471850172     359.99709209025923    0.013561029796379274
1065.3165287546758  1023.618011062102      359.9919643017816    0.013996546362951503
 885.8561202005831 1034.8525111300462       359.997498200532    0.013858105072482656
 844.6926929622099  1036.628147882081     359.99876537279664     0.01380177747387025
 983.4449525482632 1052.7150783170187     359.99455343489126    0.014668550842290382
 716.8225684154393 1093.0997116161004   0.002838854904186443    0.015189503341270545
 547.2145120087068 1106.8176402343722   0.008077287098746213    0.015153738695364238

RA_Diff (mas)  Dec_diff (mas) pass/fail
      -2.257932       -4.401094 pass
      -2.878085        7.578261 pass
      -2.867755       -9.201956 pass
       7.632536        8.764391 pass
       9.209824       -0.528777 pass
       4.007506        4.041867 pass
       1.419029       -9.956108 pass
      -4.445440       -9.400474 pass
       2.569405       -4.800470 pass
      -4.199030        4.893755 pass
      -1.303744        1.533463 pass
       0.678199        2.334975 pass
       0.178199       -1.531765 pass
       4.479887        4.338150 pass
       4.633555        2.659303 pass
       2.752479        5.593239 pass
      -0.522345        9.012029 pass
       3.695515       10.948809 pass
       1.393961        1.714209 pass
      -0.825990       -4.796367 pass
      -4.871990       -3.010378 pass
      -0.805915       -4.352801 pass
       0.324933        7.307267 pass
       1.318440        0.194994 pass
       2.002145        7.168931 pass
       7.356585       10.085723 pass
      -0.120092       -7.106919 pass
       1.689318       -7.833432 pass
       3.524154       -7.009741 pass
      -5.516539       -2.344230 pass
      -2.513586        5.566907 pass
       0.925555       -1.985668 pass
      -2.034391        9.183032 pass
       0.645427       -9.828834 pass
       0.555676        3.834149 pass
       1.422461        8.206057 pass
       3.436448        1.249143 pass
      -1.704307       -1.839917 pass
      -4.077496       -6.124585 pass
      -3.544079       -0.522778 pass
       5.969608       -2.223082 pass
      11.925976        1.467788 pass
       0.731135        3.756902 pass
       1.978800        6.912376 pass
       0.312948        7.374727 pass
       7.739585       10.071035 pass
       0.842189       -1.206948 pass
       2.996001       -0.823491 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_45_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_45_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of sources matched:  48
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_45_3.png" src="../../../_images/exec_jwst_tweakreg_miri_test_45_3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.1220575628978426 0.7866620390517207 3.7478347153110656
Dec difference mean, median and std (units in mas) 0.9367013327956238 1.358465583157706 5.969151909744572
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mark sources on image frame to see if the correct sources were found</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
<span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
<span class="n">apertures</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span> <span class="c1">#, alpha=0.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_46_0.png" src="../../../_images/exec_jwst_tweakreg_miri_test_46_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a closer look at a portion of the image to get a closer look at the psf</span>

<span class="c1"># mark sources on image frame to see if the correct sources were found</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
<span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">350</span><span class="p">:</span><span class="mi">450</span><span class="p">,</span> <span class="mi">700</span><span class="p">:</span><span class="mi">820</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
<span class="c1">#apertures.plot(color=&#39;red&#39;, lw=2.5) #, alpha=0.5)</span>
<span class="c1">#plt.scatter(sources[&#39;xcentroid&#39;]-700, sources[&#39;ycentroid&#39;]-350, color=&#39;red&#39;)</span>
<span class="c1">#plt.ylim(350,450)</span>
<span class="c1">#plt.xlim(700,820)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_47_0.png" src="../../../_images/exec_jwst_tweakreg_miri_test_47_0.png" />
</div>
</div>
</section>
<section id="test-again-with-tweakreg-off">
<h3>Test again with tweakreg off<a class="headerlink" href="#test-again-with-tweakreg-off" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run Calwebb_image3 on the association table with tweakreg on</span>
    
<span class="c1"># set any specific parameters</span>
<span class="c1"># tweakreg parameters to allow data to run</span>
<span class="n">fwhm</span> <span class="o">=</span> <span class="mf">3.318</span> <span class="c1">#3.27  # Gaussian kernel FWHM of objects expected, default=2.5</span>
<span class="n">minobj</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># minimum number of objects needed to match positions for a good fit, default=15</span>
<span class="n">snr</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1"># signal to noise threshold, default=5</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="mi">3</span> <span class="c1"># clipping limit, in sigma units, used when performing fit, default=3</span>
<span class="n">fit_geom</span> <span class="o">=</span><span class="s1">&#39;rshift&#39;</span> <span class="c1"># ftype of affine transformation to be considered when fitting catalogs, default=&#39;general&#39;</span>
<span class="n">use2dhist</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># boolean indicating whether to use 2D histogram to find initial offset, default=True</span>
   
<span class="c1">#pipe3=Image3Pipeline()    </span>
<span class="c1">#pipe3.tweakreg.kernel_fwhm = fwhm</span>
<span class="c1">#pipe3.tweakreg.snr_threshold = snr</span>
<span class="c1">#pipe3.tweakreg.minobj = minobj</span>
<span class="c1">#pipe3.tweakreg.sigma = sigma</span>
<span class="c1">#pipe3.tweakreg.fitgeometry = fit_geom</span>
<span class="c1">#pipe3.tweakreg.use2dhist = use2dhist</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">tweakreg</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>        <span class="c1"># test to see if this affects the final output</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">outlier_detection</span><span class="o">.</span><span class="n">skip</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">source_catalog</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">pipe3</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="c1">#pipe3.output_dir = datadir</span>

<span class="c1"># run Image3</span>

<span class="c1">#im = pipe3.run(rtdata.input)</span>
<span class="n">image</span> <span class="o">=</span> <span class="n">pipe3</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_asnfile.json&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image 3 pipeline finished.&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,667 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline running with args (&#39;starfield_50star4ptdither_asnfile.json&#39;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,674 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: &#39;/internal/data1/jenkins/workspace/Notebooks/jwst_validation_notebooks_spacetelescope/tmp/tmpw1aaeqbv/starfield_50star4ptdither_combined.fits&#39;, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;image3pipeline&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;steps&#39;: {&#39;assign_mtwcs&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;assign_mtwcs&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;}, &#39;tweakreg&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;tweakreg&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: True, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 3.318, &#39;snr_threshold&#39;: 40, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: True, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}, &#39;skymatch&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;skymatch&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}, &#39;outlier_detection&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;crf&#39;, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}, &#39;resample&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}, &#39;source_catalog&#39;: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}}}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,808 - stpipe.Image3Pipeline - INFO - Prefetching reference files for dataset: &#39;starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits&#39; reftypes = [&#39;abvegaoffset&#39;, &#39;apcorr&#39;, &#39;drizpars&#39;]
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,812 - stpipe.Image3Pipeline - INFO - Prefetch for ABVEGAOFFSET reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,814 - stpipe.Image3Pipeline - INFO - Prefetch for APCORR reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,815 - stpipe.Image3Pipeline - INFO - Prefetch for DRIZPARS reference file is &#39;/grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits&#39;.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:17,817 - stpipe.Image3Pipeline - INFO - Starting calwebb_image3 ...
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,150 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,152 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: True, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;tweakreg&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;save_catalogs&#39;: True, &#39;catalog_format&#39;: &#39;ecsv&#39;, &#39;kernel_fwhm&#39;: 3.318, &#39;snr_threshold&#39;: 40, &#39;brightest&#39;: 200, &#39;peakmax&#39;: None, &#39;enforce_user_order&#39;: False, &#39;expand_refcat&#39;: False, &#39;minobj&#39;: 5, &#39;searchrad&#39;: 2.0, &#39;use2dhist&#39;: True, &#39;separation&#39;: 1.0, &#39;tolerance&#39;: 0.7, &#39;xoffset&#39;: 0.0, &#39;yoffset&#39;: 0.0, &#39;fitgeometry&#39;: &#39;rshift&#39;, &#39;nclip&#39;: 3, &#39;sigma&#39;: 3, &#39;align_to_gaia&#39;: False, &#39;gaia_catalog&#39;: &#39;GAIADR2&#39;, &#39;min_gaia&#39;: 5, &#39;save_gaia_catalog&#39;: False}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,153 - stpipe.Image3Pipeline.tweakreg - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,166 - stpipe.Image3Pipeline.tweakreg - INFO - Step tweakreg done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,368 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,370 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: False, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;skymatch&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;skymethod&#39;: &#39;match&#39;, &#39;match_down&#39;: True, &#39;subtract&#39;: False, &#39;stepsize&#39;: None, &#39;skystat&#39;: &#39;mode&#39;, &#39;dqbits&#39;: &#39;~DO_NOT_USE+NON_SCIENCE&#39;, &#39;lower&#39;: None, &#39;upper&#39;: None, &#39;nclip&#39;: 5, &#39;lsigma&#39;: 4.0, &#39;usigma&#39;: 4.0, &#39;binwidth&#39;: 0.1}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,609 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,610 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() started on 2022-07-07 08:28:19.609604
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,611 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,612 - stpipe.Image3Pipeline.skymatch - INFO - Sky computation method: &#39;match&#39;
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,612 - stpipe.Image3Pipeline.skymatch - INFO - Sky matching direction: DOWN
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,613 - stpipe.Image3Pipeline.skymatch - INFO - Sky subtraction from image data: OFF
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,614 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:19,614 - stpipe.Image3Pipeline.skymatch - INFO - ----  Computing differences in sky values in overlapping regions.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,197 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00258738
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,200 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq1_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0122796
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,201 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00816192
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,202 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq2_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00662269
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,202 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,203 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq3_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.00758915
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,204 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp1_cal.fits. Sky background: 0.00479741
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,204 - stpipe.Image3Pipeline.skymatch - INFO -    *  Image ID=starfield_50star4ptdither_seq4_MIRIMAGE_F1130Wexp2_cal.fits. Sky background: 0.0132615
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,205 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,206 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() ended on 2022-07-07 08:28:32.205553
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,206 - stpipe.Image3Pipeline.skymatch - INFO - ***** jwst.skymatch.skymatch.match() TOTAL RUN TIME: 0:00:12.595949
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,207 - stpipe.Image3Pipeline.skymatch - INFO -  
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,242 - stpipe.Image3Pipeline.skymatch - INFO - Step skymatch done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,451 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,453 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: True, &#39;suffix&#39;: &#39;crf&#39;, &#39;search_output_file&#39;: False, &#39;input_dir&#39;: &#39;&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;nlow&#39;: 0, &#39;nhigh&#39;: 0, &#39;maskpt&#39;: 0.7, &#39;grow&#39;: 1, &#39;snr&#39;: &#39;5.0 4.0&#39;, &#39;scale&#39;: &#39;1.2 0.7&#39;, &#39;backg&#39;: 0.0, &#39;save_intermediate_results&#39;: False, &#39;resample_data&#39;: True, &#39;good_bits&#39;: &#39;~DO_NOT_USE&#39;, &#39;scale_detection&#39;: False, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,454 - stpipe.Image3Pipeline.outlier_detection - INFO - Step skipped.
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,466 - stpipe.Image3Pipeline.outlier_detection - INFO - Step outlier_detection done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,642 - stpipe.Image3Pipeline.resample - INFO - Step resample running with args (&lt;ModelContainer&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,644 - stpipe.Image3Pipeline.resample - INFO - Step resample parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;i2d&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;pixfrac&#39;: 1.0, &#39;kernel&#39;: &#39;square&#39;, &#39;fillval&#39;: &#39;INDEF&#39;, &#39;weight_type&#39;: &#39;ivm&#39;, &#39;output_shape&#39;: None, &#39;crpix&#39;: None, &#39;crval&#39;: None, &#39;rotation&#39;: None, &#39;pixel_scale_ratio&#39;: 1.0, &#39;pixel_scale&#39;: None, &#39;single&#39;: False, &#39;blendheaders&#39;: True, &#39;allowed_memory&#39;: None}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,662 - stpipe.Image3Pipeline.resample - INFO - Drizpars reference file: /grp/crds/cache/references/jwst/jwst_miri_drizpars_0001.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:32,849 - stpipe.Image3Pipeline.resample - INFO - Blending metadata for starfield_50star4ptdither_combined.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:33,551 - stpipe.Image3Pipeline.resample - INFO - Resampling science data
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:34,127 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:35,047 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:35,967 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:36,885 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:37,804 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:38,737 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:39,670 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:40,644 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:40,995 - stpipe.Image3Pipeline.resample - INFO - Resampling var_rnoise
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:41,630 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:42,596 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:43,541 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:44,467 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:45,450 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:46,401 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:47,337 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:48,270 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:48,633 - stpipe.Image3Pipeline.resample - INFO - Resampling var_poisson
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:49,212 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:50,174 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:51,170 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:52,168 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:53,108 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:54,046 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:54,972 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:55,901 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:56,259 - stpipe.Image3Pipeline.resample - INFO - Resampling var_flat
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:56,835 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:57,776 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:58,722 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:28:59,677 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:00,615 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:01,593 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:02,554 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:03,561 - stpipe.Image3Pipeline.resample - INFO - Drizzling (1024, 1032) --&gt; (1142, 1118)
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:03,945 - stpipe.Image3Pipeline.resample - INFO - Update S_REGION to POLYGON ICRS  0.021880629 -0.020262886 0.024954079 0.014759789 359.990667431 0.017768647 359.987593981 -0.017254027
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,393 - stpipe.Image3Pipeline.resample - INFO - Saved model in starfield_50star4ptdither_combined_i2d.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,394 - stpipe.Image3Pipeline.resample - INFO - Step resample done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,634 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog running with args (&lt;ImageModel(1142, 1118) from starfield_50star4ptdither_combined_i2d.fits&gt;,).
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,636 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog parameters are: {&#39;pre_hooks&#39;: [], &#39;post_hooks&#39;: [], &#39;output_file&#39;: None, &#39;output_dir&#39;: None, &#39;output_ext&#39;: &#39;.fits&#39;, &#39;output_use_model&#39;: False, &#39;output_use_index&#39;: True, &#39;save_results&#39;: True, &#39;skip&#39;: False, &#39;suffix&#39;: &#39;cat&#39;, &#39;search_output_file&#39;: True, &#39;input_dir&#39;: &#39;&#39;, &#39;bkg_boxsize&#39;: 100, &#39;kernel_fwhm&#39;: 2.0, &#39;snr_threshold&#39;: 3.0, &#39;npixels&#39;: 5, &#39;deblend&#39;: False, &#39;aperture_ee1&#39;: 30, &#39;aperture_ee2&#39;: 50, &#39;aperture_ee3&#39;: 70, &#39;ci1_star_threshold&#39;: 2.0, &#39;ci2_star_threshold&#39;: 1.8}
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,654 - stpipe.Image3Pipeline.source_catalog - INFO - Using APCORR reference file: /grp/crds/cache/references/jwst/jwst_miri_apcorr_0005.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,668 - stpipe.Image3Pipeline.source_catalog - INFO - Using ABVEGAOFFSET reference file: /grp/crds/cache/references/jwst/jwst_miri_abvegaoffset_0001.asdf
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,669 - stpipe.Image3Pipeline.source_catalog - INFO - Instrument: MIRI
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,669 - stpipe.Image3Pipeline.source_catalog - INFO - Detector: MIRIMAGE
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,670 - stpipe.Image3Pipeline.source_catalog - INFO - Filter: F1130W
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,671 - stpipe.Image3Pipeline.source_catalog - INFO - Subarray: FULL
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:04,722 - stpipe.Image3Pipeline.source_catalog - INFO - AB to Vega magnitude offset 5.49349
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:05,277 - stpipe.Image3Pipeline.source_catalog - INFO - Detected 520 sources
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:05,820 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote source catalog: starfield_50star4ptdither_combined_cat.ecsv
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:05,941 - stpipe.Image3Pipeline.source_catalog - INFO - Saved model in starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:05,943 - stpipe.Image3Pipeline.source_catalog - INFO - Wrote segmentation map: starfield_50star4ptdither_combined_segm.fits
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:05,944 - stpipe.Image3Pipeline.source_catalog - INFO - Step source_catalog done
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-07-07 08:29:05,946 - stpipe.Image3Pipeline - INFO - Step Image3Pipeline done
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Image 3 pipeline finished.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">im</span> <span class="o">=</span> <span class="n">ImageModel</span><span class="p">(</span><span class="s1">&#39;starfield_50star4ptdither_combined_i2d.fits&#39;</span><span class="p">)</span>
<span class="n">pixarea</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">photometry</span><span class="o">.</span><span class="n">pixelarea_steradians</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel area in steradians&#39;</span><span class="p">,</span> <span class="n">pixarea</span><span class="p">)</span>

<span class="c1"># pull out data portion of input file</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">data</span>

<span class="c1"># print stats on input image</span>
<span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">200.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Image mean, median and std&#39;</span><span class="p">,</span><span class="n">mean</span><span class="p">,</span> <span class="n">median</span><span class="p">,</span> <span class="n">std</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Pixel area in steradians
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> 2.84403609523084e-13
Image mean, median and std 10.150862 10.816078 38.378338
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run DAOStarFinder to find sources in image</span>

<span class="n">ap_radius</span> <span class="o">=</span> <span class="mf">5.</span>  <span class="c1"># radius for aperture for centroiding and photometry</span>

<span class="n">daofind</span> <span class="o">=</span> <span class="n">DAOStarFinder</span><span class="p">(</span><span class="n">fwhm</span><span class="o">=</span><span class="mf">3.0</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mf">10.</span><span class="o">*</span><span class="n">std</span><span class="p">)</span>    <span class="c1"># default threshold=5*std, fwhm=3</span>
<span class="n">sources</span> <span class="o">=</span> <span class="n">daofind</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>    

<span class="c1">#sources.pprint_all()</span>
<span class="c1">#print(sources[&#39;xcentroid&#39;,&#39;ycentroid&#39;,&#39;peak&#39;])   </span>

<span class="c1"># Create apertures for x,y positions</span>
<span class="n">positions</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">]))</span>
<span class="c1">#print(positions)</span>

<span class="c1">#positions = (sources[&#39;xcentroid&#39;], sources[&#39;ycentroid&#39;])</span>
<span class="n">apertures</span> <span class="o">=</span> <span class="n">CircularAperture</span><span class="p">(</span><span class="n">positions</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">ap_radius</span><span class="p">)</span>


<span class="c1"># using wcs info from images, put coordinates into RA, Dec</span>
<span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">im</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">wcs</span><span class="p">(</span><span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">],</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;ycentroid&#39;</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of sources found with DAOStarFinder: &#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">size</span><span class="p">(</span><span class="n">ra</span><span class="p">))</span>
<span class="c1"># add RA, Dec to sources table</span>

<span class="n">ra_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ra</span><span class="p">)</span>
<span class="n">dec_col</span> <span class="o">=</span> <span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Dec&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">dec</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">ra_col</span><span class="p">)</span>
<span class="n">sources</span><span class="o">.</span><span class="n">add_column</span><span class="p">(</span><span class="n">dec_col</span><span class="p">)</span>

<span class="c1"># print RA, Dec for each x, y position found</span>
<span class="c1">#print(sources[&#39;xcentroid&#39;, &#39;ycentroid&#39;, &#39;RA&#39;, &#39;Dec&#39;])  </span>

<span class="n">sources_sub</span> <span class="o">=</span> <span class="n">sources</span><span class="p">[</span><span class="s1">&#39;xcentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;ycentroid&#39;</span><span class="p">,</span> <span class="s1">&#39;RA&#39;</span><span class="p">,</span> <span class="s1">&#39;Dec&#39;</span><span class="p">]</span>
<span class="n">sources_sub</span><span class="o">.</span><span class="n">pprint_all</span><span class="p">()</span>
<span class="nb">print</span><span class="p">()</span>

<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="c1">#print(&#39;       RA found       Dec found    RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;)</span>

<span class="n">deltara_twoff</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">deltadec_twoff</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Put ra, dec coords into a table</span>
<span class="n">cat1_sim</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">RA_sim</span><span class="p">,</span> <span class="n">Dec_sim</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
<span class="n">cat2_calc</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;ra&#39;</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">))</span>
    
<span class="c1"># Get coordinates with SkyCoord for each catalog</span>
    
<span class="n">coord_cat1_sim</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat1_sim</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>
<span class="n">coord_cat2_calc</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="n">ra</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">],</span> <span class="n">dec</span><span class="o">=</span><span class="n">cat2_calc</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">],</span> <span class="n">unit</span><span class="o">=</span><span class="s2">&quot;deg&quot;</span><span class="p">)</span>    
<span class="n">ind_cat2_cat1</span><span class="p">,</span> <span class="n">dist_2d</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">match_coordinates_sky</span><span class="p">(</span><span class="n">coord_cat1_sim</span><span class="p">,</span> <span class="n">coord_cat2_calc</span><span class="p">)</span>
    
<span class="c1"># Find where the catalogs match</span>
    
<span class="n">cat1_matched</span> <span class="o">=</span> <span class="n">cat1_sim</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]</span>
<span class="n">cat2_matched</span> <span class="o">=</span> <span class="n">cat2_calc</span><span class="p">[</span><span class="n">ind_cat2_cat1</span><span class="p">[</span><span class="n">dist_2d</span><span class="o">.</span><span class="n">arcsec</span><span class="o">&lt;</span><span class="mf">0.05</span><span class="p">]]</span>
    
<span class="c1">#print(cat1_matched)</span>
    
<span class="c1"># Get differences in RA, Dec</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;ra&#39;</span><span class="p">]</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">cat2_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">cat1_matched</span><span class="p">[</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span> 
    
<span class="c1">#print(ra_diff)</span>
    
<span class="c1"># put differences in milliarcseconds</span>
<span class="n">ra_diff</span> <span class="o">=</span> <span class="n">ra_diff</span> <span class="o">*</span> <span class="mi">3600000</span>
<span class="n">dec_diff</span> <span class="o">=</span> <span class="n">dec_diff</span> <span class="o">*</span> <span class="mi">3600000</span>

    
<span class="c1"># Compare input RA, Dec to found RA, Dec</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA_Diff (mas)  Dec_diff (mas) pass/fail&#39;</span><span class="p">)</span>
<span class="c1"># Find if the differences are within the allowed 30 mas range</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">)):</span>
    <span class="c1">#if ra_diff[i] &lt; 30 and dec_diff[i] &lt; 30:</span>
    <span class="n">deltara_twoff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">deltadec_twoff</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span> <span class="ow">and</span> <span class="nb">abs</span><span class="p">(</span><span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">30</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;pass&#39;</span> 
    <span class="k">else</span><span class="p">:</span> 
        <span class="n">test</span> <span class="o">=</span> <span class="s1">&#39;fail&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{:15.6f}</span><span class="s1"> </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ra_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dec_diff</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">test</span><span class="p">))</span>
 
    
<span class="c1"># Plot ra and dec differences</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span> <span class="p">(</span><span class="s1">&#39;Differences in RA and Dec in milliarcseconds&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Delta RA&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Delta Dec&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">deltara_twoff</span><span class="p">,</span><span class="n">deltadec_twoff</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1"># Plot should show no differences greater than 30 milliarcseconds </span>

<span class="nb">print</span><span class="p">()</span>
    
<span class="n">meanRAdiff_twoff</span><span class="p">,</span> <span class="n">medianRAdiff_twoff</span><span class="p">,</span> <span class="n">stdRAdiff_twoff</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltara_twoff</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>
<span class="n">meanDecdiff_twoff</span><span class="p">,</span> <span class="n">medianDecdiff_twoff</span><span class="p">,</span> <span class="n">stdDecdiff_twoff</span> <span class="o">=</span> <span class="n">sigma_clipped_stats</span><span class="p">(</span><span class="n">deltadec_twoff</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">5.0</span><span class="p">,</span> <span class="n">maxiters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># default sigma=3</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twoff</span><span class="p">,</span> <span class="n">medianRAdiff_twoff</span><span class="p">,</span> <span class="n">stdRAdiff_twoff</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std (units in mas)&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twoff</span><span class="p">,</span> <span class="n">medianDecdiff_twoff</span><span class="p">,</span> <span class="n">stdDecdiff_twoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of sources found with DAOStarFinder:  53
    xcentroid          ycentroid                RA                     Dec          
------------------ ------------------ ---------------------- -----------------------
  695.585776112344   122.834262537915  0.0008790960591962484   -0.014623804201933937
 772.6017877671096 126.26968385287942     359.99852642678394   -0.014311175000364341
 973.4892523508298  151.5056066875812     359.99243355874603   -0.012996597663287137
1041.0470776199775  156.0626772581467      359.9903739704418   -0.012675024544997172
 531.6363570022298 182.85517527014605   0.006068604713303265   -0.013224327308012759
  795.810277651175 192.30053511395235     359.99799238043056   -0.012223690571236661
460.99247823080657 203.85432246345692    0.00829161487822159   -0.012770451708592038
 516.4775392160169 217.46310926648974   0.006626632850906603    -0.01220377337145032
 573.6679717794119 231.04195340673564   0.004909270170172627   -0.011633423654002564
 900.3879745231552 253.30653555198055     359.99494939271887   -0.010071319494098245
 637.6995135373593 262.19495784166776  0.0030294025350135582   -0.010505700952388218
 944.2837868634169  281.0829501502735      359.9936779571693   -0.009101340524990013
1031.0725483396684 281.77971410500123     359.99101820834727   -0.008846398724386436
466.96957235956097 295.53635696203935   0.008355052954752022   -0.009942675430630647
 478.6687613809888 301.93850781690423    0.00801349408014806    -0.00971484940181868
 552.5280942878344  312.8939068343935   0.005777871727251441   -0.009180094292827824
 794.1325469636332 323.05885641797437      359.9983957409863   -0.008218130230759532
 558.7826103420849 327.55726652600305   0.005625522515932203    -0.00871356798208173
 936.3465671470273 341.66897158289675     359.99408442894367   -0.007264659314492122
 805.0007864073226 356.23281454222496     359.99815171616774  -0.0071715069394287225
443.93636149543585  379.6403053250637   0.009287779722975013   -0.007425377717691395
  727.899947561219  405.1997978556544  0.0006480168122534914  -0.0058772956926689355
 728.9047840584352   405.511339652207  0.0006180390923579087   -0.005865037074031557
 728.8120143509632  406.0528206723386  0.0006223414200598616   -0.005848680688934685
 784.4973224673485 428.91720255756894     359.99897612773344  -0.0049976142491543404
  622.629374027297  468.9804364775933   0.004048090290283375   -0.004204594400193533
 520.7164511672005  537.5885283575799   0.007358183935530173   -0.002374809097579285
 753.4538985429468  562.0559839316289 0.00028647726591703496  -0.0009980817289141082
 792.8038521187716  572.2364598709937     359.99910709764276  -0.0005799664680080453
486.10978070299393  574.7248376268371   0.008519440357071313   -0.001329055054880885
 758.4604280684595  586.5090190902955 0.00019874793936219904 -0.00023468586767363186
398.71067168369865  625.6783622252026   0.011336913105615276 -1.6364182321354342e-06
 944.4439351193226  671.4095278216872     359.99472352661286   0.0028695645821009844
 978.0731698897646  680.7838015712019      359.9937174194085   0.0032475592436636185
1058.6147262775114  696.5275285986722      359.9912897545877    0.003947145783092525
 857.4790201476912  704.9502551751136     359.99748082065963    0.003664138828820516
 902.8217442659221  739.0334817894199     359.99618198487326    0.004831428133362782
 547.0063261928785   815.728608022902   0.007300484933782626    0.006225900917262201
 752.0451189469344  846.4534031362222  0.0010950765800723061    0.007719982303743326
  1042.69764775955   848.543678216834      359.9921870161119     0.00856631565460784
 849.5551438974722  856.4151878037583      359.9981314644576    0.008287916153339611
 565.7167242005792   907.130158643154   0.006972665178038632    0.009079344358405428
 907.3434821372305   964.059763396204      359.9966489232358    0.011744667950491014
  862.597652652995   970.440136219333     359.99803835271126     0.01181991639688334
  908.111106560794  979.3392149324197     359.99666650324014    0.012215321647331329
 898.1178014475097 1024.1041213408932      359.9970934515596     0.01356126986024123
1065.2926418445852 1023.6517241503843      359.9919653424142    0.013997310997057609
 885.8494492009091  1034.880525613361      359.9974986978532    0.013858741275577258
 844.6829138881079  1036.697759621286     359.99876607738594    0.013803681010297447
 983.4265112842527 1052.7493079744086     359.99455430990787    0.014669345974227452
 716.8408263997155 1093.2005747229316   0.002838783763768758    0.015192440745365545
 713.2823979436079 1097.8268953405832   0.002960363846635457    0.015324743261045206
  547.222468444588 1106.8229293364939   0.008077274667509168    0.015153717326669031

RA_Diff (mas)  Dec_diff (mas) pass/fail
       0.278589        2.451637 pass
      -1.087729        9.868592 pass
      -1.881843       -7.494224 pass
       5.878263        8.015863 pass
      12.336422       -0.630001 pass
       6.178204        1.775018 pass
       4.262168      -17.312751 pass
       2.954375      -13.900216 pass
       1.585285       -0.198198 pass
      -3.324312       -3.663707 pass
      -0.276351        2.404622 pass
       2.394641        1.239690 pass
      -2.055803        1.226468 pass
       8.172613        5.674846 pass
       4.588803        2.582376 pass
      -0.154190        5.974110 pass
      -0.778450       19.586683 pass
      -5.930239        6.899029 pass
       2.176968       -1.178309 pass
       0.351514       -3.479285 pass
       4.059840       -2.211297 pass
      -0.792997       -8.559784 pass
       5.225614        8.171497 pass
      -0.883484        4.124819 pass
       1.413788        2.449821 pass
       8.569550        8.313944 pass
       1.745762        3.243302 pass
      -3.541997        1.136357 pass
       3.925045       -5.739841 pass
      -4.061782        3.260546 pass
       1.232691        8.319589 pass
      -0.106409       -3.688362 pass
       7.260524        2.535506 pass
       1.115668       12.045507 pass
       3.545544       -2.058720 pass
       1.672047        6.898152 pass
       2.213562        9.173849 pass
       1.778689       -3.057847 pass
      -2.090129       -5.186723 pass
      -4.507418       -9.669124 pass
      -5.304194       -5.167504 pass
       5.611486        1.448412 pass
       3.945813        7.904873 pass
      -1.718943       -2.044735 pass
       7.390637        4.768450 pass
       1.811664        8.357930 pass
       8.649126        8.276571 pass
       0.750050        5.764592 pass
       2.667551       -0.468831 pass
</pre></div>
</div>
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_51_1.png" src="../../../_images/exec_jwst_tweakreg_miri_test_51_1.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>RA difference mean, median and std (units in mas) 1.7805352132316612 1.672047255851794 3.8957032498583533
Dec difference mean, median and std (units in mas) 1.5955753956851049 2.4046217676543247 6.730500918309516
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># mark sources on image frame to see if the correct sources were found</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
<span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span><span class="c1">#, norm=norm)</span>
<span class="n">apertures</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span> <span class="c1">#, alpha=0.5)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_52_0.png" src="../../../_images/exec_jwst_tweakreg_miri_test_52_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Take a closer look at a portion of the image to get a closer look at the psf</span>

<span class="c1"># mark sources on image frame to see if the correct sources were found</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">stretch</span><span class="o">=</span><span class="n">SqrtStretch</span><span class="p">())</span>
<span class="c1"># keep image stretch in mind for plotting. sky subtracted range ~ (-15, 10), single sample ~ (0, 20)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">350</span><span class="p">:</span><span class="mi">450</span><span class="p">,</span> <span class="mi">700</span><span class="p">:</span><span class="mi">820</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span><span class="c1">#, norm=norm)</span>

<span class="c1">#plt.scatter(sources[&#39;xcentroid&#39;]-700, sources[&#39;ycentroid&#39;]-350, color=&#39;red&#39;)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../../_images/exec_jwst_tweakreg_miri_test_53_0.png" src="../../../_images/exec_jwst_tweakreg_miri_test_53_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Compare stats across tests:</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;All units are milliarcseconds for statistics&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in individual calibrated files&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_cal</span><span class="p">,</span> <span class="n">medianRAdiff_cal</span><span class="p">,</span> <span class="n">stdRAdiff_cal</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_cal</span><span class="p">,</span> <span class="n">medianDecdiff_cal</span><span class="p">,</span> <span class="n">stdDecdiff_cal</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="c1">#print(&#39;Statistics on differences between RA and Dec in individual i2d files when run with tweakreg on&#39;)</span>
<span class="c1">#print(&#39;RA difference mean, median and std&#39;,meanRAdiff_i2d, medianRAdiff_i2d, stdRAdiff_i2d) </span>
<span class="c1">#print(&#39;Dec difference mean, median and std&#39;,meanDecdiff_i2d, medianDecdiff_i2d, stdDecdiff_i2d)</span>
<span class="c1">#print()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in combined i2d file when run with tweakreg on&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twon</span><span class="p">,</span> <span class="n">medianRAdiff_twon</span><span class="p">,</span> <span class="n">stdRAdiff_twon</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twon</span><span class="p">,</span> <span class="n">medianDecdiff_twon</span><span class="p">,</span> <span class="n">stdDecdiff_twon</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Statistics on differences between RA and Dec in combined i2d file when run with tweakreg off&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;RA difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanRAdiff_twoff</span><span class="p">,</span> <span class="n">medianRAdiff_twoff</span><span class="p">,</span> <span class="n">stdRAdiff_twoff</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Dec difference mean, median and std&#39;</span><span class="p">,</span><span class="n">meanDecdiff_twoff</span><span class="p">,</span> <span class="n">medianDecdiff_twoff</span><span class="p">,</span> <span class="n">stdDecdiff_twoff</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>All units are milliarcseconds for statistics
Statistics on differences between RA and Dec in individual calibrated files
RA difference mean, median and std 1.1084997025612093 0.928302277808206 3.5773131993903524
Dec difference mean, median and std -0.17537865973407207 1.1691161048078824 5.539940734870295

Statistics on differences between RA and Dec in combined i2d file when run with tweakreg on
RA difference mean, median and std 1.1220575628978426 0.7866620390517207 3.7478347153110656
Dec difference mean, median and std 0.9367013327956238 1.358465583157706 5.969151909744572

Statistics on differences between RA and Dec in combined i2d file when run with tweakreg off
RA difference mean, median and std 1.7805352132316612 1.672047255851794 3.8957032498583533
Dec difference mean, median and std 1.5955753956851049 2.4046217676543247 6.730500918309516
</pre></div>
</div>
</div>
</div>
</section>
<section id="criteria-for-success">
<h3>Criteria for success.<a class="headerlink" href="#criteria-for-success" title="Permalink to this headline">#</a></h3>
<p>If the first set of images with no shift are well aligned as shown in images and the statistical comparison, that test passes.</p>
<p>Once a shift is added, the statistics and number of sources found dont tell the whole story. Look at the combined images shown after image3 with and without tweakreg. If the image run with tweakreg shows double sources just like the image without tweakreg, then the test fails. If the image doesnt show double sources and looks like the unshifted combined image, then the test passes. Examine the image to look for obvious faults like stars that were not identified as stars, those with multiple star identifications, double star images, etc.</p>
<section id="about-this-notebook">
<h4>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this headline">#</a></h4>
<p>Authors: M. Cracraft, M. Libralato and K. Gordon, MIRI Branch</p>
<p>Updated On: 08/25/2021</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TheRealZoidberg/jwst_validation_test",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/tweakreg/jwst_tweakreg_miri_test"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../regression_test/outlier_detection/exec_jwst_outlier_detection_unit_tests.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="jwst_tweakreg_miri_test.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By STScI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>