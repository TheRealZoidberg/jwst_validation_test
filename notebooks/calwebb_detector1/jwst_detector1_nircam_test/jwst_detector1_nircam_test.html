
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging &#8212; Notebook repository template</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" href="../../../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/main.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../../_static/sphinx-thebe.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.1/dist/embed-amd.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging" href="exec_jwst_detector1_nircam_test.html" />
    <link rel="prev" title="JWST Pipeline Validation Notebook: calwebb_image3 with MIRI" href="../../calwebb_image3/jwst_image3_miri_test/jwst_image3_miri_test.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Notebook repository template</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../../index.html">
                    <no title>
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/jwst_background_subtraction_miri_imaging_testing.html">
   JWST Pipeline Validation Notebook: calwebb_image2, background subtraction for MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/exec_jwst_background_subtraction_miri_imaging_testing.html">
   JWST Pipeline Validation Notebook: calwebb_image2, background subtraction for MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/exec_background_sub-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: Background_subtract() for MIRI LRS SLIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../background/jwst_background_miri_test/background_sub-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: Background_subtract() for MIRI LRS SLIT
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pathloss/jwst_pathloss_nirspec_test/exec_jwst_pathloss_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, pathloss step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../pathloss/jwst_pathloss_nirspec_test/jwst_pathloss_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, pathloss step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../msaflagopen/jwst_msa_flagging_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, msa_flagging step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../msaflagopen/exec_jwst_msa_flagging_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, msa_flagging step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/jwst_resample_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/exec_jwst_resample_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/jwst_resample_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../resample/jwst_resample_miri_test/exec_jwst_resample_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Resample step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../example_notebook/example_notebook.html">
   Draft: Notebook title
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_miri_test/exec_jwst_source_catalog_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_miri_test/jwst_source_catalog_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3: source_catalog with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_nircam_test/jwst_nircam_imaging_source_catalog.html">
   JWST Pipeline Validation Notebook: NIRCam, calwebb_image3, source_catalog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../source_catalog/jwst_source_catalog_nircam_test/exec_jwst_nircam_imaging_source_catalog.html">
   JWST Pipeline Validation Notebook: NIRCam, calwebb_image3, source_catalog
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lastframe/exec_jwst_lastframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, lastframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../lastframe/jwst_lastframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, lastframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_lrs_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, photom, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_photom_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, photom, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_lrs_slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/photom_miri_lrs_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/exec_jwst_photom_miri_test.html">
   JWST Pipeline Validation Notebook: photom with MIRI Imager
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../photom/jwst_photom_miri_test/jwst_photom_miri_test.html">
   JWST Pipeline Validation Notebook: photom with MIRI Imager
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/run_ami_pipeline.html">
   JWST Pipeline Validation Notebook:  AMI3, AMI3 Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_analyze_verify.html">
   JWST Pipeline Validation Notebook: AMI3, AmiAnalyze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_average.html">
   JWST Pipeline Validation Notebook:  calwebb_ami3, ami_average
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_ami_normalize.html">
   JWST Pipeline Validation Notebook: calwebb_ami3, ami_normalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/exec_run_ami_pipeline.html">
   JWST Pipeline Validation Notebook:  AMI3, AMI3 Pipeline
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_normalize.html">
   JWST Pipeline Validation Notebook: calwebb_ami3, ami_normalize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_average.html">
   JWST Pipeline Validation Notebook:  calwebb_ami3, ami_average
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ami3/ami_analyze_verify.html">
   JWST Pipeline Validation Notebook: AMI3, AmiAnalyze
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_nirspec_test/jwst_assign_wcs_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: NIRSpec, spec2, assign_wcs step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_nirspec_test/exec_jwst_assign_wcs_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: NIRSpec, spec2, assign_wcs step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_niriss_test/jwst_assign_wcs_niriss_image.html">
   JWST Pipeline Validation Notebook: NIRISS, image2, assign_wcs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_niriss_test/exec_jwst_assign_wcs_niriss_image.html">
   JWST Pipeline Validation Notebook: NIRISS, image2, assign_wcs
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-mrs.html">
   JWST Pipeline Validation Testing Notebook: MIRI MRS Spec2: Assign_wcs()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-mrs.html">
   JWST Pipeline Validation Testing Notebook: MIRI MRS Spec2: Assign_wcs()
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/assign_wcs-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../assign_wcs/jwst_assign_wcs_miri_test/exec_assign_wcs-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../barshadow/jwst_barshadow_nirspec_test/jwst_barshadow_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, barshadow step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../barshadow/jwst_barshadow_nirspec_test/exec_jwst_barshadow_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, barshadow step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reset/jwst_reset_miri_test/exec_jwst_reset_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_detector1, reset step for MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../reset/jwst_reset_miri_test/jwst_reset_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_detector1, reset step for MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../refpix/jwst_refpix_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, refpix unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../refpix/exec_jwst_refpix_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, refpix unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_nirspec_test/jwst_flat_field_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, flat_field step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_nirspec_test/exec_jwst_flat_field_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, flat_field step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flatfield_analysis_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_jwst_flat_field_miri_test.html">
   JWST Pipeline Validation Testing notebook: flat_field step with MIRI Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flat-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flatfield_analysis_slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/exec_flat_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, flat_field, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flat-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit spectroscopy
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/jwst_flat_field_miri_test.html">
   JWST Pipeline Validation Testing notebook: flat_field step with MIRI Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../flat_field/jwst_flat_field_miri_test/flat_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, flat_field, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/jwst_skymatch_photom_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch and photometry with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/exec_jwst_skymatch_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/exec_jwst_skymatch_photom_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch and photometry with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../skymatch/jwst_skymatch_miri_test/jwst_skymatch_miri_test.html">
   JWST Pipeline Validation Notebook: skymatch with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_miri_test/jwst_jump_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, Jump step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_miri_test/exec_jwst_jump_miri_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, Jump step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/jwst_jump_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, jump unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../jump/exec_jwst_jump_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, jump unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_nircam_test/jwst_image3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_nircam_test/exec_jwst_image3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_miri_test/exec_jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image3/jwst_image3_miri_test/jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="exec_jwst_detector1_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jwst_detector1_miri_test/exec_jwst_detector1_miri_imtso_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1 for MIRI TSO imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jwst_detector1_miri_test/jwst_detector1_miri_imtso_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1 for MIRI TSO imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jwst_detector1_miri_test/exec_caldetector1-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jwst_detector1_miri_test/caldetector1-miri-lrs-tso.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Time Series Observation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, rscd unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/exec_jwst_rscd_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, rscd unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_miri_test/exec_jwst_miri_rscd_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, RSCD step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../rscd/jwst_rscd_miri_test/jwst_miri_rscd_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Detector1, RSCD step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image2/jwst_image2_nircam_test/jwst_image2_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image2, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_image2/jwst_image2_nircam_test/exec_jwst_image2_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_image2, NIRCam imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ramp_fitting/exec_jwst_ramp_fitting_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ramp_fitting unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ramp_fitting/jwst_ramp_fitting_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ramp_fitting unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../firstframe/exec_jwst_firstframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, firstframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../firstframe/jwst_firstframe_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, firstframe unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dq_init/exec_jwst_dq_init_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dq_init unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dq_init/jwst_dq_init_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dq_init unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/test_cube_build_spec3.html">
   JWST Pipeline Validation Testing Notebook: Cube Build with MIRISIM Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/exec_testing_point_source_flux_conservation_modeshep_all.html">
   JWST Pipeline Validation Testing Notebook: Point Source Flux Conservation Modeshep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/testing_point_source_flux_conservation_modeshep_all.html">
   JWST Pipeline Validation Testing Notebook: Point Source Flux Conservation Modeshep
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../cube_build/jwst_cube_build_miri_test/exec_test_cube_build_spec3.html">
   JWST Pipeline Validation Testing Notebook: Cube Build with MIRISIM Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../saturation/exec_jwst_saturation_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, saturation unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../saturation/jwst_saturation_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, saturation unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_2d/jwst_extract_2d_nirspec_test/jwst_extract_2d_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, extract_2d step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_2d/jwst_extract_2d_nirspec_test/exec_jwst_extract_2d_nirspec_test.html">
   JWST Pipeline Validation Testing Notebook: spec2, extract_2d step
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../persistence/exec_jwst_persistence_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, persistence unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../persistence/jwst_persistence_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, persistence unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/exec_extract_1d-spec2-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/extract_1d-spec2-miri-lrs-slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/extract_1d-spec2-miri-lrs-slit.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slit
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../extract_1d/jwst_extract_1d_miri_test/exec_extract_1d-spec2-miri-lrs-slitless.html">
   JWST Pipeline Validation Testing Notebook: MIRI LRS Slitless
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dark_current/exec_jwst_dark_current_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dark_current unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../dark_current/jwst_dark_current_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, dark_current unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/jwst_validation_notebook_template.html">
   JWST Pipeline Validation Notebook:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/exec_jwst_validation_notebook_template.html">
   JWST Pipeline Validation Notebook:
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/validation_test_template.html">
   JWST Pipeline Validation Testing Notebook: Descriptive Name of Test You Are Performing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../templates/exec_validation_test_template.html">
   JWST Pipeline Validation Testing Notebook: Descriptive Name of Test You Are Performing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ipc/exec_jwst_ipc_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ipc unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../ipc/jwst_ipc_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, ipc unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/background/exec_jwst_background_unit_tests.html">
   JWST calwebb_image2, background unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/background/jwst_background_unit_tests.html">
   JWST calwebb_image2, background unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_nirspec_regression_tests.html">
   JWST NIRSpec regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/flatfield/exec_jwst_flatfield_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, flatfield unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/flatfield/jwst_flatfield_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, flatfield unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_nircam_regression_tests.html">
   JWST NIRCam regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/resample/exec_jwst_resample_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, resample unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/resample/jwst_resample_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, resample unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_niriss_regression_tests.html">
   JWST NIRISS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/source_catalog/jwst_source_catalog_unit_tests.html">
   JWST calwebb_image3, source_catalog unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/source_catalog/exec_jwst_source_catalog_unit_tests.html">
   JWST calwebb_image3, source_catalog unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_fgs_regression_tests.html">
   JWST FGS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/photom/jwst_photom_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, photom unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/photom/exec_jwst_photom_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, photom unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/assign_wcs/jwst_assign_wcs_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, assign_wcs unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/assign_wcs/exec_jwst_assign_wcs_unit_tests.html">
   JWST calwebb_image2 and calwebb_spec2, assign_wcs unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/skymatch/jwst_skymatch_unit_tests.html">
   JWST calwebb_image3, skymatch unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/skymatch/exec_jwst_skymatch_unit_tests.html">
   JWST calwebb_image3, skymatch unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_niriss_regression_tests.html">
   JWST NIRISS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_nirspec_regression_tests.html">
   JWST NIRSpec regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_nircam_regression_tests.html">
   JWST NIRCam regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_fgs_regression_tests.html">
   JWST FGS regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/exec_jwst_miri_regression_tests.html">
   JWST MIRI regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/jwst_miri_regression_tests.html">
   JWST MIRI regression tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/tweakreg/exec_jwst_tweakreg_unit_tests.html">
   JWST calwebb_image3, tweakreg unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/tweakreg/jwst_tweakreg_unit_tests.html">
   JWST calwebb_image3, tweakreg unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/outlier_detection/jwst_outlier_detection_unit_tests.html">
   JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../regression_test/outlier_detection/exec_jwst_outlier_detection_unit_tests.html">
   JWST calwebb_image3, calwebb_spec3, calwebb_coron3, calwebb_tso3, outlier_detection unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tweakreg/jwst_tweakreg_miri_test/exec_jwst_tweakreg_miri_test.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../tweakreg/jwst_tweakreg_miri_test/jwst_tweakreg_miri_test.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Image3, Tweakreg step with MIRI imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_jwst_outlier_detection_miri_test.html">
   JWST Pipeline Validation Notebook: outlier_detection with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_jwst_outlier_detection_view_miri_test.html">
   JWST Pipeline Validation Notebook: MIRI view outlier_detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/exec_out_det_test2.html">
   JWST Pipeline Validation Notebook: Outlier Detection for MIRI MRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/out_det_test2.html">
   JWST Pipeline Validation Notebook: Outlier Detection for MIRI MRS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/jwst_outlier_detection_miri_test.html">
   JWST Pipeline Validation Notebook: outlier_detection with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../outlier_detection/jwst_outlier_detection_miri_test/jwst_outlier_detection_view_miri_test.html">
   JWST Pipeline Validation Notebook: MIRI view outlier_detection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../superbias/exec_jwst_superbias_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, superbias unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../superbias/jwst_superbias_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, superbias unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/exec_MIRI_shared_calcoron3_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Coron3 for MIRI Coronagraphic Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/jwst_calcoron3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_coron3 with NIRCam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/exec_jwst_calcoron3_nircam_test.html">
   JWST Pipeline Validation Notebook: calwebb_coron3 with NIRCam
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../calwebb_coron3/MIRI_shared_calcoron3_testing.html">
   JWST Pipeline Validation Testing Notebook: Calwebb_Coron3 for MIRI Coronagraphic Imaging
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fringe/JWST_fringe_miri_test/exec_fringe_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, fringe, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../fringe/JWST_fringe_miri_test/fringe_miri_mrs_test.html">
   JWST Pipeline Validation Testing Notebook: Spec2, fringe, MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../image3/jwst_image3_miri_test/exec_jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../image3/jwst_image3_miri_test/jwst_image3_miri_test.html">
   JWST Pipeline Validation Notebook: calwebb_image3 with MIRI
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../linearity/jwst_linearity_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, linearity unit tests
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../linearity/exec_jwst_linearity_unit_tests.html">
   JWST Pipeline Validation Notebook: calwebb_detector1, linearity unit tests
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/TheRealZoidberg/jwst_validation_test/main?urlpath=tree/notebooks/calwebb_detector1/jwst_detector1_nircam_test/jwst_detector1_nircam_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://colab.research.google.com/github/TheRealZoidberg/jwst_validation_test/blob/main/notebooks/calwebb_detector1/jwst_detector1_nircam_test/jwst_detector1_nircam_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Colab"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../../../_static/images/logo_colab.png">
  </span>
<span class="headerbtn__text-container">Colab</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/TheRealZoidberg/jwst_validation_test"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/TheRealZoidberg/jwst_validation_test/issues/new?title=Issue%20on%20page%20%2Fnotebooks/calwebb_detector1/jwst_detector1_nircam_test/jwst_detector1_nircam_test.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../../../_sources/notebooks/calwebb_detector1/jwst_detector1_nircam_test/jwst_detector1_nircam_test.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#table-of-contents">
     Table of Contents
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#jwst-calwg-algorithm">
   JWST CalWG Algorithm
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-terms">
   Defining Terms
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-description">
   Test Description
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-description">
   Data Description
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up-temporary-directory">
   Set up Temporary Directory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-desired-set-up-crds-to-use-a-local-cache">
     If Desired, set up CRDS to use a local cache
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-convenience-functions-and-parameters">
   Define convenience functions and parameters
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-the-data">
   Loading the Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-calwebb-detector1-pipeline-ramps-to-slopes">
   The calwebb_detector1 pipeline: Ramps to slopes
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-entire-calwebb-detecor1-pipeline">
   Run the entire
   <code class="docutils literal notranslate">
    <span class="pre">
     calwebb_detecor1
    </span>
   </code>
   pipeline
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examine-the-outputs">
     Examine the outputs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-individual-pipeline-steps">
   Run the individual pipeline steps
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-data-quality-initialization-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Data
      </span>
      <span class="pre">
       Quality
      </span>
      <span class="pre">
       Initialization
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#documentation">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arguments">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reference-files-used">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-the-step">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-saturation-flagging-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Saturation
      </span>
      <span class="pre">
       Flagging
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-superbias-subtraction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Superbias
      </span>
      <span class="pre">
       Subtraction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-reference-pixel-subtraction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Reference
      </span>
      <span class="pre">
       Pixel
      </span>
      <span class="pre">
       Subtraction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       Run the step
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#using-the-run-method">
         Using the run() method
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examine-the-output">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-linearity-correction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Linearity
      </span>
      <span class="pre">
       Correction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       Run the step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id21">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-persistence-correction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Persistence
      </span>
      <span class="pre">
       Correction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id22">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id23">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id24">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id25">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id26">
       Run the step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id27">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-dark-current-subtraction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Dark
      </span>
      <span class="pre">
       Current
      </span>
      <span class="pre">
       Subtraction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id28">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id29">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id30">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id31">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id32">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-cosmic-ray-flagging-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Cosmic
      </span>
      <span class="pre">
       Ray
      </span>
      <span class="pre">
       Flagging
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id33">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id34">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id35">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id36">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id37">
       Run the step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id38">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-ramp-fitting-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Ramp
      </span>
      <span class="pre">
       Fitting
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id39">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id40">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id41">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id42">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id43">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#about-this-notebook">
     About this Notebook
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#table-of-contents">
     Table of Contents
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#jwst-calwg-algorithm">
   JWST CalWG Algorithm
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#defining-terms">
   Defining Terms
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#test-description">
   Test Description
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-description">
   Data Description
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#set-up-temporary-directory">
   Set up Temporary Directory
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#if-desired-set-up-crds-to-use-a-local-cache">
     If Desired, set up CRDS to use a local cache
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#define-convenience-functions-and-parameters">
   Define convenience functions and parameters
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#loading-the-data">
   Loading the Data
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#the-calwebb-detector1-pipeline-ramps-to-slopes">
   The calwebb_detector1 pipeline: Ramps to slopes
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-entire-calwebb-detecor1-pipeline">
   Run the entire
   <code class="docutils literal notranslate">
    <span class="pre">
     calwebb_detecor1
    </span>
   </code>
   pipeline
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#examine-the-outputs">
     Examine the outputs
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-the-individual-pipeline-steps">
   Run the individual pipeline steps
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-data-quality-initialization-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Data
      </span>
      <span class="pre">
       Quality
      </span>
      <span class="pre">
       Initialization
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#summary">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#documentation">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#arguments">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reference-files-used">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#run-the-step">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-saturation-flagging-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Saturation
      </span>
      <span class="pre">
       Flagging
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id2">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id3">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id4">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id5">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-superbias-subtraction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Superbias
      </span>
      <span class="pre">
       Subtraction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id6">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id7">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id8">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id9">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id10">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-reference-pixel-subtraction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Reference
      </span>
      <span class="pre">
       Pixel
      </span>
      <span class="pre">
       Subtraction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id11">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id12">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id13">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id14">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id15">
       Run the step
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#using-the-run-method">
         Using the run() method
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#examine-the-output">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-linearity-correction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Linearity
      </span>
      <span class="pre">
       Correction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id16">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id17">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id18">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id19">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id20">
       Run the step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id21">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-persistence-correction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Persistence
      </span>
      <span class="pre">
       Correction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id22">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id23">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id24">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id25">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id26">
       Run the step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id27">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-dark-current-subtraction-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Dark
      </span>
      <span class="pre">
       Current
      </span>
      <span class="pre">
       Subtraction
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id28">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id29">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id30">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id31">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id32">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-cosmic-ray-flagging-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Cosmic
      </span>
      <span class="pre">
       Ray
      </span>
      <span class="pre">
       Flagging
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id33">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id34">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id35">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id36">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id37">
       Run the step
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id38">
       Examine the output
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-ramp-fitting-step">
     The
     <code class="docutils literal notranslate">
      <span class="pre">
       Ramp
      </span>
      <span class="pre">
       Fitting
      </span>
     </code>
     step
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id39">
       Summary
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id40">
       Documentation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id41">
       Arguments
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id42">
       Reference files used
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id43">
       Run the step
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#about-this-notebook">
     About this Notebook
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a id="title_ID"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="jwst-pipeline-validation-notebook-calwebb-detector1-nircam-imaging">
<h1>JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging<a class="headerlink" href="#jwst-pipeline-validation-notebook-calwebb-detector1-nircam-imaging" title="Permalink to this headline">#</a></h1>
<p><span style="color:red"> <strong>Instruments Affected</strong></span>: e.g., NIRCam</p>
<section id="table-of-contents">
<h2>Table of Contents<a class="headerlink" href="#table-of-contents" title="Permalink to this headline">#</a></h2>
<div style="text-align: left"> 
<p><br> <a class="reference external" href="#intro">Introduction*</a>
<br> <a class="reference external" href="#algorithm">JWST CalWG Algorithm*</a>
<br> <a class="reference external" href="#terms">Defining Terms</a>
<br> <a class="reference external" href="#description">Test Description*</a>
<br> <a class="reference external" href="#data_descr">Data Description*</a>
<br> <a class="reference external" href="#imports">Imports*</a>
<br> <a class="reference external" href="#convenience_functions">Convenience Functions</a>
<br> <a class="reference external" href="#download_data">Loading the Data*</a>
<br> <a class="reference external" href="#detector1">calwebb_detector1 - Ramps to slopes</a>
<br> <a class="reference external" href="#detector1_at_once">Run the entire pipeline</a>
<br> <a class="reference external" href="#detector1_step_by_step">Run the individual pipeline steps</a>
<br> <a class="reference external" href="#dq_init">The <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Quality</span> <span class="pre">Initialization</span></code> step</a>
<br> <a class="reference external" href="#saturation">The <code class="docutils literal notranslate"><span class="pre">Saturation</span> <span class="pre">Flagging</span></code> step</a>
<br> <a class="reference external" href="#superbias">The <code class="docutils literal notranslate"><span class="pre">Superbias</span> <span class="pre">Subtraction</span></code> step</a>
<br> <a class="reference external" href="#refpix">The <code class="docutils literal notranslate"><span class="pre">Reference</span> <span class="pre">Pixel</span> <span class="pre">Subtraction</span></code> step</a>
<br> <a class="reference external" href="#linearity">The <code class="docutils literal notranslate"><span class="pre">Linearity</span> <span class="pre">Correction</span></code> step</a>
<br> <a class="reference external" href="#persistence">The <code class="docutils literal notranslate"><span class="pre">Persistence</span> <span class="pre">Correction</span></code> step</a>
<br> <a class="reference external" href="#dc">The <code class="docutils literal notranslate"><span class="pre">Dark</span> <span class="pre">Current</span> <span class="pre">Subtraction</span></code> step</a>
<br> <a class="reference external" href="#jump">The <code class="docutils literal notranslate"><span class="pre">Cosmic</span> <span class="pre">Ray</span> <span class="pre">Flagging</span></code> step</a>
<br> <a class="reference external" href="#ramp_fitting">The <code class="docutils literal notranslate"><span class="pre">Ramp_Fitting</span></code> step</a>
<br> <a class="reference external" href="#about">About This Notebook*</a>
<br></p>
</div><p><a id='intro'></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">#</a></h1>
<p>This is the validation notebook for Stage 1 of the JWST calibration pipeline, also known as <em>calwebb_detector1</em>. The <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/pipeline/calwebb_detector1.html#calwebb-detector1">Stage 1 pipeline</a> applies basic detector-level corrections to all exposure types (imaging, spectroscopic, coronagraphic, etc.). It is applied to one exposure at a time, beginning with an uncalibrated multiaccum ramp (<em>_uncal.fits file</em>). It is sometimes referred to as ramps-to-slopes processing. The output is a corrected but uncalibrated countrate or slope image (<em>_rate.fits and _rateints.fits file</em>).</p>
<p>Pipeline description: <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/pipeline/calwebb_detector1.html">https://jwst-pipeline.readthedocs.io/en/latest/jwst/pipeline/calwebb_detector1.html</a></p>
<p>Pipeline code: <a class="reference external" href="https://github.com/spacetelescope/jwst/tree/master/jwst">https://github.com/spacetelescope/jwst/tree/master/jwst</a></p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id="algorithm"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="jwst-calwg-algorithm">
<h1>JWST CalWG Algorithm<a class="headerlink" href="#jwst-calwg-algorithm" title="Permalink to this headline">#</a></h1>
<p>This stage takes the raw images and returns the level 2a files, calibrated to slope (counts/sec) images.
The current status of the algorithms for this pipeline stage is summarized on the JWST CalWG algorithm Confluence page.  Links are provided to individual pages where the details of the algorithms are given along with notes on why those algorithms were picked.</p>
<p>The algorithms for each step in each pipeline stage are split into baseline and enhanced versions (formerly known as vanilla and optimal, respectively).  See Baseline and Enhanced Algorithms for more details.
Input/Outputs of this stage refer to the main data products for the pipeline process. The full list of archive products for this (and all stages of the pipeline) is tabulated in Archive Products.</p>
<p><a class="reference external" href="https://outerspace.stsci.edu/display/JWSTCC/CALWEBB_DETECTOR1">JWST CalWG algorithms for calwebb_detector1</a></p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id="terms"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="defining-terms">
<h1>Defining Terms<a class="headerlink" href="#defining-terms" title="Permalink to this headline">#</a></h1>
<p><strong>JWST</strong>: James Webb Space Telescope</p>
<p><strong>NIR</strong>: Near Infrared</p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id="description"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="test-description">
<h1>Test Description<a class="headerlink" href="#test-description" title="Permalink to this headline">#</a></h1>
<p>This test is performed by running simulated data through the full pipeline and performing a visual inspection of the outputs. Next, the notebook does quick checks after each step in the calwebb_detector1 pipeline, based on the algorithms defined.</p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id="data_descr"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-description">
<h1>Data Description<a class="headerlink" href="#data-description" title="Permalink to this headline">#</a></h1>
<p>For this module, we will use an uncalibrated NIRCam simulated imaging exposure generated with Mirage.</p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id="tempdir"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="set-up-temporary-directory">
<h1>Set up Temporary Directory<a class="headerlink" href="#set-up-temporary-directory" title="Permalink to this headline">#</a></h1>
<p>The following cell sets up a temporary directory (using pythons <code class="docutils literal notranslate"><span class="pre">tempfile.TemporaryDirectory()</span></code>), and changes the scripts active directory into that directory (using pythons <code class="docutils literal notranslate"><span class="pre">os.chdir()</span></code>). This is so that, when the notebook is run through, it will download files to (and create output files in) the temporary directory rather than in the notebooks directory. This makes cleanup significantly easier (since all output files are deleted when the notebook is shut down), and also means that different notebooks in the same directory wont interfere with each other when run by the automated webpage generation process.</p>
<p>If you want the notebook to generate output in the notebooks directory, simply dont run this cell.</p>
<p>If you have a file (or files) that are kept in the notebooks directory, and that the notebook needs to use while running, you can copy that file into the directory (the code to do so is present below, but commented out).</p>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#****</span>
<span class="c1">#</span>
<span class="c1"># Set this variable to False to not use the temporary directory</span>
<span class="c1">#</span>
<span class="c1">#****</span>
<span class="n">use_tempdir</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Create a temporary directory to hold notebook output, and change the working directory to that directory.</span>
<span class="kn">from</span> <span class="nn">tempfile</span> <span class="kn">import</span> <span class="n">TemporaryDirectory</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="k">if</span> <span class="n">use_tempdir</span><span class="p">:</span>
    <span class="n">data_dir</span> <span class="o">=</span> <span class="n">TemporaryDirectory</span><span class="p">()</span>

    <span class="c1"># If you have files that are in the notebook&#39;s directory, but that the notebook will need to use while</span>
    <span class="c1"># running, copy them into the temporary directory here.</span>
    <span class="c1">#</span>
    <span class="c1"># files = [&#39;name_of_file&#39;]</span>
    <span class="c1"># for file_name in files:</span>
    <span class="c1">#     shutil.copy(file_name, os.path.join(data_dir.name, file_name))</span>

    <span class="c1"># Save original directory</span>
    <span class="n">orig_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>

    <span class="c1"># Move to new directory</span>
    <span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="n">data_dir</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>

<span class="c1"># For info, print out where the script is running</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Running in </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Running in /tmp/tmp6pka5yiz
</pre></div>
</div>
</div>
</div>
<section id="if-desired-set-up-crds-to-use-a-local-cache">
<h2>If Desired, set up CRDS to use a local cache<a class="headerlink" href="#if-desired-set-up-crds-to-use-a-local-cache" title="Permalink to this headline">#</a></h2>
<p>By default, the notebook template environment sets up its CRDS cache (the CRDS_PATH environment variable) in /grp/crds/cache. However, if the notebook is running on a local machine without a fast and reliable connection to central storage, it makes more sense to put the CRDS cache locally. Currently, the cell below offers several options, and will check the supplied boolean variables one at a time until one matches.</p>
<ul class="simple">
<li><p>if <code class="docutils literal notranslate"><span class="pre">use_local_crds_cache</span></code> is False, then the CRDS cache will be kept in /grp/crds/cache</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">use_local_crds_cache</span></code> is True, the CRDS cache will be kept locally</p>
<ul>
<li><p>if <code class="docutils literal notranslate"><span class="pre">crds_cache_tempdir</span></code> is True, the CRDS cache will be kept in the temporary directory</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">crds_cache_notebook_dir</span></code> is True, the CRDS cache will be kept in the same directory as the notebook.</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">crds_cache_home</span></code> is True, the CRDS cache will be kept in $HOME/crds/cache</p></li>
<li><p>if <code class="docutils literal notranslate"><span class="pre">crds_cache_custom_dir</span></code> is True, the CRDS cache will be kept in whatever is stored in the
<code class="docutils literal notranslate"><span class="pre">crds_cache_dir_name</span></code> variable.</p></li>
</ul>
</li>
</ul>
<p>If the above cell (creating a temporary directory) is not run, then setting <code class="docutils literal notranslate"><span class="pre">crds_cache_tempdir</span></code> to True will store the CRDS cache in the notebooks directory (the same as setting <code class="docutils literal notranslate"><span class="pre">crds_cache_notebook_dir</span></code> to True).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="k">if</span> <span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;local&#39;</span><span class="p">:</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;HOME&#39;</span><span class="p">],</span> <span class="s1">&#39;crds&#39;</span><span class="p">,</span> <span class="s1">&#39;cache&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS cache location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">KeyError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">line</span> <span class="mi">7</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]):</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>         <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_CACHE_TYPE&#39;</span><span class="p">]</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;CRDS cache location: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;CRDS_PATH&#39;</span><span class="p">]))</span>

<span class="nn">File /usr/share/miniconda/lib/python3.9/os.py:679,</span> in <span class="ni">_Environ.__getitem__</span><span class="nt">(self, key)</span>
<span class="g g-Whitespace">    </span><span class="mi">676</span>     <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">encodekey</span><span class="p">(</span><span class="n">key</span><span class="p">)]</span>
<span class="g g-Whitespace">    </span><span class="mi">677</span> <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">678</span>     <span class="c1"># raise KeyError with the original key value</span>
<span class="ne">--&gt; </span><span class="mi">679</span>     <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="kn">from</span> <span class="bp">None</span>
<span class="g g-Whitespace">    </span><span class="mi">680</span> <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">decodevalue</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="ne">KeyError</span>: &#39;CRDS_PATH&#39;
</pre></div>
</div>
</div>
</div>
<p><a id="imports"></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="imports">
<h1>Imports<a class="headerlink" href="#imports" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Packages that allow us to get information about objects:</span>
<span class="kn">import</span> <span class="nn">asdf</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>

<span class="c1"># Numpy library:</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># For downloading data</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="c1"># Astropy tools:</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">download_file</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">ImageNormalize</span><span class="p">,</span> <span class="n">ManualInterval</span><span class="p">,</span> <span class="n">LogStretch</span>
</pre></div>
</div>
</div>
</div>
<p>Set up matplotlib for plotting</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>

<span class="c1"># Use this version for non-interactive plots (easier scrolling of the notebook)</span>
<span class="o">%</span><span class="k">matplotlib</span> inline

<span class="c1"># Use this version (outside of Jupyter Lab) if you want interactive plots</span>
<span class="c1">#%matplotlib notebook</span>

<span class="c1"># These gymnastics are needed to make the sizes of the figures</span>
<span class="c1"># be the same in both the inline and notebook versions</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.print_figure_kwargs = {&#39;bbox_inches&#39;: None}

<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">80</span>
</pre></div>
</div>
</div>
</div>
<p>Import JWST pipeline-related modules</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># List of possible data quality flags</span>
<span class="kn">from</span> <span class="nn">jwst.datamodels</span> <span class="kn">import</span> <span class="n">dqflags</span>

<span class="c1"># The entire calwebb_detector1 pipeline</span>
<span class="kn">from</span> <span class="nn">jwst.pipeline</span> <span class="kn">import</span> <span class="n">calwebb_detector1</span>

<span class="c1"># Individual steps that make up calwebb_detector1</span>
<span class="kn">from</span> <span class="nn">jwst.dq_init</span> <span class="kn">import</span> <span class="n">DQInitStep</span>
<span class="kn">from</span> <span class="nn">jwst.saturation</span> <span class="kn">import</span> <span class="n">SaturationStep</span>
<span class="kn">from</span> <span class="nn">jwst.superbias</span> <span class="kn">import</span> <span class="n">SuperBiasStep</span>
<span class="kn">from</span> <span class="nn">jwst.ipc</span> <span class="kn">import</span> <span class="n">IPCStep</span>                                                                                    
<span class="kn">from</span> <span class="nn">jwst.refpix</span> <span class="kn">import</span> <span class="n">RefPixStep</span>                                                                
<span class="kn">from</span> <span class="nn">jwst.linearity</span> <span class="kn">import</span> <span class="n">LinearityStep</span>
<span class="kn">from</span> <span class="nn">jwst.persistence</span> <span class="kn">import</span> <span class="n">PersistenceStep</span>
<span class="kn">from</span> <span class="nn">jwst.dark_current</span> <span class="kn">import</span> <span class="n">DarkCurrentStep</span>
<span class="kn">from</span> <span class="nn">jwst.jump</span> <span class="kn">import</span> <span class="n">JumpStep</span>
<span class="kn">from</span> <span class="nn">jwst.ramp_fitting</span> <span class="kn">import</span> <span class="n">RampFitStep</span>
<span class="kn">from</span> <span class="nn">jwst</span> <span class="kn">import</span> <span class="n">datamodels</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id='convenience_functions'></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="define-convenience-functions-and-parameters">
<h1>Define convenience functions and parameters<a class="headerlink" href="#define-convenience-functions-and-parameters" title="Permalink to this headline">#</a></h1>
<p>Here we define some functions and some parameters that we will use repeatedly throughout the notebook.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_jump</span><span class="p">(</span><span class="n">signal</span><span class="p">,</span> <span class="n">jump_group</span><span class="p">,</span> <span class="n">xpixel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypixel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to plot the signal up the ramp for a</span>
<span class="sd">    pixel and show the location of flagged jumps.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    signal : numpy.ndarray</span>
<span class="sd">        1D array of signal values</span>
<span class="sd">        </span>
<span class="sd">    jump_group : list</span>
<span class="sd">        List of boolean values whether a jump is present or</span>
<span class="sd">        not in each group</span>
<span class="sd">        </span>
<span class="sd">    slope : numpy.ndarray</span>
<span class="sd">        1D array of signal values constructed from the slope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">signal</span><span class="p">))</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">jump_group</span><span class="p">],</span> <span class="n">signal</span><span class="p">[</span><span class="n">jump_group</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Flagged Jump&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">slope</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">slope</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data from slope&#39;</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Groups&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (DN)&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">xpixel</span> <span class="ow">and</span> <span class="n">ypixel</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Pixel (&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">xpixel</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ypixel</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_jumps</span><span class="p">(</span><span class="n">signals</span><span class="p">,</span> <span class="n">jump_groups</span><span class="p">,</span> <span class="n">pixel_loc</span><span class="p">,</span> <span class="n">slopes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to plot the ramp and show the jump location</span>
<span class="sd">    for several pixels. For simplicity, let&#39;s force the input</span>
<span class="sd">    number of pixels to be a square. </span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    signals : numpy.ndarray</span>
<span class="sd">        2D array (groups x pix) of signal values</span>
<span class="sd">        </span>
<span class="sd">    jump_groups : numpy.ndarray</span>
<span class="sd">        2D array containing boolean entries for each group of</span>
<span class="sd">        each pixel, describing where the jumps were found</span>
<span class="sd">        </span>
<span class="sd">    pixel_loc : list</span>
<span class="sd">        List of 2-tuples containing the (x, y)</span>
<span class="sd">        location of the pixels with the jumps</span>
<span class="sd">        </span>
<span class="sd">    slopes : numpy.ndarray</span>
<span class="sd">        2D array (groups x pix) of linear signal values</span>
<span class="sd">        If not None, these will be overplotted onto the</span>
<span class="sd">        plots of signals</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">num_group</span><span class="p">,</span> <span class="n">num_pix</span> <span class="o">=</span> <span class="n">signals</span><span class="o">.</span><span class="n">shape</span>
    <span class="n">root</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">num_pix</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="n">root</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">!=</span> <span class="n">num_pix</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Number of pixels input should be a square.&#39;</span><span class="p">)</span>
    
    <span class="n">root</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
    <span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_group</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">root</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">pixel_loc</span><span class="p">)):</span>
        <span class="n">i</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span> <span class="o">%</span> <span class="n">root</span><span class="p">)</span>
        <span class="n">j</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">index</span> <span class="o">/</span> <span class="n">root</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signals</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
        <span class="n">j_grp</span> <span class="o">=</span> <span class="n">jump_groups</span><span class="p">[:,</span> <span class="n">index</span><span class="p">]</span>
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">[</span><span class="n">j_grp</span><span class="p">],</span> <span class="n">signals</span><span class="p">[</span><span class="n">j_grp</span><span class="p">,</span> <span class="n">index</span><span class="p">],</span>
                       <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">slopes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">slopes</span><span class="p">[:,</span> <span class="n">index</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
        
        <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Pixel (</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">pixel_loc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">pixel_loc</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Groups&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (DN)&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_ramp</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">xpixel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypixel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to plot the up the ramp signal for a pixel.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    groups : numpy.ndarray</span>
<span class="sd">        1D array of group numbers. X-axis values.</span>
<span class="sd">        </span>
<span class="sd">    signal : numpy.ndarray</span>
<span class="sd">        1D array of pixel signal values.</span>
<span class="sd">        </span>
<span class="sd">    xpixel : int</span>
<span class="sd">        X-coordinate of the pixel being plotted. Used for legend only.</span>
<span class="sd">        </span>
<span class="sd">    ypixel : int</span>
<span class="sd">        Y-coordinate of the pixel being plotted. Used for legend only.</span>
<span class="sd">        </span>
<span class="sd">    title : str</span>
<span class="sd">        String to use for the plot title</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">xpixel</span> <span class="ow">and</span> <span class="n">ypixel</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                     <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Pixel (&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">xpixel</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">ypixel</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;)&#39;</span><span class="p">)</span> 
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Groups&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (DN)&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_ramps</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to plot the up the ramp signal for two pixels</span>
<span class="sd">    on a single plot.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    groups : numpy.ndarray</span>
<span class="sd">        1D array of group numbers. X-axis values.</span>
<span class="sd">        </span>
<span class="sd">    signal1 : numpy.ndarray</span>
<span class="sd">        1D array of signal values for first pixel</span>
<span class="sd">        </span>
<span class="sd">    signal2 : numpy.ndarray</span>
<span class="sd">        1D array of signal values for second pixel</span>
<span class="sd">        </span>
<span class="sd">    label1 : str</span>
<span class="sd">        Label to place in the legend for pixel1</span>
<span class="sd">        </span>
<span class="sd">    label2 : str</span>
<span class="sd">        Label to place in the legend for pixel2</span>
<span class="sd">        </span>
<span class="sd">    title : str</span>
<span class="sd">        String to place in the title of the plot</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">label1</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label1</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal1</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label2</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">signal2</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">label1</span> <span class="ow">or</span> <span class="n">label2</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Groups&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Signal (DN)&#39;</span><span class="p">)</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.95</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_image</span><span class="p">(</span><span class="n">data_2d</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">xpixel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ypixel</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Function to generate a 2D, log-scaled image of the data, </span>
<span class="sd">    with an option to highlight a specific pixel (with a red dot).</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data_2d : numpy.ndarray</span>
<span class="sd">        Image to be displayed</span>
<span class="sd">        </span>
<span class="sd">    vmin : float</span>
<span class="sd">        Minimum signal value to use for scaling</span>
<span class="sd">        </span>
<span class="sd">    vmax : float</span>
<span class="sd">        Maximum signal value to use for scaling</span>
<span class="sd">        </span>
<span class="sd">    xpixel : int</span>
<span class="sd">        X-coordinate of pixel to highlight</span>
<span class="sd">        </span>
<span class="sd">    ypixel : int</span>
<span class="sd">        Y-coordinate of pixel to highlight</span>
<span class="sd">        </span>
<span class="sd">    title : str</span>
<span class="sd">        String to use for the plot title</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">data_2d</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">ManualInterval</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">),</span>
                          <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data_2d</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">xpixel</span> <span class="ow">and</span> <span class="n">ypixel</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xpixel</span><span class="p">,</span> <span class="n">ypixel</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Selected Pixel&#39;</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DN&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Pixel column&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Pixel row&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">side_by_side</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">,</span> <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Show two images side by side for easy comparison. Optionally highlight</span>
<span class="sd">    a given pixel with a red dot.</span>
<span class="sd">    </span>
<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    data1 : numpy.ndarray</span>
<span class="sd">        First image to be displayed</span>
<span class="sd">        </span>
<span class="sd">    data2 : numpy.ndarray</span>
<span class="sd">        Second image to be displayed</span>
<span class="sd">        </span>
<span class="sd">    vmin : float</span>
<span class="sd">        Minimum signal value to use for scaling</span>
<span class="sd">        </span>
<span class="sd">    vmax : float</span>
<span class="sd">        Maximum signal value to use for scaling</span>
<span class="sd">            </span>
<span class="sd">    title1 : str</span>
<span class="sd">        Title to use for first (left) plot</span>
<span class="sd">        </span>
<span class="sd">    title2 : str</span>
<span class="sd">        Title to use for the second (right) plot</span>

<span class="sd">    title : str</span>
<span class="sd">        String to use for the plot title</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">norm</span> <span class="o">=</span> <span class="n">ImageNormalize</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="n">ManualInterval</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">),</span>
                          <span class="n">stretch</span><span class="o">=</span><span class="n">LogStretch</span><span class="p">())</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">11</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    <span class="n">im</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;lower&#39;</span><span class="p">,</span> <span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">)</span>
    
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixel column&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Pixel row&#39;</span><span class="p">)</span>
    <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Pixel column&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">title1</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title1</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">title2</span><span class="p">:</span>
        <span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title2</span><span class="p">)</span>
        
    <span class="n">fig</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
    <span class="n">cbar_ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.85</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">])</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cbar_ax</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;DN&#39;</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id="data_load"></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="loading-the-data">
<h1>Loading the Data<a class="headerlink" href="#loading-the-data" title="Permalink to this headline">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">download_file</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">move</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">splitext</span>

<span class="k">def</span> <span class="nf">get_box_files</span><span class="p">(</span><span class="n">file_list</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">box_url</span><span class="p">,</span><span class="n">file_name</span> <span class="ow">in</span> <span class="n">file_list</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;https&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">box_url</span><span class="p">:</span>
            <span class="n">box_url</span> <span class="o">=</span> <span class="s1">&#39;https://stsci.box.com/shared/static/&#39;</span> <span class="o">+</span> <span class="n">box_url</span>
        <span class="n">downloaded_file</span> <span class="o">=</span> <span class="n">download_file</span><span class="p">(</span><span class="n">box_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">600</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span><span class="o">.</span><span class="n">suffix</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">ext</span> <span class="o">=</span> <span class="n">splitext</span><span class="p">(</span><span class="n">box_url</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">file_name</span> <span class="o">+=</span> <span class="n">ext</span>
        <span class="n">move</span><span class="p">(</span><span class="n">downloaded_file</span><span class="p">,</span> <span class="n">file_name</span><span class="p">)</span>
        
<span class="n">file_urls</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;https://stsci.box.com/shared/static/j46wpyirlbqo30e7c9719ycnuc1qk2lu.fits&#39;</span><span class="p">]</span>

<span class="n">file_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;jw98765001001_01101_00003_nrcb5_uncal.fits&#39;</span><span class="p">]</span>        

<span class="n">box_download_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">url</span><span class="p">,</span><span class="n">name</span><span class="p">)</span> <span class="k">for</span> <span class="n">url</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">file_urls</span><span class="p">,</span><span class="n">file_names</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_box_files</span><span class="p">(</span><span class="n">box_download_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<hr class="docutils" />
<p><a id='detector1'></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="the-calwebb-detector1-pipeline-ramps-to-slopes">
<h1>The calwebb_detector1 pipeline: Ramps to slopes<a class="headerlink" href="#the-calwebb-detector1-pipeline-ramps-to-slopes" title="Permalink to this headline">#</a></h1>
<p>In the sections below, we will run the Stage 1 pipeline on a single uncalibrated NIRCam file. We will first call the entire <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/latest/jwst/pipeline/calwebb_detector1.html#calwebb-detector1"><em>calwebb_detector1</em> pipeline</a> on the file. The pipeline is a wrapper which will string together all of the appropriate steps in the proper order.</p>
<p>The final output from this call is an uncalibrated slope image which is ready to go into the Stage 2 pipeline. Uncalibrated in this case means that the data are in units of DN/sec.</p>
<p>After that, we will go back to the original uncalibrated ramp and manually run it through each of the steps that comprise the Stage 1 pipeline. For each step we will examine the output.</p>
<p>See <a class="reference external" href="https://jwst-docs.stsci.edu/jwst-data-reduction-pipeline/stages-of-processing/calwebb_detector1">Figure 1</a> on the calwebb_detector1 algorithm page for a map of which steps are performed on NIR data.</p>
<p><a id='detector1_at_once'></a></p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="run-the-entire-calwebb-detecor1-pipeline">
<h1>Run the entire <code class="docutils literal notranslate"><span class="pre">calwebb_detecor1</span></code> pipeline<a class="headerlink" href="#run-the-entire-calwebb-detecor1-pipeline" title="Permalink to this headline">#</a></h1>
<p>In this section we run the entire calwebb_detector1 pipeline with a single call. In this case the pipeline code can determine which instrument was used to collect the data and runs the appropriate steps in the proper order.</p>
<p>We set parameter values for some of the individual steps, save some outputs, etc, and then call the pipeline.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an instance of the pipeline class</span>
<span class="n">detector1</span> <span class="o">=</span> <span class="n">calwebb_detector1</span><span class="o">.</span><span class="n">Detector1Pipeline</span><span class="p">()</span>

<span class="c1"># Set some parameters that pertain to the</span>
<span class="c1"># entire pipeline</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Set some parameters that pertain to some of</span>
<span class="c1"># the individual steps</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">refpix</span><span class="o">.</span><span class="n">use_side_ref_pixels</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">refpix</span><span class="o">.</span><span class="n">odd_even_rows</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Save outputs from steps to examine</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">dq_init</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">saturation</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">superbias</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">refpix</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">linearity</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">dark_current</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">persistence</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">jump</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">ramp_fit</span><span class="o">.</span><span class="n">save_opt</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">detector1</span><span class="o">.</span><span class="n">ramp_fit</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Call the run() method</span>
<span class="n">run_output</span> <span class="o">=</span> <span class="n">detector1</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<section id="examine-the-outputs">
<h2>Examine the outputs<a class="headerlink" href="#examine-the-outputs" title="Permalink to this headline">#</a></h2>
<p>The primary output of the calwebb_detector1 pipeline is a file containing a rate image for the exposure. The units of the data are ADU/sec.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate the rate file name from the uncal file name</span>
<span class="n">rate_file</span> <span class="o">=</span> <span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;rate.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rate_file</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use getdata to quickly read in the science data from the rate file</span>
<span class="n">rate_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">rate_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the rate image</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">rate_data</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate the linear step file name from the uncal file name</span>
<span class="n">linear_file</span> <span class="o">=</span> <span class="n">rate_file</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;rate.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;linearity.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Read in the science data from the linear file</span>
<span class="n">lin_data</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">getdata</span><span class="p">(</span><span class="n">linear_file</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We will look in more detail at the effects of the linearity correction step in the <a class="reference external" href="#linearity">linearity</a> section below. For now, lets just look at the final group of the integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s look at the data in the final group of the linearized data:</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">lin_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id='detector1_step_by_step'></a></p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="run-the-individual-pipeline-steps">
<h1>Run the individual pipeline steps<a class="headerlink" href="#run-the-individual-pipeline-steps" title="Permalink to this headline">#</a></h1>
<p>In the sections below we run the steps contained within calwebb_detector1 one at a time, in order to check the outputs for each step.</p>
<p><a id='dq_init'></a></p>
<section id="the-data-quality-initialization-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Quality</span> <span class="pre">Initialization</span></code> step<a class="headerlink" href="#the-data-quality-initialization-step" title="Permalink to this headline">#</a></h2>
<section id="summary">
<h3>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">#</a></h3>
<p>This step populates the Data Quality (DQ) mask that is associated with the data file. The DQ flags from the <code class="docutils literal notranslate"><span class="pre">MASK</span></code> reference file are copied into the <code class="docutils literal notranslate"><span class="pre">PIXELDQ</span></code> extension of the input file. A table showing the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/references_general/references_general.html#data-quality-flags">mapping of bit values</a> in the <code class="docutils literal notranslate"><span class="pre">MASK</span></code> file decribes what types of bad pixels can be flagged. Any other bad pixel types will be ignored.</p>
</section>
<section id="documentation">
<h3>Documentation<a class="headerlink" href="#documentation" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/dq_init/description.html">Full description</a> of the step.</p>
</section>
<section id="arguments">
<h3>Arguments<a class="headerlink" href="#arguments" title="Permalink to this headline">#</a></h3>
<p>There are no optional arguments for this step</p>
</section>
<section id="reference-files-used">
<h3>Reference files used<a class="headerlink" href="#reference-files-used" title="Permalink to this headline">#</a></h3>
<p>This step uses the <code class="docutils literal notranslate"><span class="pre">MASK</span></code> reference file.</p>
</section>
<section id="run-the-step">
<h3>Run the step<a class="headerlink" href="#run-the-step" title="Permalink to this headline">#</a></h3>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method. Instantiate and set parameters</span>
<span class="c1"># dq_init_step = DQInitStep()</span>
<span class="c1"># dq_init_step.save_results = True</span>

<span class="c1"># # Call the run() method on the uncal file</span>
<span class="c1"># dq_init = dq_init_step.run(file_names[0])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#with datamodels.open(file_names[0].replace(&#39;uncal.fits&#39;, &#39;dq_init.fits&#39;)) as dq_init:</span>
<span class="n">dq_init</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;dq_init.fits&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dq_init</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print the list of JWST bad pixel types</span>
<span class="n">dqflags</span><span class="o">.</span><span class="n">pixel</span>
</pre></div>
</div>
</div>
</div>
<p>The pixel values in the <code class="docutils literal notranslate"><span class="pre">SCI</span></code> extension are not changed in this step. Instead, the DQ flags are copied into the <code class="docutils literal notranslate"><span class="pre">PIXELDQ</span></code> extension. The <code class="docutils literal notranslate"><span class="pre">GROUPDQ</span></code> values are not changed in this step. Lets check the <code class="docutils literal notranslate"><span class="pre">PIXELDQ</span></code> values and see what has changed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print some basic information on the number of flagged pixels</span>
<span class="n">idx_pixelDQ</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">dq_init</span><span class="o">.</span><span class="n">pixeldq</span><span class="o">.</span><span class="n">flatten</span><span class="p">()</span> <span class="o">==</span> <span class="mf">0.</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">num_flagged</span> <span class="o">=</span> <span class="n">dq_init</span><span class="o">.</span><span class="n">pixeldq</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">idx_pixelDQ</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Total pixels in PIXELDQ: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dq_init</span><span class="o">.</span><span class="n">pixeldq</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> pixels have no flags.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">idx_pixelDQ</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> pixels (</span><span class="si">{:.2f}% o</span><span class="s1">f the detector) have flags.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_flagged</span><span class="p">,</span> <span class="n">num_flagged</span> <span class="o">/</span> <span class="n">dq_init</span><span class="o">.</span><span class="n">pixeldq</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">dq_init</span><span class="o">.</span><span class="n">pixeldq</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pixel DQ extension&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">)</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">dq_init</span><span class="o">.</span><span class="n">pixeldq</span><span class="p">,</span> <span class="n">return_counts</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">((</span><span class="n">unique</span><span class="p">,</span> <span class="n">counts</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of counts for each flag: &#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">frequencies</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Page</a></p>
<p><a id='saturation'></a></p>
</section>
</section>
<section id="the-saturation-flagging-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Saturation</span> <span class="pre">Flagging</span></code> step<a class="headerlink" href="#the-saturation-flagging-step" title="Permalink to this headline">#</a></h2>
<section id="id1">
<h3>Summary<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>This step checks the signal values in all pixels across all groups, and adds a <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/references_general/references_general.html#data-quality-flags"><code class="docutils literal notranslate"><span class="pre">saturated</span></code> flag</a> to the <code class="docutils literal notranslate"><span class="pre">GROUPDQ</span></code> extension for pixels and groups where the signal is above the saturation limit.</p>
</section>
<section id="id2">
<h3>Documentation<a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/saturation/description.html">Full description</a> of the step.</p>
</section>
<section id="id3">
<h3>Arguments<a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>There are no optional arguments for this step</p>
</section>
<section id="id4">
<h3>Reference files used<a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/saturation/reference_files.html"><code class="docutils literal notranslate"><span class="pre">SATURATION</span></code></a> reference file. This file contains a map of the saturation threshold in ADU for each pixel on the detector.</p>
</section>
<section id="id5">
<h3>Run the step<a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># saturation_step = SaturationStep()</span>
<span class="c1"># saturation_step.output_dir = output_dir</span>
<span class="c1"># saturation_step.save_results = True</span>

<span class="c1"># # Call using the the output from the previously-run dq_init step</span>
<span class="c1"># saturation = saturation_step.run(dq_init)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#with datamodels.open(file_names[0].replace(&#39;uncal.fits&#39;, &#39;saturation.fits&#39;)) as saturation:</span>
<span class="n">saturation</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;saturation.fits&#39;</span><span class="p">))</span>   
<span class="nb">print</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>If there are any saturated values, they should appear in the <code class="docutils literal notranslate"><span class="pre">GROUPDQ</span></code> arrays. Lets examine the <code class="docutils literal notranslate"><span class="pre">GROUPDQ</span></code> data and see if there are any detected:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find indexes of saturated pixels</span>
<span class="n">saturated</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">groupdq</span> <span class="o">&amp;</span> <span class="n">dqflags</span><span class="o">.</span><span class="n">pixel</span><span class="p">[</span><span class="s1">&#39;SATURATED&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_sat_flags</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">saturated</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">((</span><span class="s1">&#39;Found </span><span class="si">{}</span><span class="s1"> saturated flags. This may include multiple saturated &#39;</span>
       <span class="s1">&#39;groups within a given pixel&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">num_sat_flags</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Lets find a pixel that saturated part of the way up the ramp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a 4D boolean map of whether the saturation flag is present or not.</span>
<span class="n">saturated</span> <span class="o">=</span> <span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">groupdq</span> <span class="o">&amp;</span> <span class="n">dqflags</span><span class="o">.</span><span class="n">pixel</span><span class="p">[</span><span class="s1">&#39;SATURATED&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Collapse that down to a 2D map that lists the number of saturated groups </span>
<span class="c1"># for each pixel.</span>
<span class="n">saturated_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">saturated</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get coordinates of pixels that are saturated in some, but not all, groups.</span>
<span class="n">partial_sat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">saturated_2d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">saturated_2d</span> <span class="o">&lt;</span> <span class="n">saturated</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2"> pixels are partially saturated.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">partial_sat</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<p>Now lets choose one of these partially saturated pixels and look at the signal values up the ramp, along with which groups are flagged as saturated.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sat_y</span><span class="p">,</span> <span class="n">sat_x</span> <span class="o">=</span> <span class="n">partial_sat</span>
<span class="n">sat_index</span> <span class="o">=</span> <span class="mi">123</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">sat_y</span><span class="p">[</span><span class="n">sat_index</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sat_x</span><span class="p">[</span><span class="n">sat_index</span><span class="p">]</span>
<span class="n">grps</span> <span class="o">=</span> <span class="n">saturated</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Saturation flags up the ramp (0 is not saturated, 2 is saturated): </span><span class="si">{}</span><span class="s1">&#39;</span>
      <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">groupdq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Pixel signal values up the ramp: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<p>Plot these in order to get a clearer look at the data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the science and DQ values for the pixel.</span>
<span class="n">groups</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">full_ramp</span> <span class="o">=</span> <span class="n">saturation</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
<span class="n">sat_dq</span> <span class="o">=</span> <span class="n">saturation</span><span class="o">.</span><span class="n">groupdq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>

<span class="c1"># Make a copy of the science data and set all saturated groups to NaN</span>
<span class="n">saturated_points</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">])</span>
<span class="n">saturated_points</span><span class="p">[</span><span class="o">~</span><span class="n">sat_dq</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the pixel&#39;s values up the ramp and denote the saturated groups</span>
<span class="n">plot_ramps</span><span class="p">(</span><span class="n">groups</span><span class="p">,</span> <span class="n">full_ramp</span><span class="p">,</span> <span class="n">saturated_points</span><span class="p">,</span> <span class="n">label1</span><span class="o">=</span><span class="s1">&#39;Not Saturated&#39;</span><span class="p">,</span>
           <span class="n">label2</span><span class="o">=</span><span class="s1">&#39;Saturated&#39;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pixel (</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p><a id='superbias'> </a></p>
</section>
</section>
<section id="the-superbias-subtraction-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Superbias</span> <span class="pre">Subtraction</span></code> step<a class="headerlink" href="#the-superbias-subtraction-step" title="Permalink to this headline">#</a></h2>
<section id="id6">
<h3>Summary<a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>This step subtracts the superbias reference frame from each group of the science exposure.</p>
</section>
<section id="id7">
<h3>Documentation<a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/superbias/description.html">Full description</a> of the step.</p>
</section>
<section id="id8">
<h3>Arguments<a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p>There are no optional arguments for this step</p>
</section>
<section id="id9">
<h3>Reference files used<a class="headerlink" href="#id9" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/superbias/reference_files.html"><code class="docutils literal notranslate"><span class="pre">SUPERBIAS</span></code></a> reference file. This file contains a map of the superbias signal in ADU for each pixel on the detector.</p>
</section>
<section id="id10">
<h3>Run the step<a class="headerlink" href="#id10" title="Permalink to this headline">#</a></h3>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># superbias_step = SuperBiasStep()</span>
<span class="c1"># superbias_step.output_dir = output_dir</span>
<span class="c1"># superbias_step.save_results = True</span>

<span class="c1"># # Call using the the output from the previously-run saturation step</span>
<span class="c1"># superbias = superbias_step.run(saturation)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#with datamodels.open(file_names[0].replace(&#39;uncal.fits&#39;, &#39;superbias.fits&#39;)) as superbias:</span>
<span class="n">superbias</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;superbias.fits&#39;</span><span class="p">))</span>    
<span class="nb">print</span><span class="p">(</span><span class="n">superbias</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>Lets visually compare the science products to the raw <code class="docutils literal notranslate"><span class="pre">uncal</span></code> data, looking only at the last group of the first integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the shape of the data in the datamodel output from the step</span>
<span class="n">superbias</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the data before and after superbias subtraction</span>
<span class="n">side_by_side</span><span class="p">(</span><span class="n">saturation</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">superbias</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">11000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">18000</span><span class="p">,</span>
            <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Before superbias subtraction&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;After superbias subtraction&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
<p><a id='refpix'></a></p>
</section>
</section>
<section id="the-reference-pixel-subtraction-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Reference</span> <span class="pre">Pixel</span> <span class="pre">Subtraction</span></code> step<a class="headerlink" href="#the-reference-pixel-subtraction-step" title="Permalink to this headline">#</a></h2>
<section id="id11">
<h3>Summary<a class="headerlink" href="#id11" title="Permalink to this headline">#</a></h3>
<p>This step uses the reference pixels, which are not sensitive to illumination, to subtract group- and amplifier-dependent signal originating in the readout electronics from the data. There are two distinct corrections that are applied here.</p>
<p>First, the rows of reference pixels on the top and bottom of the detector are used to subtract amplifier-dependent offsets from each group. Within a given amplifier, the mean value of all reference pixels in even numbered columns is subtracted from the science pixels in the even numbered columns. The same strategy is used for the odd numbered columns.</p>
<p>The second part of the reference pixel subtraction step uses the reference pixels along the left and right sides of the detector to mitigate 1/f noise. This noise is visible in the data as horizontal banding that stretches across the entire detector.</p>
</section>
<section id="id12">
<h3>Documentation<a class="headerlink" href="#id12" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/refpix/description.html">Full description</a> of the step.</p>
</section>
<section id="id13">
<h3>Arguments<a class="headerlink" href="#id13" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/refpix/arguments.html">Full details on the optional arguments</a>.</p>
</section>
<section id="id14">
<h3>Reference files used<a class="headerlink" href="#id14" title="Permalink to this headline">#</a></h3>
<p>This step does not use any reference files.</p>
</section>
<section id="id15">
<h3>Run the step<a class="headerlink" href="#id15" title="Permalink to this headline">#</a></h3>
<p>In order to better show the effects from the 2 parts of the reference file subtraction, were going to run this step twice. First well perform only the mean value subtraction using the top and bottom reference pixels. Then on the second run, well perform both the mean value subtraction and the 1/f subtraction.</p>
<p><a id='refpix_run'></a></p>
<section id="using-the-run-method">
<h4>Using the run() method<a class="headerlink" href="#using-the-run-method" title="Permalink to this headline">#</a></h4>
<p>A reminder of the available parameters that can be set:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the spec attribute to print available parameters</span>
<span class="nb">print</span><span class="p">(</span><span class="n">RefPixStep</span><span class="o">.</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># For this &#39;partial&#39; run, we need to turn off the 1/f correction that</span>
<span class="c1"># uses the reference pixels on the sides of the detector. Also, we&#39;ll</span>
<span class="c1"># save the output using a unique name so as not to confuse the file</span>
<span class="c1"># with the output where we run the entire repix subtraction step.</span>

<span class="n">refpix_step_no_sidepix</span> <span class="o">=</span> <span class="n">RefPixStep</span><span class="p">()</span>
<span class="n">refpix_step_no_sidepix</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">refpix_step_no_sidepix</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="s1">&#39;refpix_test_no_side_pixels&#39;</span>

<span class="c1"># Turn off the 1/f correction</span>
<span class="n">refpix_step_no_sidepix</span><span class="o">.</span><span class="n">use_side_ref_pixels</span> <span class="o">=</span> <span class="kc">False</span>

<span class="c1"># Call using the the output from the previously-run superbias step</span>
<span class="n">refpix_no_sidepix</span> <span class="o">=</span> <span class="n">refpix_step_no_sidepix</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">superbias</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next run the full correction. This will produce the output that we will feed into subsequent steps.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instantiate and set parameters</span>
<span class="n">refpix_step</span> <span class="o">=</span> <span class="n">RefPixStep</span><span class="p">()</span>
<span class="n">refpix_step</span><span class="o">.</span><span class="n">save_results</span> <span class="o">=</span> <span class="kc">True</span>

<span class="c1"># Call using the saturation instance from the previously-run</span>
<span class="c1"># saturation step</span>
<span class="n">refpix</span> <span class="o">=</span> <span class="n">refpix_step</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">superbias</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="examine-the-output">
<h3>Examine the output<a class="headerlink" href="#examine-the-output" title="Permalink to this headline">#</a></h3>
<p>Lets explore the output from this step. As with all NIR detectors, the outermost 4 rows and columns comprise the reference pixels.</p>
<p>Lets use the datamodels from before and after the reference pixel subtraction to have a look at the data.</p>
<p>Well zoom in on the top few rows in order to see the changes. Note how the odd/even effect dominates the signal prior to reference pixel subtraction. Even numbered columns and odd numbered columns have significantly different signal levels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Side by side, before/after reference pixel subtraction</span>
<span class="n">side_by_side</span><span class="p">(</span><span class="n">superbias</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2030</span><span class="p">:,</span> <span class="mi">1030</span><span class="p">:</span><span class="mi">1050</span><span class="p">],</span> <span class="n">refpix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2030</span><span class="p">:,</span> <span class="mi">1030</span><span class="p">:</span><span class="mi">1050</span><span class="p">],</span>
             <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">30000</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Before Refpix Subtraction&#39;</span><span class="p">,</span>
             <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;After Refpix Subtraction&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Image of the difference before/after reference pixel subtraction</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">superbias</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2030</span><span class="p">:,</span> <span class="mi">1030</span><span class="p">:</span><span class="mi">1050</span><span class="p">]</span> <span class="o">-</span> <span class="n">refpix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">2030</span><span class="p">:,</span> <span class="mi">1030</span><span class="p">:</span><span class="mi">1050</span><span class="p">],</span>
           <span class="n">vmin</span><span class="o">=</span><span class="mi">7000</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">16000</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Difference: Before - After Refpix Subtraction&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now lets look at the difference in the data after the mean value subtraction compared to the case where both the mean value subtraction and the 1/f correction are done.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Side by side view of the reference pixel subtraction with and without</span>
<span class="c1"># using the side reference pixels to subtract 1/f noise</span>
<span class="n">side_by_side</span><span class="p">(</span><span class="n">refpix_no_sidepix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">refpix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
             <span class="n">vmin</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">150</span><span class="p">,</span> <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;No Side Repix Correction&#39;</span><span class="p">,</span>
             <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;With Side Refpix Correction&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the difference image before and after the side reference</span>
<span class="c1"># pixels are used to subtract the 1/f noise</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">refpix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">refpix_no_sidepix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span>
           <span class="n">vmin</span><span class="o">=-</span><span class="mi">10</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Difference with/without using side refpix&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
<p><a id='linearity'></a></p>
</section>
</section>
<section id="the-linearity-correction-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Linearity</span> <span class="pre">Correction</span></code> step<a class="headerlink" href="#the-linearity-correction-step" title="Permalink to this headline">#</a></h2>
<section id="id16">
<h3>Summary<a class="headerlink" href="#id16" title="Permalink to this headline">#</a></h3>
<p>This step applies the classical linearity correction to the data on a pixel-by-pixel, integration-by-integration, group-by-group manner.</p>
</section>
<section id="id17">
<h3>Documentation<a class="headerlink" href="#id17" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/linearity/description.html">Full description</a> of the step.</p>
</section>
<section id="id18">
<h3>Arguments<a class="headerlink" href="#id18" title="Permalink to this headline">#</a></h3>
<p>There are no optional arguments for this step</p>
</section>
<section id="id19">
<h3>Reference files used<a class="headerlink" href="#id19" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/linearity/reference_files.html"><code class="docutils literal notranslate"><span class="pre">LINEARITY</span></code></a> reference file. This file contains the polynomial coefficients used to apply the linearity correction to non-linear data.</p>
</section>
<section id="id20">
<h3>Run the step<a class="headerlink" href="#id20" title="Permalink to this headline">#</a></h3>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># linearity_step = LinearityStep()</span>
<span class="c1"># linearity_step.output_dir = output_dir</span>
<span class="c1"># linearity_step.save_results = True</span>

<span class="c1"># # Call using the refpix instance from the previously-run</span>
<span class="c1"># # refpix step</span>
<span class="c1"># linearity = linearity_step.run(refpix)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#with datamodels.open(file_names[0].replace(&#39;uncal.fits&#39;, &#39;linearity.fits&#39;)) as linearity:</span>
<span class="n">linearity</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;linearity.fits&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">linearity</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id21">
<h3>Examine the output<a class="headerlink" href="#id21" title="Permalink to this headline">#</a></h3>
<p>Lets look at the signal up the ramp for a high signal pixel, in order to more easily see how the linearity correction changed the data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using the 3rd group, find the difference between the data before and after</span>
<span class="c1"># linearity correction. Find the pixels where this difference is greater than</span>
<span class="c1"># 20 DN, and also where the signal in the final group is over 40,000 DN.</span>
<span class="n">lin_fix</span> <span class="o">=</span> <span class="n">linearity</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">refpix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="n">well_exposed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">((</span><span class="n">linearity</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span> <span class="o">&gt;</span> <span class="mf">40000.</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lin_fix</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> pixels meet the criteria above.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">well_exposed</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<p>Pick one of these pixels and plot the signal before and after the linearity correction.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">lin_pix_x</span><span class="p">,</span> <span class="n">lin_pix_y</span> <span class="o">=</span> <span class="p">(</span><span class="n">well_exposed</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index</span><span class="p">],</span> <span class="n">well_exposed</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an array of group numbers to plot against</span>
<span class="n">group_nums</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_ramps</span><span class="p">(</span><span class="n">group_nums</span><span class="p">,</span> <span class="n">refpix</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">lin_pix_y</span><span class="p">,</span> <span class="n">lin_pix_x</span><span class="p">],</span>
           <span class="n">linearity</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">lin_pix_y</span><span class="p">,</span> <span class="n">lin_pix_x</span><span class="p">],</span> <span class="n">label1</span><span class="o">=</span><span class="s1">&#39;Uncorrected&#39;</span><span class="p">,</span> <span class="n">label2</span><span class="o">=</span><span class="s1">&#39;Corrected&#39;</span><span class="p">,</span>
           <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Pixel (</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lin_pix_x</span><span class="p">,</span> <span class="n">lin_pix_y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>In this case, the pixel reached saturation in group 9. So in group 9, the linearity correction made no changes. Between groups 0 to 8, you can see the original signal (in black) becoming more and more non-linear as signal increases, along with how the linearity correction modified the signal (red).</p>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
<p><a id='persistence'></a></p>
</section>
</section>
<section id="the-persistence-correction-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Persistence</span> <span class="pre">Correction</span></code> step<a class="headerlink" href="#the-persistence-correction-step" title="Permalink to this headline">#</a></h2>
<section id="id22">
<h3>Summary<a class="headerlink" href="#id22" title="Permalink to this headline">#</a></h3>
<p>This step uses a model to calculate the amount of signal in each group of each pixel that comes from persistence. This persistence signal is then subtracted, pixel-by-pixel and group-by-group, from the data.</p>
</section>
<section id="id23">
<h3>Documentation<a class="headerlink" href="#id23" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/persistence/description.html">Full description</a> of the step.</p>
</section>
<section id="id24">
<h3>Arguments<a class="headerlink" href="#id24" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/persistence/arguments.html">Optional arguments</a> for this step include setting the threshold signal value above which pixels are flagged in the DQ extension, as well as saving the subtracted persistence signal in a separate file.</p>
</section>
<section id="id25">
<h3>Reference files used<a class="headerlink" href="#id25" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/persistence/reference_files.html"><code class="docutils literal notranslate"><span class="pre">TRAPDENSITY</span></code>, <code class="docutils literal notranslate"><span class="pre">PERSAT</span></code>, and <code class="docutils literal notranslate"><span class="pre">TRAPPARS</span></code></a> reference files. The TRAPDENSITY file contains a map of the relative number of traps per pixel. The PERSAT reference file contains a map of the persistence saturation level, and the TRAPPARS reference file contains parameters related to the persistence calculation model.</p>
</section>
<section id="id26">
<h3>Run the step<a class="headerlink" href="#id26" title="Permalink to this headline">#</a></h3>
<p><strong>Note: this is skipped for now. Test will be added later.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">PersistenceStep</span><span class="o">.</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># persist_step = PersistenceStep()</span>
<span class="c1"># persist_step.output_dir = output_dir</span>
<span class="c1"># persist_step.save_results = True</span>

<span class="c1"># # Specify the trapsfilled file, which contains the</span>
<span class="c1"># # state of the charge traps in the preceding exposure</span>
<span class="c1"># persist_step.input_trapsfilled = persist_file</span>

<span class="c1"># # Let&#39;s also save a separate file that contains the</span>
<span class="c1"># # subtracted persistence signal </span>
<span class="c1"># persist_step.save_persistence = True</span>

<span class="c1"># # Call using the refpix instance from the previously-run</span>
<span class="c1"># # linearity step</span>
<span class="c1"># persist = persist_step.run(linearity)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id27">
<h3>Examine the output<a class="headerlink" href="#id27" title="Permalink to this headline">#</a></h3>
<p>Lets look at the optional output file that contains the subtracted persistence signal.</p>
<p>NOTE: In this case the output is pretty boring. It turns out that the trap density map reference file for NIRCam is empty because it is not yet well characterized. This means that the persistence signal is zero in all pixels for all exposures. Once the map is updated in commissioning, this step will start calculating persistence values.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Name of the file containing a map of the calculated persistence signal</span>
<span class="c1"># persist_signal_file = os.path.join(output_dir, &#39;{}output_pers.fits&#39;.format(input_file_base))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Read in the map of persistence signal</span>
<span class="c1"># persist_signal = fits.getdata(persist_signal_file)</span>
</pre></div>
</div>
</div>
</div>
<p>The file contains the persistence signal for each group of each integration, as we can see by the shape.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># persist_signal.shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># np.min(persist_signal), np.max(persist_signal)</span>
</pre></div>
</div>
</div>
</div>
<p>Lets look at the persistence signal in the final group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># show_image(persist_signal[0, -1, :, :], 0, .01)</span>
</pre></div>
</div>
</div>
</div>
<p><a id='dc'></a></p>
</section>
</section>
<section id="the-dark-current-subtraction-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Dark</span> <span class="pre">Current</span> <span class="pre">Subtraction</span></code> step<a class="headerlink" href="#the-dark-current-subtraction-step" title="Permalink to this headline">#</a></h2>
<section id="id28">
<h3>Summary<a class="headerlink" href="#id28" title="Permalink to this headline">#</a></h3>
<p>This step subtracts the dark current, group by group, from the input integrations.</p>
</section>
<section id="id29">
<h3>Documentation<a class="headerlink" href="#id29" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/dark_current/description.html">Full description</a> of the step.</p>
</section>
<section id="id30">
<h3>Arguments<a class="headerlink" href="#id30" title="Permalink to this headline">#</a></h3>
<p>There are no optional arguments for this step</p>
</section>
<section id="id31">
<h3>Reference files used<a class="headerlink" href="#id31" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/dark_current/reference_files.html"><code class="docutils literal notranslate"><span class="pre">DARK</span></code></a> reference file. This file contains the measured mean dark current associated with the detector and subarray.</p>
</section>
<section id="id32">
<h3>Run the step<a class="headerlink" href="#id32" title="Permalink to this headline">#</a></h3>
<p>NOTE: This is one of the longer-running steps of calwebb_detector1.</p>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># dark_step = DarkCurrentStep()</span>
<span class="c1"># dark_step.save_results = True</span>

<span class="c1"># # Call using the persistence instance from the previously-run</span>
<span class="c1"># # persistence step</span>
<span class="c1"># dark = dark_step.run(linearity)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#with datamodels.open(file_names[0].replace(&#39;uncal.fits&#39;, &#39;dark_current.fits&#39;)) as dark:</span>
<span class="n">dark</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;dark_current.fits&#39;</span><span class="p">))</span> 
<span class="nb">print</span><span class="p">(</span><span class="n">dark</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Look at the data before and after superbias subtraction</span>
<span class="n">side_by_side</span><span class="p">(</span><span class="n">linearity</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">dark</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span>
            <span class="n">title1</span><span class="o">=</span><span class="s1">&#39;Before dark correction&#39;</span><span class="p">,</span> <span class="n">title2</span><span class="o">=</span><span class="s1">&#39;After dark correction&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
<p><a id='jump'></a></p>
</section>
</section>
<section id="the-cosmic-ray-flagging-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Cosmic</span> <span class="pre">Ray</span> <span class="pre">Flagging</span></code> step<a class="headerlink" href="#the-cosmic-ray-flagging-step" title="Permalink to this headline">#</a></h2>
<section id="id33">
<h3>Summary<a class="headerlink" href="#id33" title="Permalink to this headline">#</a></h3>
<p>This step searches for jumps in the ramp data. In this case, a jump in a pixels ramp is defined as a large deviation in the count rate relative to that in the other groups. When a jump is found, the associated flag is added to the <code class="docutils literal notranslate"><span class="pre">GROUPDQ</span></code> extension for the group and pixel where the jump was detected. The science data are not modified at all. In the subsequent ramp-fitting step, the algorithm will look into the <code class="docutils literal notranslate"><span class="pre">GROUPDQ</span></code> array and ignore any groups where the jump flag has been set.</p>
</section>
<section id="id34">
<h3>Documentation<a class="headerlink" href="#id34" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/jump/description.html">Full description</a> of the step.</p>
</section>
<section id="id35">
<h3>Arguments<a class="headerlink" href="#id35" title="Permalink to this headline">#</a></h3>
<p>The jump step has <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/jump/arguments.html">several optional arguments</a></p>
</section>
<section id="id36">
<h3>Reference files used<a class="headerlink" href="#id36" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/references_general/readnoise_reffile.html"><code class="docutils literal notranslate"><span class="pre">READNOISE</span></code></a> and <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/references_general/gain_reffile.html"><code class="docutils literal notranslate"><span class="pre">GAIN</span></code></a> reference files. These files contain maps of the readnoise and gain values across the detector.</p>
</section>
<section id="id37">
<h3>Run the step<a class="headerlink" href="#id37" title="Permalink to this headline">#</a></h3>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<p>List the available parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">JumpStep</span><span class="o">.</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># jump_step = JumpStep()</span>
<span class="c1"># jump_step.output_dir = output_dir</span>
<span class="c1"># jump_step.save_results = True</span>
<span class="c1"># jump_step.rejection_threshold = 9</span>

<span class="c1"># # Call using the dark instance from the previously-run</span>
<span class="c1"># # dark current subtraction step</span>
<span class="c1"># jump = jump_step.run(dark)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#with datamodels.open(file_names[0].replace(&#39;uncal.fits&#39;, &#39;jump.fits&#39;)) as jump:</span>
<span class="n">jump</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;jump.fits&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">jump</span><span class="o">.</span><span class="n">info</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="id38">
<h3>Examine the output<a class="headerlink" href="#id38" title="Permalink to this headline">#</a></h3>
<p>Lets see what some of these jumps look like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How many total jump flags were added? Note that some pixels</span>
<span class="c1"># will have more than one group flagged with a jump.</span>
<span class="n">jump_flags</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">jump</span><span class="o">.</span><span class="n">groupdq</span> <span class="o">&amp;</span> <span class="n">dqflags</span><span class="o">.</span><span class="n">pixel</span><span class="p">[</span><span class="s1">&#39;JUMP_DET&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> jump flags detected.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">jump_flags</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>

<span class="c1"># Create a 4-dimensional map of the jump flags</span>
<span class="n">jump_map</span> <span class="o">=</span> <span class="p">(</span><span class="n">jump</span><span class="o">.</span><span class="n">groupdq</span> <span class="o">&amp;</span> <span class="n">dqflags</span><span class="o">.</span><span class="n">pixel</span><span class="p">[</span><span class="s1">&#39;JUMP_DET&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Collapse down to a 2D map of the number of flagged jumps in each pixel</span>
<span class="n">jump_map_2d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jump_map</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:,</span> <span class="p">:],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Determine how many pixels have jump flags</span>
<span class="n">jump_map_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">jump_map_2d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">impacted_pix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">jump_map_2d</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">total_pix</span> <span class="o">=</span> <span class="mi">2048</span> <span class="o">*</span> <span class="mi">2048</span>
<span class="nb">print</span><span class="p">((</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> pixels (</span><span class="si">{:.2f}% o</span><span class="s1">f the detector) have been flagged with &#39;</span>
      <span class="s1">&#39;at least one jump.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">impacted_pix</span><span class="p">,</span> <span class="mf">100.</span> <span class="o">*</span> <span class="n">impacted_pix</span> <span class="o">/</span> <span class="n">total_pix</span><span class="p">)))</span>
</pre></div>
</div>
</div>
</div>
<p>Plot some of the pixels impacted by jumps. The red marks signify flagged jumps. These signal values will be ignored in subsequent ramp-fitting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The jump map is 4-dimensional, just like the science data</span>
<span class="n">jump_map</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create an array of group numbers to plot against</span>
<span class="n">group_indexes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">jump_map</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pick one pixel with a flagged jump, and find the group(s) with the jump flags</span>
<span class="n">j_index</span> <span class="o">=</span> <span class="mi">10112</span>
<span class="n">jumpy</span> <span class="o">=</span> <span class="n">jump_map_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span>
<span class="n">jumpx</span> <span class="o">=</span> <span class="n">jump_map_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j_index</span><span class="p">]</span>
<span class="n">jump_grp</span> <span class="o">=</span> <span class="n">jump_map</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">jumpy</span><span class="p">,</span> <span class="n">jumpx</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Jump located in group(s) </span><span class="si">{}</span><span class="s1"> of pixel (</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">)&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">group_indexes</span><span class="p">[</span><span class="n">jump_grp</span><span class="p">],</span> <span class="n">jumpx</span><span class="p">,</span> <span class="n">jumpy</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the signal up the ramp for this pixel</span>
<span class="n">plot_jump</span><span class="p">(</span><span class="n">jump</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">jumpy</span><span class="p">,</span> <span class="n">jumpx</span><span class="p">],</span> <span class="n">jump_grp</span><span class="p">,</span> <span class="n">xpixel</span><span class="o">=</span><span class="n">jumpx</span><span class="p">,</span> <span class="n">ypixel</span><span class="o">=</span><span class="n">jumpy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Plot a grid of some examples of flagged jumps. The red marks signify flagged jumps. These signal values will be ignored in subsequent ramp-fitting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">indexes_to_plot</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">600</span><span class="p">,</span> <span class="mi">30010</span><span class="p">,</span> <span class="mi">31000</span><span class="p">,</span> <span class="mi">1202</span><span class="p">,</span> <span class="mi">1400</span><span class="p">,</span> <span class="mi">21600</span><span class="p">,</span> <span class="mi">10112</span><span class="p">]</span>
<span class="n">jump_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">jump</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_to_plot</span><span class="p">)))</span>
<span class="n">jump_grps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">jump</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_to_plot</span><span class="p">)))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">bool</span><span class="p">)</span>
<span class="n">jump_locs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">counter</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indexes_to_plot</span><span class="p">):</span>
    <span class="c1">#integ, grp, y, x = jump_flags[idx]</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">jump_map_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">jump_map_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">grp</span> <span class="o">=</span> <span class="n">jump_map</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>

    <span class="n">jump_data</span><span class="p">[:,</span> <span class="n">counter</span><span class="p">]</span> <span class="o">=</span> <span class="n">jump</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">jump_grps</span><span class="p">[:,</span> <span class="n">counter</span><span class="p">]</span> <span class="o">=</span> <span class="n">grp</span>
    <span class="n">jump_locs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_jumps</span><span class="p">(</span><span class="n">jump_data</span><span class="p">,</span> <span class="n">jump_grps</span><span class="p">,</span> <span class="n">jump_locs</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
<p><a id='ramp_fitting'></a></p>
</section>
</section>
<section id="the-ramp-fitting-step">
<h2>The <code class="docutils literal notranslate"><span class="pre">Ramp</span> <span class="pre">Fitting</span></code> step<a class="headerlink" href="#the-ramp-fitting-step" title="Permalink to this headline">#</a></h2>
<section id="id39">
<h3>Summary<a class="headerlink" href="#id39" title="Permalink to this headline">#</a></h3>
<p>This step performs line-fitting to the corrected data, and produces a slope image for each integration. For a given pixel, any groups within an integration that contain a jump flag or that are flagged as saturated are ignored.</p>
<p>For the purposes of this notebook, we will use the <code class="docutils literal notranslate"><span class="pre">save_opt</span></code> parameter to tell the ramp-fitting step to save an optional output file that contains some of the details on the ramp fits. This information will be used for the plots after the step is run. By default, <code class="docutils literal notranslate"><span class="pre">save_opt</span></code> is False and the optional outputs are not saved.</p>
</section>
<section id="id40">
<h3>Documentation<a class="headerlink" href="#id40" title="Permalink to this headline">#</a></h3>
<p><a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/ramp_fitting/description.html">Full description</a> of the step.</p>
</section>
<section id="id41">
<h3>Arguments<a class="headerlink" href="#id41" title="Permalink to this headline">#</a></h3>
<p>The jump step has <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/ramp_fitting/arguments.html">several optional arguments</a>, including the ability to save optional outputs into a second file.</p>
</section>
<section id="id42">
<h3>Reference files used<a class="headerlink" href="#id42" title="Permalink to this headline">#</a></h3>
<p>This step uses the <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/references_general/readnoise_reffile.html"><code class="docutils literal notranslate"><span class="pre">READNOISE</span></code></a> and <a class="reference external" href="https://jwst-pipeline.readthedocs.io/en/stable/jwst/references_general/gain_reffile.html"><code class="docutils literal notranslate"><span class="pre">GAIN</span></code></a> reference files. These files contain maps of the readnoise and gain values across the detector.</p>
</section>
<section id="id43">
<h3>Run the step<a class="headerlink" href="#id43" title="Permalink to this headline">#</a></h3>
<p>Since we ran the step above and saved the outputs, well skip this part and just load the outputs.</p>
<p>List the available parameters:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">RampFitStep</span><span class="o">.</span><span class="n">spec</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Using the run() method</span>
<span class="c1"># ramp_fit_step = RampFitStep()</span>
<span class="c1"># ramp_fit_step.save_results = True</span>

<span class="c1"># # Let&#39;s save the optional outputs, in order</span>
<span class="c1"># # to help with visualization later</span>
<span class="c1"># ramp_fit_step.save_opt = True</span>

<span class="c1"># # Call using the dark instance from the previously-run</span>
<span class="c1"># # jump step</span>
<span class="c1"># ramp_fit = ramp_fit_step.run(jump)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramp_fit</span> <span class="o">=</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;0_ramp_fit.fits&#39;</span><span class="p">)),</span> <span class="n">datamodels</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;1_ramp_fit.fits&#39;</span><span class="p">))</span>  
</pre></div>
</div>
</div>
</div>
<p>An important detail here is that there are two output files:</p>
<ol class="simple">
<li><p>The file ending with <code class="docutils literal notranslate"><span class="pre">*_0_rampfitstep.fits</span></code> contains the mean slope image across all integrations in the exposure.</p></li>
<li><p>The file ending with <code class="docutils literal notranslate"><span class="pre">*_1_rampfitstep.fits</span></code> contains a separate slope image for each integration. In this case our exposure contains only a single integration, so the data in the two files are identical.</p></li>
</ol>
<p>We are working with the output datamodels in this notebook. Unlike the preceeding steps, where the output was a single datamodel, the ramp_fitting step outputs a tuple of 2 datamodel instances. The first element in the tuple is the datamodel instance containing the mean rate image, while the second element is the datamodel instance containing a separate slope image for each integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">ramp_fit</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">type</span><span class="p">(</span><span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">type</span><span class="p">(</span><span class="n">ramp_fit</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>Show the shape of the two output data models. The output with the mean slope image is only 2-dimensional, while the output with one slope image for each integration is 3-dimensional, even in this case where we have only one integration.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">ramp_fit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
</div>
<p>Here we see that in our case with a single integration, the two datamodel instances contain identical data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">],</span> <span class="n">ramp_fit</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>And note that the data in these files are the slopes from the ramp fitting, so the units have changed from DN to DN/sec.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Show the units of the ramp-fit data</span>
<span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">bunit_data</span>
</pre></div>
</div>
</div>
</div>
<p>Lets load the data from the third output file, which contains the optional outputs. Our goal is to grab the intercept values from the line-fitting and use them to re-create the plots from the jump step and overplot the best-fit signals on top of the signals that went into the step.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generate the name of the optional output file</span>
<span class="n">optional_file</span> <span class="o">=</span> <span class="n">file_names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;uncal.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;fitopt.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Open the file and examine the extensions</span>
<span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">optional_file</span><span class="p">)</span>
<span class="n">hdulist</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>The intercepts from the line-fitting are stored in the <code class="docutils literal notranslate"><span class="pre">YINT</span></code> extension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hdulist</span><span class="p">[</span><span class="s1">&#39;YINT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>For our plots below, we need the intercept values from the line-fitting. Lets ignore all but the first plane of the extension, since those are zeros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intercepts</span> <span class="o">=</span> <span class="n">hdulist</span><span class="p">[</span><span class="s1">&#39;YINT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>
<span class="n">hdulist</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p>For the pixels to be plotted, create linear ramps using the output slopes and intercepts</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the exposure time associated with each group</span>
<span class="n">num_groups</span> <span class="o">=</span> <span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">ngroups</span>
<span class="n">group_time</span> <span class="o">=</span> <span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">meta</span><span class="o">.</span><span class="n">exposure</span><span class="o">.</span><span class="n">group_time</span>
<span class="n">group_times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">num_groups</span><span class="p">)</span> <span class="o">*</span> <span class="n">group_time</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reconstruct linear ramps from the slope and intercept values</span>
<span class="n">lin_ramps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">jump</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">indexes_to_plot</span><span class="p">)))</span>
<span class="k">for</span> <span class="n">counter</span><span class="p">,</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">indexes_to_plot</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">jump_map_indexes</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">jump_map_indexes</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
    <span class="n">grp</span> <span class="o">=</span> <span class="n">jump_map</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>

    <span class="n">rate</span> <span class="o">=</span> <span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">intercepts</span><span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
    <span class="n">lin_ramps</span><span class="p">[:,</span> <span class="n">counter</span><span class="p">]</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="p">(</span><span class="n">rate</span> <span class="o">*</span> <span class="n">group_times</span><span class="p">)</span>    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reconstruct the linear ramp for the single pixel we showed after the jump step</span>
<span class="n">lin_data</span> <span class="o">=</span> <span class="n">intercepts</span><span class="p">[</span><span class="n">jumpy</span><span class="p">,</span> <span class="n">jumpx</span><span class="p">]</span> <span class="o">+</span> <span class="p">(</span><span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">jumpy</span><span class="p">,</span> <span class="n">jumpx</span><span class="p">]</span> <span class="o">*</span> <span class="n">group_times</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot again the single pixel from the jump step, along with its</span>
<span class="c1"># reconstructed best-fit linear fit</span>
<span class="n">plot_jump</span><span class="p">(</span><span class="n">jump</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">jumpy</span><span class="p">,</span> <span class="n">jumpx</span><span class="p">],</span> <span class="n">jump_grp</span><span class="p">,</span> <span class="n">xpixel</span><span class="o">=</span><span class="n">jumpx</span><span class="p">,</span>
          <span class="n">ypixel</span><span class="o">=</span><span class="n">jumpy</span><span class="p">,</span> <span class="n">slope</span><span class="o">=</span><span class="n">lin_data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Plot the same as above, but for the collection of pixels</span>
<span class="c1"># we plotted after the jump step</span>
<span class="n">plot_jumps</span><span class="p">(</span><span class="n">jump_data</span><span class="p">,</span> <span class="n">jump_grps</span><span class="p">,</span> <span class="n">jump_locs</span><span class="p">,</span> <span class="n">slopes</span><span class="o">=</span><span class="n">lin_ramps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Look at the slope image.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Whats going on with the dark pixels scattered across the left side of the detector? It turns out they have signal values of exactly zero in the slope image. Lets have a closer look, and ignore the reference pixels.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scipix</span> <span class="o">=</span> <span class="n">ramp_fit</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">4</span><span class="p">:</span><span class="mi">2044</span><span class="p">,</span> <span class="mi">4</span><span class="p">:</span><span class="mi">2044</span><span class="p">]</span>
<span class="n">zero_pix</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">scipix</span> <span class="o">==</span> <span class="mf">0.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1"> science pixels have a slope that is exactly zero.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zero_pix</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<p>Pick one of these pixels, and examine the pixels signals up the ramp, as well as its data quality flags up the ramp.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">idx</span> <span class="o">=</span> <span class="mi">45</span>

<span class="c1"># Add 4 to the coordinates because we stripped off the 4 columns/rows of </span>
<span class="c1"># refpix in the np.where statement above</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">zero_pix</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">zero_pix</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;(</span><span class="si">{}</span><span class="s1">, </span><span class="si">{}</span><span class="s1">) has a slope of 0.&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Print the slope (should be zero), signal values up the ramp, and DQ flags up the ramp</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scipix</span><span class="p">[</span><span class="n">y</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="n">x</span><span class="o">-</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linearity</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">linearity</span><span class="o">.</span><span class="n">groupdq</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>What does a DQ flag value of 2 mean?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Print JWST bad pixel flag definitions</span>
<span class="n">dqflags</span><span class="o">.</span><span class="n">pixel</span>
</pre></div>
</div>
</div>
</div>
<p>So this pixel (and the others with values of 0 in the slope image) have been flagged as saturated in all groups. In this case, the pipeline cannot calculate a slope value, and assigns a value of zero.</p>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
<p><a id="about_ID"></a></p>
</section>
</section>
<section id="about-this-notebook">
<h2>About this Notebook<a class="headerlink" href="#about-this-notebook" title="Permalink to this headline">#</a></h2>
<p><strong>Original Author:</strong> Bryan Hilbert, updated by Alicia Canipe, NIRCam
<br><strong>Updated On:</strong> 07/28/2021</p>
<p><a class="reference external" href="#title_ID">Top of Notebook</a></p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "TheRealZoidberg/jwst_validation_test",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./notebooks/calwebb_detector1/jwst_detector1_nircam_test"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../../calwebb_image3/jwst_image3_miri_test/jwst_image3_miri_test.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">JWST Pipeline Validation Notebook: calwebb_image3 with MIRI</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="exec_jwst_detector1_nircam_test.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">JWST Pipeline Validation Notebook: calwebb_detector1, NIRCam imaging</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By STScI<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>